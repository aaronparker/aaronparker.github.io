<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Reducing the size of App-V packages | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Reducing the size of App-V packages" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="If you’re looking to reduce the size of your App-V packages, you can compress them when saving them in the Sequencer; however if that content in the package doesn’t actually compress that well, you may not save as much space as you might expect. Here a quick win to reduce the size of your packages." />
<meta property="og:description" content="If you’re looking to reduce the size of your App-V packages, you can compress them when saving them in the Sequencer; however if that content in the package doesn’t actually compress that well, you may not save as much space as you might expect. Here a quick win to reduce the size of your packages." />
<link rel="canonical" href="/reducing-the-size-of-app-v-packages/" />
<meta property="og:url" content="/reducing-the-size-of-app-v-packages/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-09-25T22:30:07+10:00" />
<script type="application/ld+json">
{"description":"If you’re looking to reduce the size of your App-V packages, you can compress them when saving them in the Sequencer; however if that content in the package doesn’t actually compress that well, you may not save as much space as you might expect. Here a quick win to reduce the size of your packages.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/reducing-the-size-of-app-v-packages/","headline":"Reducing the size of App-V packages","dateModified":"2011-09-25T22:30:07+10:00","datePublished":"2011-09-25T22:30:07+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/reducing-the-size-of-app-v-packages/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Reducing the size of App-V packages</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2011-09-25T22:30:07+10:00" itemprop="datePublished">Sep 25, 2011
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>If you’re looking to reduce the size of your App-V packages, you can compress them when saving them in the Sequencer; however if that content in the package doesn’t actually compress that well, you may not save as much space as you might expect. Here a quick win to reduce the size of your packages.</p>

<p>In this post I’m using Office Professional 2010 as an example, where I’ve reduce the size of the package from potentially 2.8GB (uncompressed) to 606Mb (compressed). This screenshot shows a default install left uncompressed:</p>

<p><a href="http://stealthpuppy.com/wp-content/uploads/2011/09/Package-Uncompressed.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Package-Uncompressed" src="http://stealthpuppy.com/wp-content/uploads/2011/09/Package-Uncompressed_thumb.png" alt="Package-Uncompressed" width="377" height="281" border="0" /></a></p>

<p>The default Office installation caches a copy of the Office installation files in the <em>C:\Windows\Installer</em> and the <em><a href="http://support.microsoft.com/kb/825933">MSOCache</a></em> folders. These folders are generally required when installing Office so that repair operations can take place and features can be added post-installation. However when <a href="http://support.microsoft.com/kb/983462">virtualizing Office</a>, we won’t want either of those actions taking place – we want consistency and predictability. So when capturing Office with the Sequencer, we configure setup and run applications to ensure they don’t occur.</p>

<p>This then leaves us with a large amount of data in the package that will never be used at execution time, but will most likely still be streamed to each client – waste of disk space and bandwidth. Only when it comes time to update the package do we need those folders.</p>

<p>So instead of leaving them in the package, we could exclude them from the sequencer and copy them out of the Sequencing machine and save them with the package. The process would look something like this:</p>

<ol>
  <li>Add an exclusion to your package for <em>%CSIDL_WINDOWS%\Installer</em> and <em>C:\MSOCache</em> or <em>%SFT_MNT%\MSOCache</em> if you are sequencing Office</li>
  <li>Sequence your application and save the package with compression enabled</li>
  <li>Save the package to the Content share along with a copy of C:\Windows\Installer and MSOCache, if you are sequencing Office</li>
  <li>When it comes time to update the package, copy the folders back into the sequencing machine before starting the sequencing process</li>
  <li>Repeat the process once you’ve saved the updated package</li>
</ol>

<p>The same Office 2010 package is now 606Mb - 22% of the size of the original package:</p>

<p><a href="http://stealthpuppy.com/wp-content/uploads/2011/09/Office2010-After.png"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="Office2010-After" src="http://stealthpuppy.com/wp-content/uploads/2011/09/Office2010-After_thumb.png" alt="Office2010-After" width="377" height="282" border="0" /></a></p>

  </div><a class="u-url" href="/reducing-the-size-of-app-v-packages/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
