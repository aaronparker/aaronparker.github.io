<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Installing Office 2007 on Terminal Server | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Installing Office 2007 on Terminal Server" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="When install Office 2007 on your Terminal Servers there are a few things you’ll need to be aware of. The first of which is that you will need an Enterprise or Volume License key, i.e. those keys that use Volume Activation 1.0 and do not require activation. There is also some configuration and installation options that I recommend you set before and after installation." />
<meta property="og:description" content="When install Office 2007 on your Terminal Servers there are a few things you’ll need to be aware of. The first of which is that you will need an Enterprise or Volume License key, i.e. those keys that use Volume Activation 1.0 and do not require activation. There is also some configuration and installation options that I recommend you set before and after installation." />
<link rel="canonical" href="/installing-office-2007-on-terminal-server/" />
<meta property="og:url" content="/installing-office-2007-on-terminal-server/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-05-06T07:18:00+10:00" />
<script type="application/ld+json">
{"description":"When install Office 2007 on your Terminal Servers there are a few things you’ll need to be aware of. The first of which is that you will need an Enterprise or Volume License key, i.e. those keys that use Volume Activation 1.0 and do not require activation. There is also some configuration and installation options that I recommend you set before and after installation.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/installing-office-2007-on-terminal-server/","headline":"Installing Office 2007 on Terminal Server","dateModified":"2007-05-06T07:18:00+10:00","datePublished":"2007-05-06T07:18:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/installing-office-2007-on-terminal-server/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About</a><a class="page-link" href="/about/">About</a><a class="page-link" href="/app-v-5-x-versions.html">App-V 5.x Versions</a><a class="page-link" href="/appv-faqs.html">App-V 4.x FAQs</a><a class="page-link" href="/appv5-faqs.html">Microsoft Application Virtualization 5 FAQs</a><a class="page-link" href="/appvrecipes.html">App-V Recipes</a><a class="page-link" href="/archives.html">Archives</a><a class="page-link" href="/home-page.html">Home Page</a><a class="page-link" href="/scriptcorner.html">Script Corner</a><a class="page-link" href="/search-results.html">Search Results</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS &amp;#8211; Why you should stop referring to CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Installing Office 2007 on Terminal Server</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-05-06T07:18:00+10:00" itemprop="datePublished">May 6, 2007
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>When install Office 2007 on your Terminal Servers there are a few things you’ll need to be aware of. The first of which is that you will need an <a href="http://support.microsoft.com/kb/828378">Enterprise or Volume License key</a>, i.e. those keys that use <a href="http://www.microsoft.com/licensing/resources/vol/default.mspx">Volume Activation 1.0</a> and do not require activation. There is also some configuration and installation options that I recommend you set before and after installation.</p>

<p>There are a number of options I recommend setting by using the <a href="http://technet2.microsoft.com/Office/en-us/library/8faae8a0-a12c-4f7b-839c-24a66a531bb51033.mspx">Office Customisation Tool</a> (SETUP.EXE /ADMIN). These first couple of options aren’t really Terminal Server specific and are worth setting for all Office deployments. You can enforce these via Group Policy, however if you configure them with a custom installation they will be the default settings:</p>

<ul>
  <li>Disable the Customer Experience Improvement Program from running when users start an Office application: <em>Modify user settings – Microsoft Office 2007 system / Privacy / Trust Center / Enable Customer Experience Improvement Program</em></li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Disable Outlook from prompting users to archive their mailboxes: _Modify user settings – Microsoft Office Outlook 2007 / Tools</td>
          <td>Options.. / Other / AutoArchive / AutoArchive Settings_</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<p><img src="http://stealthpuppy.com/wp-content/uploads/2007/05/1000.14.1390.ModifyUserSettings.png" border="0" alt="" /></p>

<p>You’ll also want to take a look at the feature installation states – set each of these to either ON or OFF, don’t set any feature to Install on First Use. A subset of the options I disable when installing Office on a Terminal Server are:</p>

<ul>
  <li>Office Shared Features / Proofing Tools / French Proofing Tools / English – French Translation</li>
  <li>Office Shared Features / Proofing Tools / Spanish Proofing Tools / Spanish – French Translation</li>
</ul>

<p><img src="http://stealthpuppy.com/wp-content/uploads/2007/05/1000.14.1391.FeatureInstallationStates.png" border="0" alt="" /></p>

<p>The first two options should be disabled as a part of <a href="http://support.microsoft.com/?kbid=823586">preventing CTFMON.EXE from running</a> in each user session. You will also have to unregister MSCTF.DLL as a part of your installation of Office (<code class="highlighter-rouge">REGSVR32 /S /U MSCTF.DLL</code>)</p>

<p>One of the cool features of Office 2007 is one that users will appreciate and a tool that you will need to install after Office is installed <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=4d951911-3e7e-4ae6-b059-a2e79ed87041&amp;DisplayLang=en">Save As PDF or XPS</a>. You can install this tool during a custom installation of Office using the Office Customisation Tool or via a script by running <code class="highlighter-rouge">SaveAsPDFandXPS.exe /QUIET</code>.</p>

<p>Finally you will have to delete identifying information recorded to the Terminal Server shadow registry key by Setup during installation. Because you now need to use SETUP.EXE to install Office, the Terminal Server will force Install mode before installation can continue. While Install mode is technically not required to install Office on Terminal Server, you will see the user information of the account used to install Office replicated to all users who then run an Office application if you don’t delete this key:</p>

<p><code class="highlighter-rouge">HKLMSOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerInstallSoftwareMicrosoftOffice</code></p>

<p>An install script for Office might look something like this:</p>

<p>[code]@ECHO OFF<br />
CHANGE USER /INSTALL<br />
START /WAIT \domain.localdfsapplicationsOffice2007EnterpriseSetup.exe<br />
CHANGE USER /EXECUTE<br />
REG DELETE “HKLMSOFTWAREMicrosoftWindows NTCurrentVersionTerminal ServerInstallSoftwareMicrosoftOffice” /f<br />
REGSVR32 /U %SYSTEMROOT%SYSTEM32MSCTF.DLL /S[/code]</p>

<p>TechNet has more detail on Office 2007 on Terminal Server:</p>

<ul>
  <li><a href="http://technet2.microsoft.com/Office/en-us/library/7e816caa-7c1c-4d78-ac28-693aa4ea58d81033.mspx?mfr=true">Deploy the 2007 Office system on a Terminal Services-enabled computer</a></li>
  <li><a href="http://www.microsoft.com/technet/technetmag/issues/2008/02/OfficeTS/default.aspx">Deploy the 2007 Office System with Terminal Services</a></li>
</ul>

  </div><a class="u-url" href="/installing-office-2007-on-terminal-server/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
