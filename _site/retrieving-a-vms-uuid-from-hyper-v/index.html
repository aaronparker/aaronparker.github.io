<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Retrieving a VM’s UUID from Hyper-V | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Retrieving a VM’s UUID from Hyper-V" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’ve previously posted about retrieving the UUID from a virtual machine hosted on vSphere. UUIDs are useful if you want to uniquely identify a target machine for OS deployment task sequences and the like (e.g. MDT). Here’s how to obtain the UUID from a virtual machine hosted on Hyper-V. Just like with vSphere, the UUID isn’t a property of the virtual machine that can be queried directly. We need to go via WMI to query the target virtual machine. Note that in this function, I’m using version 2 of the Root\Virtualization WMI namespace (root\virtualization\v2. This means the function as written, will only work on Windows 8 and Windows Server 2012 (and above). If you want to use this function on earlier versions of Hyper-V, remove the “\v2” from the namespace. As an example, here’s how to retrieve the UUIDs from a set of VMs on a target Hyper-V host named hv1: C:\&gt; Get-HypervVMUUID -ComputerName hv1 -VM win71, file3, pvs1 Name BIOSGUID ---- ---- WIN71 E6E1A176-0713-4BB0-99E9-4570A1A3A94A FILE3 9E9D788A-15E2-4760-A049-9F6EB88677A9 PVS1 74EFF5BC-A24E-48C3-85BE-12D758FE7AB6 Here’s the full function code listing. Please let me know if you find any bugs: #--------------------------------------------------------------------------- # Author: Aaron Parker # Desc: Function that uses retrieves the UUID from a specified VM and # formats it into the right format for use with MDT/SCCM etc # Date: Aug 18, 2014 # Site: http://stealthpuppy.com #--------------------------------------------------------------------------- Function Get-HypervVMUUID { &lt;# .SYNOPSIS Retrieve the UUID from a virtual machine or set of virtual machines. .DESCRIPTION This function will retrieve the UUID from from a virtual machine or set of virtual machines from a Hyper-V host. .PARAMETER ComputerName Specifies the host from which to query the virtual machine or set of virtual machines. .PARAMETER VM Specifies the virtual machine or set of virtual machines (a comma delimited list) from which to obtain the UUID/s. .EXAMPLE PS C:\&amp;gt; Get-HypervVMUUID -ComputerName hv1 -VM win71, win72 This command retrieves the UUIDs from the virtual machines win71 and win72 from the host hv1. .EXAMPLE PS C:\&amp;gt; Get-HypervVMUUID -VM win71, win72 This command retrieves the UUIDs from the virtual machines win71 and win72 from the local host. .EXAMPLE PS C:\&amp;gt; Get-HypervVMUUID This command retrieves the UUIDs from the all of the virtual machines on the local host. .NOTES https://stealthpuppy.com/retrieving-a-vms-uuid-from-hyperv/ for support information. .LINK https://stealthpuppy.com/retrieving-a-vms-uuid-from-hyperv/ #&gt; [cmdletbinding(SupportsShouldProcess=$True)] param( [Parameter(Mandatory=$false,HelpMessage=&quot;Specifies one or more Hyper-V hosts from which virtual machine UUIDs are to be retrieved. NetBIOS names, IP addresses, and fully-qualified domain names are allowable. The default is the local computer — use &quot;&quot;localhost&quot;&quot; or a dot (&quot;&quot;.&quot;&quot;) to specify the local computer explicitly.&quot;)] [string]$ComputerName, [Parameter(Mandatory=$false, Position=0,HelpMessage=&quot;Specifies the virtual machine from which to retrieve the UUID.&quot;)] [string[]]$VM ) # If ComputerName parameter is not specified, set value to the local host If (!$ComputerName) { $ComputerName = &quot;.&quot; } # If VM parameter is specified, return those VMs, else return all VMs If ($VM) { $UUIDs = Get-VM -ComputerName $ComputerName -VM $VM -ErrorAction SilentlyContinue | Select-Object Name,@{Name=&quot;BIOSGUID&quot;;Expression={(Get-WmiObject -ComputerName $_.ComputerName -Namespace &quot;root\virtualization\v2&quot; -Class Msvm_VirtualSystemSettingData -Property BIOSGUID -Filter (&quot;InstanceID = &#39;Microsoft:{0}&#39;&quot; -f $_.VMId.Guid)).BIOSGUID}} } Else { $UUIDs = Get-VM -ComputerName $ComputerName -ErrorAction SilentlyContinue | Select-Object Name,@{Name=&quot;BIOSGUID&quot;;Expression={(Get-WmiObject -ComputerName $_.ComputerName -Namespace &quot;root\virtualization\v2&quot; -Class Msvm_VirtualSystemSettingData -Property BIOSGUID -Filter (&quot;InstanceID = &#39;Microsoft:{0}&#39;&quot; -f $_.VMId.Guid)).BIOSGUID}} } # Remove curly brackets from the UUIDs and return the array ForEach ( $UID in $UUIDs ) { $UID.BIOSGUID = $UID.BIOSGUID -replace &quot;}&quot;; $UID.BIOSGUID = $UID.BIOSGUID -replace &quot;{&quot; } Return $UUIDs }" />
<meta property="og:description" content="I’ve previously posted about retrieving the UUID from a virtual machine hosted on vSphere. UUIDs are useful if you want to uniquely identify a target machine for OS deployment task sequences and the like (e.g. MDT). Here’s how to obtain the UUID from a virtual machine hosted on Hyper-V. Just like with vSphere, the UUID isn’t a property of the virtual machine that can be queried directly. We need to go via WMI to query the target virtual machine. Note that in this function, I’m using version 2 of the Root\Virtualization WMI namespace (root\virtualization\v2. This means the function as written, will only work on Windows 8 and Windows Server 2012 (and above). If you want to use this function on earlier versions of Hyper-V, remove the “\v2” from the namespace. As an example, here’s how to retrieve the UUIDs from a set of VMs on a target Hyper-V host named hv1: C:\&gt; Get-HypervVMUUID -ComputerName hv1 -VM win71, file3, pvs1 Name BIOSGUID ---- ---- WIN71 E6E1A176-0713-4BB0-99E9-4570A1A3A94A FILE3 9E9D788A-15E2-4760-A049-9F6EB88677A9 PVS1 74EFF5BC-A24E-48C3-85BE-12D758FE7AB6 Here’s the full function code listing. Please let me know if you find any bugs: #--------------------------------------------------------------------------- # Author: Aaron Parker # Desc: Function that uses retrieves the UUID from a specified VM and # formats it into the right format for use with MDT/SCCM etc # Date: Aug 18, 2014 # Site: http://stealthpuppy.com #--------------------------------------------------------------------------- Function Get-HypervVMUUID { &lt;# .SYNOPSIS Retrieve the UUID from a virtual machine or set of virtual machines. .DESCRIPTION This function will retrieve the UUID from from a virtual machine or set of virtual machines from a Hyper-V host. .PARAMETER ComputerName Specifies the host from which to query the virtual machine or set of virtual machines. .PARAMETER VM Specifies the virtual machine or set of virtual machines (a comma delimited list) from which to obtain the UUID/s. .EXAMPLE PS C:\&amp;gt; Get-HypervVMUUID -ComputerName hv1 -VM win71, win72 This command retrieves the UUIDs from the virtual machines win71 and win72 from the host hv1. .EXAMPLE PS C:\&amp;gt; Get-HypervVMUUID -VM win71, win72 This command retrieves the UUIDs from the virtual machines win71 and win72 from the local host. .EXAMPLE PS C:\&amp;gt; Get-HypervVMUUID This command retrieves the UUIDs from the all of the virtual machines on the local host. .NOTES https://stealthpuppy.com/retrieving-a-vms-uuid-from-hyperv/ for support information. .LINK https://stealthpuppy.com/retrieving-a-vms-uuid-from-hyperv/ #&gt; [cmdletbinding(SupportsShouldProcess=$True)] param( [Parameter(Mandatory=$false,HelpMessage=&quot;Specifies one or more Hyper-V hosts from which virtual machine UUIDs are to be retrieved. NetBIOS names, IP addresses, and fully-qualified domain names are allowable. The default is the local computer — use &quot;&quot;localhost&quot;&quot; or a dot (&quot;&quot;.&quot;&quot;) to specify the local computer explicitly.&quot;)] [string]$ComputerName, [Parameter(Mandatory=$false, Position=0,HelpMessage=&quot;Specifies the virtual machine from which to retrieve the UUID.&quot;)] [string[]]$VM ) # If ComputerName parameter is not specified, set value to the local host If (!$ComputerName) { $ComputerName = &quot;.&quot; } # If VM parameter is specified, return those VMs, else return all VMs If ($VM) { $UUIDs = Get-VM -ComputerName $ComputerName -VM $VM -ErrorAction SilentlyContinue | Select-Object Name,@{Name=&quot;BIOSGUID&quot;;Expression={(Get-WmiObject -ComputerName $_.ComputerName -Namespace &quot;root\virtualization\v2&quot; -Class Msvm_VirtualSystemSettingData -Property BIOSGUID -Filter (&quot;InstanceID = &#39;Microsoft:{0}&#39;&quot; -f $_.VMId.Guid)).BIOSGUID}} } Else { $UUIDs = Get-VM -ComputerName $ComputerName -ErrorAction SilentlyContinue | Select-Object Name,@{Name=&quot;BIOSGUID&quot;;Expression={(Get-WmiObject -ComputerName $_.ComputerName -Namespace &quot;root\virtualization\v2&quot; -Class Msvm_VirtualSystemSettingData -Property BIOSGUID -Filter (&quot;InstanceID = &#39;Microsoft:{0}&#39;&quot; -f $_.VMId.Guid)).BIOSGUID}} } # Remove curly brackets from the UUIDs and return the array ForEach ( $UID in $UUIDs ) { $UID.BIOSGUID = $UID.BIOSGUID -replace &quot;}&quot;; $UID.BIOSGUID = $UID.BIOSGUID -replace &quot;{&quot; } Return $UUIDs }" />
<link rel="canonical" href="/retrieving-a-vms-uuid-from-hyper-v/" />
<meta property="og:url" content="/retrieving-a-vms-uuid-from-hyper-v/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-08-18T12:15:13+10:00" />
<script type="application/ld+json">
{"description":"I’ve previously posted about retrieving the UUID from a virtual machine hosted on vSphere. UUIDs are useful if you want to uniquely identify a target machine for OS deployment task sequences and the like (e.g. MDT). Here’s how to obtain the UUID from a virtual machine hosted on Hyper-V. Just like with vSphere, the UUID isn’t a property of the virtual machine that can be queried directly. We need to go via WMI to query the target virtual machine. Note that in this function, I’m using version 2 of the Root\\Virtualization WMI namespace (root\\virtualization\\v2. This means the function as written, will only work on Windows 8 and Windows Server 2012 (and above). If you want to use this function on earlier versions of Hyper-V, remove the “\\v2” from the namespace. As an example, here’s how to retrieve the UUIDs from a set of VMs on a target Hyper-V host named hv1: C:\\&gt; Get-HypervVMUUID -ComputerName hv1 -VM win71, file3, pvs1 Name BIOSGUID ---- ---- WIN71 E6E1A176-0713-4BB0-99E9-4570A1A3A94A FILE3 9E9D788A-15E2-4760-A049-9F6EB88677A9 PVS1 74EFF5BC-A24E-48C3-85BE-12D758FE7AB6 Here’s the full function code listing. Please let me know if you find any bugs: #--------------------------------------------------------------------------- # Author: Aaron Parker # Desc: Function that uses retrieves the UUID from a specified VM and # formats it into the right format for use with MDT/SCCM etc # Date: Aug 18, 2014 # Site: http://stealthpuppy.com #--------------------------------------------------------------------------- Function Get-HypervVMUUID { &lt;# .SYNOPSIS Retrieve the UUID from a virtual machine or set of virtual machines. .DESCRIPTION This function will retrieve the UUID from from a virtual machine or set of virtual machines from a Hyper-V host. .PARAMETER ComputerName Specifies the host from which to query the virtual machine or set of virtual machines. .PARAMETER VM Specifies the virtual machine or set of virtual machines (a comma delimited list) from which to obtain the UUID/s. .EXAMPLE PS C:\\&amp;gt; Get-HypervVMUUID -ComputerName hv1 -VM win71, win72 This command retrieves the UUIDs from the virtual machines win71 and win72 from the host hv1. .EXAMPLE PS C:\\&amp;gt; Get-HypervVMUUID -VM win71, win72 This command retrieves the UUIDs from the virtual machines win71 and win72 from the local host. .EXAMPLE PS C:\\&amp;gt; Get-HypervVMUUID This command retrieves the UUIDs from the all of the virtual machines on the local host. .NOTES https://stealthpuppy.com/retrieving-a-vms-uuid-from-hyperv/ for support information. .LINK https://stealthpuppy.com/retrieving-a-vms-uuid-from-hyperv/ #&gt; [cmdletbinding(SupportsShouldProcess=$True)] param( [Parameter(Mandatory=$false,HelpMessage=&quot;Specifies one or more Hyper-V hosts from which virtual machine UUIDs are to be retrieved. NetBIOS names, IP addresses, and fully-qualified domain names are allowable. The default is the local computer — use &quot;&quot;localhost&quot;&quot; or a dot (&quot;&quot;.&quot;&quot;) to specify the local computer explicitly.&quot;)] [string]$ComputerName, [Parameter(Mandatory=$false, Position=0,HelpMessage=&quot;Specifies the virtual machine from which to retrieve the UUID.&quot;)] [string[]]$VM ) # If ComputerName parameter is not specified, set value to the local host If (!$ComputerName) { $ComputerName = &quot;.&quot; } # If VM parameter is specified, return those VMs, else return all VMs If ($VM) { $UUIDs = Get-VM -ComputerName $ComputerName -VM $VM -ErrorAction SilentlyContinue | Select-Object Name,@{Name=&quot;BIOSGUID&quot;;Expression={(Get-WmiObject -ComputerName $_.ComputerName -Namespace &quot;root\\virtualization\\v2&quot; -Class Msvm_VirtualSystemSettingData -Property BIOSGUID -Filter (&quot;InstanceID = &#39;Microsoft:{0}&#39;&quot; -f $_.VMId.Guid)).BIOSGUID}} } Else { $UUIDs = Get-VM -ComputerName $ComputerName -ErrorAction SilentlyContinue | Select-Object Name,@{Name=&quot;BIOSGUID&quot;;Expression={(Get-WmiObject -ComputerName $_.ComputerName -Namespace &quot;root\\virtualization\\v2&quot; -Class Msvm_VirtualSystemSettingData -Property BIOSGUID -Filter (&quot;InstanceID = &#39;Microsoft:{0}&#39;&quot; -f $_.VMId.Guid)).BIOSGUID}} } # Remove curly brackets from the UUIDs and return the array ForEach ( $UID in $UUIDs ) { $UID.BIOSGUID = $UID.BIOSGUID -replace &quot;}&quot;; $UID.BIOSGUID = $UID.BIOSGUID -replace &quot;{&quot; } Return $UUIDs }","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/retrieving-a-vms-uuid-from-hyper-v/","headline":"Retrieving a VM’s UUID from Hyper-V","dateModified":"2014-08-18T12:15:13+10:00","datePublished":"2014-08-18T12:15:13+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/retrieving-a-vms-uuid-from-hyper-v/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Retrieving a VM&#39;s UUID from Hyper-V</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2014-08-18T12:15:13+10:00" itemprop="datePublished">Aug 18, 2014
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I’ve previously posted about retrieving the <a href="http://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a> from <a href="/retrieving-a-vms-uuid-from-vsphere/">a virtual machine hosted on vSphere</a>. UUIDs are useful if you want to uniquely identify a target machine for OS deployment task sequences and the like (e.g. MDT). Here’s how to obtain the UUID from a virtual machine hosted on Hyper-V.</p>

<p>Just like with vSphere, the UUID isn’t a property of the virtual machine that can be queried directly. We need to go via WMI to query the target virtual machine. Note that in this function, I’m using <a href="http://blogs.msdn.com/b/virtual_pc_guy/archive/2012/05/30/the-v2-wmi-namespace-in-hyper-v-on-windows-8.aspx">version 2 of the Root\Virtualization WMI namespace</a> (root\virtualization\v2. This means the function as written, will <a href="http://msdn.microsoft.com/en-us/library/hh850319(v=vs.85)">only work on Windows 8 and Windows Server 2012</a> (and above). If you want to use this function on earlier versions of Hyper-V, remove the “\v2” from the namespace.</p>

<p>As an example, here’s how to retrieve the UUIDs from a set of VMs on a target Hyper-V host named <em>hv1</em>:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>C:\&gt; Get-HypervVMUUID -ComputerName hv1 -VM win71, file3, pvs1

Name		BIOSGUID
----		----
WIN71		E6E1A176-0713-4BB0-99E9-4570A1A3A94A 
FILE3		9E9D788A-15E2-4760-A049-9F6EB88677A9 
PVS1		74EFF5BC-A24E-48C3-85BE-12D758FE7AB6
</code></pre></div></div>

<p>Here’s the full function code listing. Please let me know if you find any bugs:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#---------------------------------------------------------------------------</span>
<span class="c1"># Author: Aaron Parker</span>
<span class="c1"># Desc:   Function that uses retrieves the UUID from a specified VM and</span>
<span class="c1">#         formats it into the right format for use with MDT/SCCM etc</span>
<span class="c1"># Date:   Aug 18, 2014</span>
<span class="c1"># Site:   http://stealthpuppy.com</span>
<span class="c1">#---------------------------------------------------------------------------</span>
<span class="k">Function </span>Get-HypervVMUUID <span class="o">{</span>
   <span class="cm">&lt;#
        .SYNOPSIS
            Retrieve the UUID from a virtual machine or set of virtual machines.
 
        .DESCRIPTION
            This function will retrieve the UUID from from a virtual machine or set of virtual machines from a Hyper-V host.
 
        .PARAMETER ComputerName
            Specifies the host from which to query the virtual machine or set of virtual machines.
 
        .PARAMETER VM
            Specifies the virtual machine or set of virtual machines (a comma delimited list) from which to obtain the UUID/s.
 
         .EXAMPLE
            PS C:\&amp;gt; Get-HypervVMUUID -ComputerName hv1 -VM win71, win72
 
            This command retrieves the UUIDs from the virtual machines win71 and win72 from the host hv1.
 
        .EXAMPLE
            PS C:\&amp;gt; Get-HypervVMUUID -VM win71, win72
 
            This command retrieves the UUIDs from the virtual machines win71 and win72 from the local host.
 
        .EXAMPLE
            PS C:\&amp;gt; Get-HypervVMUUID
 
            This command retrieves the UUIDs from the all of the virtual machines on the local host.
 
        .NOTES
            https://stealthpuppy.com/retrieving-a-vms-uuid-from-hyperv/ for support information.
 
        .LINK
            https://stealthpuppy.com/retrieving-a-vms-uuid-from-hyperv/
    #&gt;</span>
    <span class="o">[</span><span class="na">cmdletbinding</span><span class="o">(</span><span class="na">SupportsShouldProcess</span><span class="o">=</span><span class="nv">$True</span><span class="o">)]</span>
    <span class="k">param</span><span class="o">(</span>
        <span class="o">[</span>Parameter<span class="o">(</span><span class="nv">Mandatory</span><span class="o">=</span><span class="nv">$false</span>,HelpMessage<span class="o">=</span><span class="s2">"Specifies one or more Hyper-V hosts from which virtual machine UUIDs are to be retrieved. NetBIOS names, IP addresses, and fully-qualified domain names are allowable. The default is the local computer — use ""localhost"" or a dot (""."") to specify the local computer explicitly."</span><span class="o">)]</span>
        <span class="o">[</span><span class="kt">string</span><span class="o">]</span><span class="nv">$ComputerName</span>,

        <span class="o">[</span>Parameter<span class="o">(</span><span class="nv">Mandatory</span><span class="o">=</span><span class="nv">$false</span>, <span class="nv">Position</span><span class="o">=</span>0,HelpMessage<span class="o">=</span><span class="s2">"Specifies the virtual machine from which to retrieve the UUID."</span><span class="o">)]</span>
        <span class="o">[</span><span class="kt">string</span><span class="o">[]]</span><span class="nv">$VM</span>
    <span class="o">)</span>

    <span class="c1"># If ComputerName parameter is not specified, set value to the local host</span>
    <span class="k">If</span> <span class="o">(!</span><span class="nv">$ComputerName</span><span class="o">)</span> <span class="o">{</span> <span class="nv">$ComputerName</span> <span class="o">=</span> <span class="s2">"."</span> <span class="o">}</span>

    <span class="c1"># If VM parameter is specified, return those VMs, else return all VMs</span>
    <span class="k">If</span> <span class="o">(</span><span class="nv">$VM</span><span class="o">)</span> <span class="o">{</span>
        <span class="nv">$UUIDs</span> <span class="o">=</span> Get-VM -ComputerName <span class="nv">$ComputerName</span> -VM <span class="nv">$VM</span> -ErrorAction SilentlyContinue | <span class="nb">Select-Object </span>Name,@<span class="o">{</span><span class="nv">Name</span><span class="o">=</span><span class="s2">"BIOSGUID"</span>;<span class="nv">Expression</span><span class="o">={(</span><span class="nb">Get-WmiObject</span> -ComputerName <span class="nv">$_</span>.ComputerName -Namespace <span class="s2">"root\virtualization\v2"</span> -Class Msvm_VirtualSystemSettingData -Property BIOSGUID -Filter <span class="o">(</span><span class="s2">"InstanceID = 'Microsoft:{0}'"</span> -f <span class="nv">$_</span>.VMId.Guid<span class="o">))</span>.BIOSGUID<span class="o">}}</span>
    <span class="o">}</span> <span class="k">Else</span> <span class="o">{</span>
        <span class="nv">$UUIDs</span> <span class="o">=</span> Get-VM -ComputerName <span class="nv">$ComputerName</span> -ErrorAction SilentlyContinue | <span class="nb">Select-Object </span>Name,@<span class="o">{</span><span class="nv">Name</span><span class="o">=</span><span class="s2">"BIOSGUID"</span>;<span class="nv">Expression</span><span class="o">={(</span><span class="nb">Get-WmiObject</span> -ComputerName <span class="nv">$_</span>.ComputerName -Namespace <span class="s2">"root\virtualization\v2"</span> -Class Msvm_VirtualSystemSettingData -Property BIOSGUID -Filter <span class="o">(</span><span class="s2">"InstanceID = 'Microsoft:{0}'"</span> -f <span class="nv">$_</span>.VMId.Guid<span class="o">))</span>.BIOSGUID<span class="o">}}</span>
    <span class="o">}</span>

    <span class="c1"># Remove curly brackets from the UUIDs and return the array</span>
    <span class="k">ForEach</span> <span class="o">(</span> <span class="nv">$UID</span> <span class="k">in</span> <span class="nv">$UUIDs</span> <span class="o">)</span> <span class="o">{</span> <span class="nv">$UID</span>.BIOSGUID <span class="o">=</span> <span class="nv">$UID</span>.BIOSGUID -replace <span class="s2">"}"</span>; <span class="nv">$UID</span>.BIOSGUID <span class="o">=</span> <span class="nv">$UID</span>.BIOSGUID -replace <span class="s2">"{"</span> <span class="o">}</span>
    <span class="k">Return</span> <span class="nv">$UUIDs</span>
<span class="o">}</span>
</code></pre></div></div>

  </div><a class="u-url" href="/retrieving-a-vms-uuid-from-hyper-v/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
