<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Keeping The Windows Vista User Folder Clean | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Keeping The Windows Vista User Folder Clean" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Because I’m a stickler for clean UI, I want to ensure users don’t see extra files or folders in their User folder on Windows Vista. I’m trying to avoid something similar to what you can see in the screenshot below, which looks a little out of place:" />
<meta property="og:description" content="Because I’m a stickler for clean UI, I want to ensure users don’t see extra files or folders in their User folder on Windows Vista. I’m trying to avoid something similar to what you can see in the screenshot below, which looks a little out of place:" />
<link rel="canonical" href="/keeping-the-windows-vista-user-folder-clean/" />
<meta property="og:url" content="/keeping-the-windows-vista-user-folder-clean/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-09-18T17:50:20+10:00" />
<script type="application/ld+json">
{"description":"Because I’m a stickler for clean UI, I want to ensure users don’t see extra files or folders in their User folder on Windows Vista. I’m trying to avoid something similar to what you can see in the screenshot below, which looks a little out of place:","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/keeping-the-windows-vista-user-folder-clean/","headline":"Keeping The Windows Vista User Folder Clean","dateModified":"2008-09-18T17:50:20+10:00","datePublished":"2008-09-18T17:50:20+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/keeping-the-windows-vista-user-folder-clean/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Keeping The Windows Vista User Folder Clean</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2008-09-18T17:50:20+10:00" itemprop="datePublished">Sep 18, 2008
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Because I’m a stickler for clean UI, I want to ensure users don’t see extra files or folders in their User folder on Windows Vista. I’m trying to avoid something similar to what you can see in the screenshot below, which looks a little out of place:</p>

<p><img style="display: inline" title="Computer" src="/media/2008/09/computer.png" border="0" alt="Computer" width="566" height="419" /></p>

<p>This location in the UI replaces the Documents folder as the top level navigation tool but it essentially gives you a view of the user profile (%USERPROFILE%). As such, this location cannot be redirected to the network, so it would be advantageous to prevent users from adding data to this folder - otherwise you will need to manage that data. Leaving it inside the roaming profile is probably not the best solution.</p>

<p>Fortunately, Microsoft provide a Group Policy setting that will prevent users from adding files to to this location:</p>

<ul>
  <li>User Configuration / Policies / Administrative Templates / Windows Components / Windows Explorer / Prevent users from adding files to the root of their User Files folder</li>
</ul>

<p><img style="display: inline" title="ExplainPolicy" src="/media/2008/09/explainpolicy.png" border="0" alt="ExplainPolicy" width="357" height="280" /></p>

<p>When this policy is enabled users will see this behaviour when attempting to copy files into their User folder:</p>

<p><img style="display: inline" title="ComputerDragDrop" src="/media/2008/09/computerdragdrop.png" border="0" alt="ComputerDragDrop" width="566" height="423" /></p>

<p>This works well for Explorer but unfortunately I’m struggling to find applications that honour this setting, with Office Communicator and even Windows Live Messenger 9 the biggest culprits so far. These applications create a Tracing folder that is used for <a href="http://support.microsoft.com/kb/871023/en-us">diagnostic logging</a>. These keys control where the log is created:</p>

<ul>
  <li>HKCU\Software\Microsoft\Tracing\uccapi\WindowsLiveMessenger\FileDirectory</li>
  <li>HKCU\Software\Microsoft\Tracing\uccp\Communicator\FileDirectory</li>
  <li>HKCU\Software\Microsoft\Tracing\WPPMedia\WPPFilePath</li>
  <li>HKCU\Software\Microsoft\Tracing\WPPMedia\Debug\WPPFilePath</li>
</ul>

<p>For each key I’ve changed %USERPROFILE% to %APPDATA% (scripted of course..)</p>

<p><img style="display: inline" title="AppData" src="/media/2008/09/appdata.png" border="0" alt="AppData" width="341" height="164" /></p>

<p>So as we rollout Windows Vista, I’m going to have to keep an eye on more applications but I think I could be in for a losing battle.</p>

  </div><a class="u-url" href="/keeping-the-windows-vista-user-folder-clean/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
