<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Keeping The Windows Vista User Folder Clean | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Keeping The Windows Vista User Folder Clean" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Because I’m a stickler for clean UI, I want to ensure users don’t see extra files or folders in their User folder on Windows Vista. I’m trying to avoid something similar to what you can see in the screenshot below, which looks a little out of place:" />
<meta property="og:description" content="Because I’m a stickler for clean UI, I want to ensure users don’t see extra files or folders in their User folder on Windows Vista. I’m trying to avoid something similar to what you can see in the screenshot below, which looks a little out of place:" />
<link rel="canonical" href="/keeping-the-windows-vista-user-folder-clean/" />
<meta property="og:url" content="/keeping-the-windows-vista-user-folder-clean/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-09-18T17:50:20+10:00" />
<script type="application/ld+json">
{"description":"Because I’m a stickler for clean UI, I want to ensure users don’t see extra files or folders in their User folder on Windows Vista. I’m trying to avoid something similar to what you can see in the screenshot below, which looks a little out of place:","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/keeping-the-windows-vista-user-folder-clean/","headline":"Keeping The Windows Vista User Folder Clean","dateModified":"2008-09-18T17:50:20+10:00","datePublished":"2008-09-18T17:50:20+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/keeping-the-windows-vista-user-folder-clean/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About</a><a class="page-link" href="/about/">About</a><a class="page-link" href="/app-v-5-x-versions.html">App-V 5.x Versions</a><a class="page-link" href="/appv-faqs.html">App-V 4.x FAQs</a><a class="page-link" href="/appv5-faqs.html">Microsoft Application Virtualization 5 FAQs</a><a class="page-link" href="/appvrecipes.html">App-V Recipes</a><a class="page-link" href="/archives.html">Archives</a><a class="page-link" href="/home-page.html">Home Page</a><a class="page-link" href="/scriptcorner.html">Script Corner</a><a class="page-link" href="/search-results.html">Search Results</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS &amp;#8211; Why you should stop referring to CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Keeping The Windows Vista User Folder Clean</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2008-09-18T17:50:20+10:00" itemprop="datePublished">Sep 18, 2008
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Because I’m a stickler for clean UI, I want to ensure users don’t see extra files or folders in their User folder on Windows Vista. I’m trying to avoid something similar to what you can see in the screenshot below, which looks a little out of place:</p>

<p><img style="display: inline" title="Computer" src="http://stealthpuppy.com/wp-content/uploads/2008/09/computer.png" border="0" alt="Computer" width="566" height="419" /></p>

<p>This location in the UI replaces the Documents folder as the top level navigation tool but it essentially gives you a view of the user profile (%USERPROFILE%). As such, this location cannot be redirected to the network, so it would be advantageous to prevent users from adding data to this folder – otherwise you will need to manage that data. Leaving it inside the roaming profile is probably not the best solution.</p>

<p>Fortunately, Microsoft provide a Group Policy setting that will prevent users from adding files to to this location:</p>

<ul>
  <li>User Configuration / Policies / Administrative Templates / Windows Components / Windows Explorer / Prevent users from adding files to the root of their User Files folder</li>
</ul>

<p><img style="display: inline" title="ExplainPolicy" src="http://stealthpuppy.com/wp-content/uploads/2008/09/explainpolicy.png" border="0" alt="ExplainPolicy" width="357" height="280" /></p>

<p>When this policy is enabled users will see this behaviour when attempting to copy files into their User folder:</p>

<p><img style="display: inline" title="ComputerDragDrop" src="http://stealthpuppy.com/wp-content/uploads/2008/09/computerdragdrop.png" border="0" alt="ComputerDragDrop" width="566" height="423" /></p>

<p>This works well for Explorer but unfortunately I’m struggling to find applications that honour this setting, with Office Communicator and even Windows Live Messenger 9 the biggest culprits so far. These applications create a Tracing folder that is used for <a href="http://support.microsoft.com/kb/871023/en-us">diagnostic logging</a>. These keys control where the log is created:</p>

<ul>
  <li>HKCU\Software\Microsoft\Tracing\uccapi\WindowsLiveMessenger\FileDirectory</li>
  <li>HKCU\Software\Microsoft\Tracing\uccp\Communicator\FileDirectory</li>
  <li>HKCU\Software\Microsoft\Tracing\WPPMedia\WPPFilePath</li>
  <li>HKCU\Software\Microsoft\Tracing\WPPMedia\Debug\WPPFilePath</li>
</ul>

<p>For each key I’ve changed %USERPROFILE% to %APPDATA% (scripted of course..)</p>

<p><img style="display: inline" title="AppData" src="http://stealthpuppy.com/wp-content/uploads/2008/09/appdata.png" border="0" alt="AppData" width="341" height="164" /></p>

<p>So as we rollout Windows Vista, I’m going to have to keep an eye on more applications but I think I could be in for a losing battle.</p>

  </div><a class="u-url" href="/keeping-the-windows-vista-user-folder-clean/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
