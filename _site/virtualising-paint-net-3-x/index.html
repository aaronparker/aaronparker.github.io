<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Virtualising Paint.NET 3.x | aaron parker</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Virtualising Paint.NET 3.x" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This post details virtualising Paint.NET 3.x with Microsoft Application Virtualization; however the same basic steps should apply to any application virtualisation product." />
<meta property="og:description" content="This post details virtualising Paint.NET 3.x with Microsoft Application Virtualization; however the same basic steps should apply to any application virtualisation product." />
<link rel="canonical" href="/virtualising-paint-net-3-x/" />
<meta property="og:url" content="/virtualising-paint-net-3-x/" />
<meta property="og:site_name" content="aaron parker" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-05-17T19:09:42+10:00" />
<script type="application/ld+json">
{"description":"This post details virtualising Paint.NET 3.x with Microsoft Application Virtualization; however the same basic steps should apply to any application virtualisation product.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/virtualising-paint-net-3-x/","headline":"Virtualising Paint.NET 3.x","dateModified":"2010-05-17T19:09:42+10:00","datePublished":"2010-05-17T19:09:42+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/virtualising-paint-net-3-x/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="aaron parker" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">aaron parker</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Virtualising Paint.NET 3.x</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2010-05-17T19:09:42+10:00" itemprop="datePublished">May 17, 2010
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img style="margin: 0px 0px 10px 10px; display: inline; border-width: 0px;" title="AppVPaintDotNet" src="http://stealthpuppy.com/wp-content/uploads/2010/05/AppVPaintDotNet.png" border="0" alt="AppVPaintDotNet" width="128" height="124" align="right" /> This post details virtualising <a href="http://getpaint.net">Paint.NET 3.x</a> with Microsoft Application Virtualization; however the same basic steps should apply to any application virtualisation product.</p>

<p>Virtualising Paint.NET is a simple two step process:</p>

<ol>
  <li>Configure an unattended installation that installs Paint.NET to configure specific options, including disabling automatic update checks</li>
  <li>Capture the Paint.NET package and customise it for execution</li>
</ol>

<h3 id="prerequisites">Prerequisites</h3>

<p>Paint.NET <a href="http://www.getpaint.net/doc/latest/en/SystemRequirements.html">requires Windows XP SP2 and above and the .NET Framework 3.5 or 4.0</a>. The .NET Framework should be installed on your sequencing machine and be deployed to client computers before delivering Paint.NET.</p>

<h3 id="creating-an-unattended-installation-for-paintnet">Creating an unattended installation for Paint.NET</h3>

<p>The Paint.NET documentation explains <a href="http://www.getpaint.net/doc/latest/en/UnattendedInstallation.html">how to create an unattended installation</a>. There are a number of options that are important when virtualising Paint.NET:</p>

<ul>
  <li>TARGETDIR - specify an installation folder on the virtual drive. This is not required and you can successfully sequence a VFS install of this application</li>
  <li>CHECKFORUPDATES - it is important to set this value to 0 to disable prevent Paint.NET from automatically prompting users to update the package. Users will still be able to access the <em>Utilities / Check for Updates</em> menu item - Resource Hacker or other tools such as AppSense Environment Manager can be used to disable this menu item</li>
  <li>CHECKFORBETAS - if CHECKFORUPDATES is set to 0 then this option should automatically be set to 0 as well; however I have set this option in my install script</li>
</ul>

<p>Unfortunately the updater component is in process so it is difficult to remove from the installation. Additionally deleting files associated with the updater results in Paint.NET attempting to repair itself on start-up:</p>

<p><img style="display: inline; border-width: 0px;" title="PaintDotNetRepairFiles" src="http://stealthpuppy.com/wp-content/uploads/2010/05/PaintDotNetRepairFiles.png" border="0" alt="PaintDotNetRepairFiles" width="448" height="190" /></p>

<ul>
  <li>JPGPNGBMPEDITOR - if you want Paint.NET to be the default editor for JPG, PNG and BMP files, set this to 1</li>
  <li>TGAEDITOR - if you want Paint.NET to be the default editor for TGA files, set this to 1</li>
  <li>DESKTOPSHORTCUT - setting this to 0 will prevent setup from creating a desktop shortcut</li>
</ul>

<p>I have included a sample script below, that shows the unattended options that I have used during sequencing:</p>

<p class="download">
  [download id=37 format=1]
</p>

<h3 id="virtualising-or-sequencing-paintnet">Virtualising (or Sequencing) Paint.NET</h3>

<p>Before sequencing, ensure your sequencing image has been configured with the Microsoft .NET Framework 3.5 or 4.0 - if you are sequencing on Windows 7, version 3.5 is already included. Here’s what you should configure before sequencing:</p>

<ul>
  <li>Install or enable the .NET Framework - use the same version of the .NET Framework that is deployed to your client computers</li>
  <li>Disable System Protection (or System Restore) - setup creates a restore point during install which we don’t want to capture</li>
  <li>Add an exclusion for <em>CSIDL_DESKTOP</em> - if Paint.NET crashed during sequencing it will place a log file on the desktop which we don’t want to capture</li>
  <li>Add an exclusion for <em>CSIDL_Windows\Installer</em> so that the cached MSI file is not captured in the package</li>
  <li>Copy the installation script and the Paint.NET installer to a local path inside the sequencing machine</li>
</ul>

<p>The sequencing process that should be followed will look like this:</p>

<ol>
  <li>Start monitoring</li>
  <li>Install Paint.NET using the silent install script. Do not run Paint.NET at this point as it will crash on launch</li>
  <li>Stop Monitoring to allow the sequencer to process the changes</li>
  <li>Start Monitoring</li>
  <li>Run Paint.NET and configure defaults if required. Check that automatic updates has been disabled.</li>
  <li>Stop Monitoring and continue</li>
  <li>Customise the shortcut and file type associations</li>
  <li>Configure feature block 1 only if required</li>
</ol>

<p>The Choose Defaults options are available from the Tool drop down button on the toolbar:</p>

<p><img style="display: inline; border-width: 0px;" title="PaintDotNetDefaults" src="http://stealthpuppy.com/wp-content/uploads/2010/05/PaintDotNetDefaults.png" border="0" alt="PaintDotNetDefaults" width="588" height="585" /></p>

<h3 id="conclusion">Conclusion</h3>

<p>Virtualising Paint.NET should be very quick and can be sequenced on 32-bit and 64-bit Windows. Even if sequenced on 32-bit Windows, Paint.NET will execute as a 64-bit application under Windows x64 - no re-sequencing required.</p>

<p>One final item to fix up when creating the package is the file type icon that is extracted from the Paint.NET executable is only a 32×32 pixel icon. To make associated files look better under Windows Vista and Windows 7, you could replace this with an icon that includes a 256×256 pixel size image.</p>

  </div><a class="u-url" href="/virtualising-paint-net-3-x/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">aaron parker</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">{&quot;name&quot;=&gt;&quot;Aaron Parker&quot;, &quot;location&quot;=&gt;&quot;Melbourne, Australia&quot;, &quot;email&quot;=&gt;&quot;aaron@stealthpuppy.com&quot;, &quot;github&quot;=&gt;&quot;aaronparker&quot;, &quot;linkedin&quot;=&gt;&quot;aaronedwardparker&quot;, &quot;twitter&quot;=&gt;&quot;stealthpuppy&quot;}</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
