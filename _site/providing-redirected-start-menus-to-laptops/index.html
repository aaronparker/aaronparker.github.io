<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Providing Redirected Start Menus To Laptops | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Providing Redirected Start Menus To Laptops" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="John has asked about using Offline Files as a method of fault tolerance instead of DFS on my previous post. Sounds like a great blog post (and it gives my an excuse to avoid my eight other draft posts), so here’s my answer:" />
<meta property="og:description" content="John has asked about using Offline Files as a method of fault tolerance instead of DFS on my previous post. Sounds like a great blog post (and it gives my an excuse to avoid my eight other draft posts), so here’s my answer:" />
<link rel="canonical" href="/providing-redirected-start-menus-to-laptops/" />
<meta property="og:url" content="/providing-redirected-start-menus-to-laptops/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-04-08T22:12:16+10:00" />
<script type="application/ld+json">
{"description":"John has asked about using Offline Files as a method of fault tolerance instead of DFS on my previous post. Sounds like a great blog post (and it gives my an excuse to avoid my eight other draft posts), so here’s my answer:","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/providing-redirected-start-menus-to-laptops/","headline":"Providing Redirected Start Menus To Laptops","dateModified":"2008-04-08T22:12:16+10:00","datePublished":"2008-04-08T22:12:16+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/providing-redirected-start-menus-to-laptops/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Providing Redirected Start Menus To Laptops</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2008-04-08T22:12:16+10:00" itemprop="datePublished">Apr 8, 2008
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img src="https://stealthpuppy.com/media/2008/04/offlinestartmenu.png" border="0" alt="OfflineStartMenu" width="124" height="113" align="left" /> <a href="http://www.gilham.org/Blog/default.aspx">John</a> has <a href="/terminal-server/building-dynamic-start-menus-with-access-based-enumeration#comment-13345">asked</a> about using Offline Files as a method of fault tolerance instead of DFS on <a href="/terminal-server/building-dynamic-start-menus-with-access-based-enumeration">my previous post</a>. Sounds like a great blog post (and it gives my an excuse to avoid my eight other draft posts), so here’s my answer:</p>

<p>First up, I would not rely on Offline Files as a method of fault tolerance. It will work as a solution for laptops operating disconnected from the network, but won’t provide effective fault tolerance. Offline Files are also not available on Terminal Server.</p>

<p>If you were to rely on Offline Files, you will have issues if the server the share is located goes down and can’t be restored. Using Group Policy to redirect user folders requires that the original source location is available if you ever want to change the redirection path. This is why DFS Namespace is a good match for folder redirection - the DFS path remains static, while the real path can change.</p>

<p>DFS Namespaces and DFS Replication offer a far better solution for fault tolerance and DFS is available in Windows 2000 Server and above. If you want FT without using a 3rd party solution take a look at <a href="http://technet2.microsoft.com/WindowsServer/en/Library/8c4cf2e7-0b92-4643-acbd-abfa9f189d031033.mspx?mfr=true">DFS Replication</a>.</p>

<p>I spent some time this evening to configure a redirected Start Menu for Windows Vista laptops in my test environment. Here’s my notes for recreating this setup and how it went:</p>

<p>This is very similar to redirected <a href="/terminal-server/building-dynamic-start-menus-with-access-based-enumeration">Start Menus for Terminal Servers</a> with some minor differences.</p>

<p>Create a GPO linked to the OU that contains your target workstations and enable Group Policy loopback mode. You would generally target similarly configured workstations just like you would do for Terminal Servers. In my test environment I’m configuring this for Windows Vista, I’ve enabled a WMI filter on this GPO so that it only applies to Vista and above:</p>

<p>[code]SELECT Version FROM Win32_OperatingSystem WHERE Version &gt;= ‘6’[/code]</p>

<p>Edit the GPO and enable these settings (here’s the <a href="/media/2008/04/WindowsVistaStartMenu.htm">full GPO report</a>):</p>

<ul>
  <li>Computer Configuration / Administrative Templates / System / Group Policy / User Group Policy loopback processing mode</li>
  <li>User Configuration / Windows Settings / Folder Redirection / Start Menu / Basic (Redirect everyone’s folder to the same location) / Redirect to the following path: In my test environment, I’m using this DFS path: <em>\dev.localPublicStartMenusWindowsVista</em></li>
  <li>Grant user exclusive rights to Start Menu</li>
  <li>Move the contents of Start Menu to the new location</li>
  <li>Redirect the folder back to the local userprofile location when policy is removed</li>
  <li>User Configuration / Administrative Templates / Start Menu and Taskbar / Remove common program groups from Start Menu</li>
  <li>User Configuration / Administrative Templates / Network / Offline Files / Administratively assigned offline files: <em>\dev.localPublicStartMenusWindowsVista</em></li>
</ul>

<p>The last setting will ensure that the Start Menu will be cached by the workstation and available to the user offline. Here’s my configured folder which has been cached locally:</p>

<p><a href="/media/2008/04/windowsvistastartmenu.png"><img src="https://stealthpuppy.com/media/2008/04/windowsvistastartmenu-thumb.png" border="0" alt="WindowsVistaStartMenu" width="686" height="479" /></a></p>

<p>Make sure you configure your Start Menus with access-based enumeration and the right permissions before users access them. If you don’t and users’ workstations cache the shortcuts, you might end up unavailable shortcuts looking like this:</p>

<p><img src="https://stealthpuppy.com/media/2008/04/startmenumissedicon.png" border="0" alt="StartMenuMissedIcon" width="211" height="156" /></p>

<p>Although I’ve only done some limited testing I think this solution would work quite well. One important thing to remember is that you will need to add your internal DNS domain to the Intranet zone (when using a domain-based DFS Namespace) otherwise users will be prompted with a trust dialog each time they run a shortcut from the Start Menu.</p>

  </div><a class="u-url" href="/providing-redirected-start-menus-to-laptops/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">{&quot;name&quot;=&gt;&quot;Some Person&quot;}</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
