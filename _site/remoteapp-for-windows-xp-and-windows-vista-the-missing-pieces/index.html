<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>RemoteApp for Windows XP and Windows Vista, the missing pieces | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="RemoteApp for Windows XP and Windows Vista, the missing pieces" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="You may recall from my last post on RemoteApp, that we can get RemoteApp for Hyper-V works on other platforms too. While it was straight-forward publishing applications from a Windows 7 host, the client would report this error when connecting to Windows XP and Windows Vista hosts:" />
<meta property="og:description" content="You may recall from my last post on RemoteApp, that we can get RemoteApp for Hyper-V works on other platforms too. While it was straight-forward publishing applications from a Windows 7 host, the client would report this error when connecting to Windows XP and Windows Vista hosts:" />
<link rel="canonical" href="/remoteapp-for-windows-xp-and-windows-vista-the-missing-pieces/" />
<meta property="og:url" content="/remoteapp-for-windows-xp-and-windows-vista-the-missing-pieces/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-02-20T03:17:58+11:00" />
<script type="application/ld+json">
{"description":"You may recall from my last post on RemoteApp, that we can get RemoteApp for Hyper-V works on other platforms too. While it was straight-forward publishing applications from a Windows 7 host, the client would report this error when connecting to Windows XP and Windows Vista hosts:","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/remoteapp-for-windows-xp-and-windows-vista-the-missing-pieces/","headline":"RemoteApp for Windows XP and Windows Vista, the missing pieces","dateModified":"2010-02-20T03:17:58+11:00","datePublished":"2010-02-20T03:17:58+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/remoteapp-for-windows-xp-and-windows-vista-the-missing-pieces/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">RemoteApp for Windows XP and Windows Vista, the missing pieces</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2010-02-20T03:17:58+11:00" itemprop="datePublished">Feb 20, 2010
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>You may recall from <a href="https://stealthpuppy.com/virtualisation/remoteapp-for-hyper-v-hyper-what">my last post on RemoteApp</a>, that we can get RemoteApp for Hyper-V works on other platforms too. While it was straight-forward publishing applications from a Windows 7 host, the client would report this error when connecting to Windows XP and Windows Vista hosts:<br />
<img style="display: inline; margin-top: 5px;" title="RemoteAppNotSupported" src="https://stealthpuppy.com/media/2009/12/RemoteAppNotSupported.png" alt="RemoteAppNotSupported" width="430" height="203" border="0" /></p>

<p>Kind of annoying, because the original <a href="http://blogs.msdn.com/rds/archive/2009/12/15/remoteapp-for-hyper-v.aspx">RemoteApp for Hyper-V post</a> on the RDS blog, showed us something cool but left out the important part on how to get it working. Well, thanks to <a href="http://blogs.technet.com/virtualworld">Justin</a> and <a href="http://blogs.msdn.com/rds/archive/2009/12/15/remoteapp-for-hyper-v.aspx#9964757">this comment</a>, I’ve been able to fix the issue and get RemoteApp running on XP and Vista (unfortunately I can’t take any of the credit).</p>

<p>Liam Westley has already done a great job of <a href="http://geekswithblogs.net/twickers/archive/2009/12/18/137048.aspx">documenting the complete process for setting up RemoteApp</a>, so for full details go there - I’ll just summarise and fill in the missing pieces.</p>

<h3 id="what-youll-need">What You’ll Need</h3>

<p>First up there is a set of minimum components that will need to be in place:</p>

<ul>
  <li>The client computer can be Windows XP SP3, Windows Vista SP1+ or Windows 7 (unless Microsoft decides to release an RDC update for Windows Server – unfortunately I don’t think they will)</li>
  <li>Remote Desktop Connection 7.0 – built into Windows 7, available for <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=72158b4e-b527-45e4-af24-d02938a95683">Windows XP (KB969084)</a> and <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=ac7e58f3-2fd4-4fec-abfd-8002d34476f4">Windows Vista (KB969084)</a></li>
  <li>The RemoteApp host can be Windows XP SP3, Windows Vista SP1+ or Windows 7</li>
  <li>If the RemoteApp host is running Windows XP or Windows Vista, you’ll need the following updates: <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=e5433d88-685f-4036-b435-570ff53598cd">Update for Windows XP SP3 to enable RemoteApp</a> or <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=26a2de17-8355-4e8d-8f33-9211e48651fb">Update for Windows Vista SP1 or above to enable RemoteApp</a> (Windows 7 works out of the box)</li>
</ul>

<h3 id="configure-the-remoteapp-host">Configure the RemoteApp Host</h3>

<p>When configuring the host, I’ve been using been using a 1-to-1 setup, I haven’t tested this with pooled virtual desktops yet.</p>

<p>To enable RemoteApp on the host, install the hotfix, then configure the <code class="highlighter-rouge">TsAppAllowList</code> key in the registry. In this example, I’ve configured the required entries for running Calculator. Here’s a listing of the registry values I added with the pertinent values highlighted.</p>

<p>[code highlight=”2,9,12″ wraplines=”true”][HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\TSAppAllowList]<br />
“fDisabledAllowList”=dword:00000001</p>

<p>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Terminal Server\TSAppAllowList\Applications\calc]<br />
“CommandLineSetting”=dword:00000000<br />
“RequiredCommandLine”=””<br />
“IconIndex”=dword:00000000<br />
“IconPath”=”%windir%\system32\calc.exe”<br />
“Path”=”C:\Windows\system32\calc.exe”<br />
“VPath”=”%SYSTEMDRIVE%\Windows\system32\calc.exe”<br />
“ShowInTSWA”=dword:00000001<br />
“Name”=”Calculator”<br />
“SecurityDescriptor”=””[/code]</p>

<p>The simplest method of discovering the required registry keys for each RemoteApp entry is to configure the applications on Windows XP Mode or Windows Server 2008 running Remote Desktop Services.</p>

<h3 id="creating-remoteapp-connections">Creating RemoteApp Connections</h3>

<p>I’ve originally based the .RDP file on those created by the RemoteApp Manager in Windows Server. There is documentation on TechNet on how to configure RemoteApp programs and creating the .RDP file for each application here: <a href="http://technet.microsoft.com/en-us/library/cc733174.aspx">Configuring RemoteApp Programs</a>.</p>

<p>The important entries for connecting to Windows XP and Windows Vista, that you may need to add manually, are <code class="highlighter-rouge">disableremoteappcapscheck</code> (set to 1) and <code class="highlighter-rouge">alternate shell</code> (set to rdpinit.exe). These were the only additional entries I need to add the .RDP file to get this working. DisableRemoteAppCapsCheck fixes the ‘remote computer does not support RemoteApp’ error, and Alternate Shell makes sure you actually get a published application and not a remote desktop.</p>

<p>An .RDP file to connect to a RemoteApp program then looks like this (the added lines are highlighted):</p>

<p>[code highlight=”23,24″]redirectclipboard:i:1<br />
redirectposdevices:i:0<br />
redirectprinters:i:1<br />
redirectcomports:i:1<br />
redirectsmartcards:i:1<br />
devicestoredirect:s:*<br />
drivestoredirect:s:*<br />
redirectdrives:i:1<br />
session bpp:i:32<br />
prompt for credentials on client:i:1<br />
span monitors:i:1<br />
use multimon:i:1<br />
remoteapplicationmode:i:1<br />
server port:i:3389<br />
allow font smoothing:i:1<br />
promptcredentialonce:i:0<br />
authentication level:i:2<br />
full address:s:winxp1.domain.local<br />
remoteapplicationprogram:s:||calc<br />
remoteapplicationname:s:calculator<br />
remoteapplicationcmdline:s:<br />
alternate full address:s:winxp1.domain.local<br />
disableremoteappcapscheck:i:1<br />
alternate shell:s:rdpinit.exe<br />
screen mode id:i:2<br />
winposstr:s:0,3,0,0,800,600<br />
compression:i:1<br />
keyboardhook:i:2<br />
audiocapturemode:i:0<br />
videoplaybackmode:i:1<br />
connection type:i:2<br />
displayconnectionbar:i:1<br />
disable wallpaper:i:1<br />
allow desktop composition:i:0<br />
disable full window drag:i:1<br />
disable menu anims:i:1<br />
disable themes:i:0<br />
disable cursor setting:i:0<br />
bitmapcachepersistenable:i:1<br />
audiomode:i:0<br />
redirectdirectx:i:1<br />
autoreconnection enabled:i:1<br />
prompt for credentials:i:0<br />
negotiate security layer:i:1<br />
remoteapplicationicon:s:<br />
shell working directory:s:<br />
gatewayhostname:s:<br />
gatewayusagemethod:i:4<br />
gatewaycredentialssource:i:4<br />
gatewayprofileusagemethod:i:0<br />
use redirection server name:i:0[/code]</p>

<h3 id="remoteapp-in-action">RemoteApp in Action</h3>

<p>When launching the RemoteApp program, the UI isn’t quite as seamless as you get with the XenApp client. You will first see a warning prompt if the .RDP file is not signed, and then a dialog box while the client connects:</p>

<p><a href="https://stealthpuppy.com/virtualisation/remoteapp-for-windows-xp-and-windows-vista-the-missing-pieces/attachment/remoteappconnect-2/" rel="attachment wp-att-1369"><img class="alignnone size-full wp-image-1369" title="RemoteAppConnect" src="https://stealthpuppy.com/media/2010/02/RemoteAppConnect1.png" alt="" width="453" height="285" srcset="https://stealthpuppy.com/media/2010/02/RemoteAppConnect1.png 453w, https://stealthpuppy.com/media/2010/02/RemoteAppConnect1-150x94.png 150w, https://stealthpuppy.com/media/2010/02/RemoteAppConnect1-300x188.png 300w" sizes="(max-width: 453px) 100vw, 453px" /></a></p>

<p>If the RemoteApp host is Windows XP, the user will be required to click the Details button to see the remote login dialog box and enter their credentials:</p>

<p><a href="https://stealthpuppy.com/virtualisation/remoteapp-for-windows-xp-and-windows-vista-the-missing-pieces/attachment/remoteappauth-2/" rel="attachment wp-att-1368"><img class="alignnone size-full wp-image-1368" title="RemoteAppAuth" src="https://stealthpuppy.com/media/2010/02/RemoteAppAuth1.png" alt="" width="660" height="609" srcset="https://stealthpuppy.com/media/2010/02/RemoteAppAuth1.png 660w, https://stealthpuppy.com/media/2010/02/RemoteAppAuth1-150x138.png 150w, https://stealthpuppy.com/media/2010/02/RemoteAppAuth1-300x276.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a></p>

<p>If the client is Windows XP or above and the host is Windows Vista or above, you can configure <a href="http://blogs.msdn.com/rds/archive/2007/04/19/how-to-enable-single-sign-on-for-my-terminal-server-connections.aspx">credential pass-through (single sign-on)</a> to make connecting seamless. You must first <a href="http://support.microsoft.com/kb/951608">enable CredSSP</a> on Windows XP SP3 clients. Pass-through won’t work for Windows XP hosts - although you may be able to save the username and password in the .RDP file instead.</p>

<p>So finally with all of the pieces in place, here’s what you’ll see with applications running via RemoteApp. In this screenshot I have Calculator running remotely from Windows XP and Windows Vista next to the local version.</p>

<p><a href="https://stealthpuppy.com/media/2010/02/DesktopWithCalculator.png"><img style="display: inline; border: 0px;" title="DesktopWithCalculator" src="https://stealthpuppy.com/media/2010/02/DesktopWithCalculator_thumb.png" alt="DesktopWithCalculator" width="660" height="432" border="0" /></a></p>

<p>One thing to note is that the remote applications are all group together on the taskbar; in this screenshot, the two remote Calculators are grouped with Remote Desktop Connection – users’ won’t see separate remote buttons as you get in competing products.</p>

<h3 id="so-whats-left">So What’s Left?</h3>

<p>Use of RemoteApp is <a href="https://stealthpuppy.com/virtualisation/remoteapp-for-hyper-v-hyper-what">not restricted to the brand of hypervisor</a> - RemoteApp will be available on Windows XP+ regardless of where it is running. You could, for example, use blade PCs as hosts.</p>

<p>If you have Citrix XenApp or Quest vWorkspace, you already have tools to publishing applications from virtual desktops, so where would this actually be useful? SMBs without either product would benefit (although I have had one enterprise customer ask me about this feature) or perhaps this would work as a replacement for Windows XP Mode if you don’t like Windows Virtual PC (and who does?).</p>

<p>Deploying and managing the .RDP files could be fun. A simple method of deployment would involve the use of <a href="http://technet.microsoft.com/en-us/library/cc771468.aspx">Windows Installer packages adapted from those generated by RemoteApp Manager</a>. You could also use your user environment management tool of choice; however the option that holds most promise is <a href="http://blogs.msdn.com/rds/archive/2009/11/11/remoteapp-and-desktop-connection-management-extensibility-for-provisioning-apps-via-rd-web-access.aspx">extending RD Web Access</a>. Custom code will be required, but it would replace copying .RDP files to users’ desktops and could even support pooled virtual desktops.</p>

<p>Ultimately it would be nice to see this documented on TechNet. Apparently though, the RDS team are working on a follow up post that should give us all the info we need and more.</p>

<h3 id="update-october-2011">Update (October 2011)</h3>

<p>Kim Knight has written a GUI tool to configure the RemoteApp application and create an RDP file to deliver to clients. This will automate the entire process for you. <a href="https://sites.google.com/site/kimknight/remoteapptool">RemoteApp Tool</a>.</p>

  </div><a class="u-url" href="/remoteapp-for-windows-xp-and-windows-vista-the-missing-pieces/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
