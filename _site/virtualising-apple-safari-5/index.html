<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Virtualising Apple Safari 5 | aaron parker</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Virtualising Apple Safari 5" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This post details virtualising Apple Safari 5.x with Microsoft Application Virtualization; however the same basic steps should apply to any application virtualisation product." />
<meta property="og:description" content="This post details virtualising Apple Safari 5.x with Microsoft Application Virtualization; however the same basic steps should apply to any application virtualisation product." />
<link rel="canonical" href="/virtualising-apple-safari-5/" />
<meta property="og:url" content="/virtualising-apple-safari-5/" />
<meta property="og:site_name" content="aaron parker" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-06-22T21:29:54+10:00" />
<script type="application/ld+json">
{"description":"This post details virtualising Apple Safari 5.x with Microsoft Application Virtualization; however the same basic steps should apply to any application virtualisation product.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/virtualising-apple-safari-5/","headline":"Virtualising Apple Safari 5","dateModified":"2010-06-22T21:29:54+10:00","datePublished":"2010-06-22T21:29:54+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/virtualising-apple-safari-5/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="aaron parker" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">aaron parker</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Virtualising Apple Safari 5</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2010-06-22T21:29:54+10:00" itemprop="datePublished">Jun 22, 2010
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="http://stealthpuppy.com/wp-content/uploads/2010/06/AppVSafari.png"><img style="margin: 0px 0px 0px 10px; display: inline; border-width: 0px;" title="AppV-Safari" src="http://stealthpuppy.com/wp-content/uploads/2010/06/AppVSafari_thumb.png" border="0" alt="AppV-Safari" width="128" height="124" align="right" /></a> This post details virtualising <a href="http://www.apple.com/safari/">Apple Safari</a> 5.x with Microsoft Application Virtualization; however the same basic steps should apply to any application virtualisation product.</p>

<p>Virtualising Apple Safari is a two step process:</p>

<ol>
  <li>Extract the setup files from the download so that we can perform a custom installation of Safari</li>
  <li>Capture the Safari 5 package and customise it for execution</li>
</ol>

<h3 id="prerequisites">Prerequisites</h3>

<p>Other than Windows XP Service Pack 2 or above, there are no specific prerequisites for installing Safari.</p>

<h3 id="creating-a-custom-installation-of-safari">Creating a custom installation of Safari</h3>

<p>The default installation of Safari will install Apple Software Update so it’s important to prevent this from installing during sequencing so that the package is not automatically updated once deployed. <a href="http://en.wikipedia.org/wiki/Apple_Bonjour">Bonjour</a> is also installed; however this is optional.</p>

<p>There are a few ways to extract the Safari installer, but I find this process is simplest - <a href="http://www.apple.com/safari/download/">Download the Safari installer</a> and execute it, but do not step through the installation. The setup files will be extracted to your Temp folder (%TEMP%), so grab a copy from there. The following files will be extracted:</p>

<ul>
  <li>AppleApplicationSupport.msi</li>
  <li>AppleSoftwareUpdate.msi</li>
  <li>Bonjour.msi</li>
  <li>Bonjour64.msi</li>
  <li>Safari.msi</li>
  <li>SetupAdmin.exe</li>
</ul>

<p>We don’t need <em>AppleSoftwareUpdate.msi</em> because automatic updates for this package will be disabled and we also don’t need SetupAdmin.exe. Using the remaining files, we can script an installation of Safari and its’ dependant components. The following script listing will automate the installation of Safari for sequencing with App-V:</p>

<p>[code]@ECHO OFF<br />
START /WAIT MSIEXEC /I AppleApplicationSupport.msi ALLUSERS=TRUE REBOOT=SUPRESS /QB<br />
IF “%PROCESSOR_ARCHITECTURE%”==”x86” START /WAIT MSIEXEC /I Bonjour.msi ALLUSERS=TRUE REBOOT=SUPRESS /QB<br />
IF “%PROCESSOR_ARCHITECTURE%”==”AMD64” START /WAIT MSIEXEC /I Bonjour64.msi ALLUSERS=TRUE REBOOT=SUPRESS /QB<br />
START /WAIT Safari.MSI SCHEDULE_ASUW=0 DESKTOP_SHORTCUTS=0 INSTALLDIR=Q:\SAFARI5x.000\Safari ALLUSERS=TRUE REBOOT=SUPPRESS /QB[/code]</p>

<h3 id="virtualising-or-sequencing-safari">Virtualising (or Sequencing) Safari</h3>

<p>Capturing the Safari package is very simple - no exclusions were added and the following steps should produce a successful package:</p>

<ol>
  <li>
    <p>Start monitoring and install Safari using the sample script listed above</p>
  </li>
  <li>
    <p>Before stopping the monitoring process, run Safari at least once</p>
  </li>
  <li>
    <p>Safari will prompt you to make it the default browser, be sure answer Yes to this dialog box so that the registry keys that are set are captured by the Sequencer. This will ensure that those keys are not written to the real registry if the user attempts to set Safari as the default browser at execution time. If they were to do this, then Windows would be unable to launch the default browser (as it is now inside the bubble).</p>
  </li>
</ol>

<p><a href="http://stealthpuppy.com/wp-content/uploads/2010/06/SafariSetAsDefaultBrowser.png"><img style="display: inline; border: 0px;" title="Safari-Set-As-Default-Browser" src="http://stealthpuppy.com/wp-content/uploads/2010/06/SafariSetAsDefaultBrowser_thumb.png" border="0" alt="Safari-Set-As-Default-Browser" width="482" height="183" /></a></p>

<ol>
  <li>
    <p>Configure options as you need them, such as displaying the status bar, changing tab options etc</p>
  </li>
  <li>
    <p>Finally, delete the imported Internet Explorer Favourites (unless you specifically want to keep them):</p>
  </li>
</ol>

<p><a href="http://stealthpuppy.com/wp-content/uploads/2010/06/SafariImportedIEFavourites.png"><img style="display: inline; border: 0px;" title="Safari-Imported-IE-Favourites" src="http://stealthpuppy.com/wp-content/uploads/2010/06/SafariImportedIEFavourites_thumb.png" border="0" alt="Safari-Imported-IE-Favourites" width="660" height="286" /></a></p>

<ol>
  <li>Stop monitoring and move onto the detected applications. Two shortcuts will be listed <em>Safari</em> and <em>About Bonjour</em>. Remove About Bonjour, move onto creating FB1 and save the package.</li>
</ol>

<h3 id="conclusion">Conclusion</h3>

<p>Safari 5 will virtualise quite easily and you could combine it with <a href="http://stealthpuppy.com/virtualisation/sequencing-apple-quicktime-7x.">QuickTime</a>, as well as other plug-ins, into a single package. During testing, I should note that it loaded the installed version of Flash without having to bundle it into the same package.</p>

  </div><a class="u-url" href="/virtualising-apple-safari-5/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">aaron parker</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">{&quot;name&quot;=&gt;&quot;Aaron Parker&quot;, &quot;location&quot;=&gt;&quot;Melbourne, Australia&quot;, &quot;email&quot;=&gt;&quot;aaron@stealthpuppy.com&quot;, &quot;github&quot;=&gt;&quot;aaronparker&quot;, &quot;linkedin&quot;=&gt;&quot;aaronedwardparker&quot;, &quot;twitter&quot;=&gt;&quot;stealthpuppy&quot;}</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
