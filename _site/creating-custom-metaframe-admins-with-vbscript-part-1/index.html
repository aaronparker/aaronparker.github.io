<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Creating Custom MetaFrame Admins with VBscript: Part 1 | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Creating Custom MetaFrame Admins with VBscript: Part 1" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Overview Setting privileges on a custom administrator account in Presentation Server is not quite as simple as I thought when I set out to create a script to do so – there’s not much information on the CDN forums, so this was a bit of trial and error." />
<meta property="og:description" content="Overview Setting privileges on a custom administrator account in Presentation Server is not quite as simple as I thought when I set out to create a script to do so – there’s not much information on the CDN forums, so this was a bit of trial and error." />
<link rel="canonical" href="/creating-custom-metaframe-admins-with-vbscript-part-1/" />
<meta property="og:url" content="/creating-custom-metaframe-admins-with-vbscript-part-1/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-08-21T08:18:19+10:00" />
<script type="application/ld+json">
{"description":"Overview Setting privileges on a custom administrator account in Presentation Server is not quite as simple as I thought when I set out to create a script to do so – there’s not much information on the CDN forums, so this was a bit of trial and error.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/creating-custom-metaframe-admins-with-vbscript-part-1/","headline":"Creating Custom MetaFrame Admins with VBscript: Part 1","dateModified":"2007-08-21T08:18:19+10:00","datePublished":"2007-08-21T08:18:19+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/creating-custom-metaframe-admins-with-vbscript-part-1/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Creating Custom MetaFrame Admins with VBscript: Part 1</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-08-21T08:18:19+10:00" itemprop="datePublished">Aug 21, 2007
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><strong>Overview</strong><br />
Setting privileges on a custom administrator account in Presentation Server is not quite as simple as I thought when I set out to create a script to do so – there’s not much information on the CDN forums, so this was a bit of trial and error.</p>

<p>The process for creating a custom administrator account and setting privileges goes like this:</p>

<ol>
  <li>Create the custom administrator account.</li>
  <li>Bind to the new account and add privileges except for those that apply to application or server folders.</li>
  <li>Bind to the Applications folder/s and add privileges for the specified administrator.</li>
  <li>Bind to the Servers folder/s and add privileges for the specified administrator.</li>
</ol>

<p>As you can see the process isn’t completed in a single step, there are actually three seperate steps to setting privileges. The first is setting privileges on the objects outlined here in this screenshot (those objects in colour):</p>

<p style="text-align: center">
  <img src="http://stealthpuppy.com/wp-content/uploads/2007/08/ctx-privsset1.png" alt="ctx-privsset1.png" />
</p>

<p>The next steps set the permissions on the folder objects rather than the administrator object as outlined in this screenshot (those objects in colour):</p>

<p style="text-align: center">
  <img src="http://stealthpuppy.com/wp-content/uploads/2007/08/ctx-privsset2.png" alt="ctx-privsset2.png" />
</p>

<p>Something I should note here though, is that I’ve not been able to set permissions on the Monitoring Profiles folder. I could be wrong but from what I can tell you can’t currently access these types of folders.</p>

<p><strong>Reading The Privileges</strong><br />
First up I had to read the privileges from an existing object to make it simpler to set the privileges on any new administrators – you’ve gotta learn to read before you can write. Initially setting the privileges is easy via the Access Management Console then programatically reading back then simplifies the write process.</p>

<p>Reading the privileges on an administrator account is simple enough because we can bind to the administrator object and then read the privileges. Reading the privileges for that account on the Applications and Servers folders is a little different – unless you want to statically supply the list of folders, you’ll need to enumerate them.</p>

<p>I’ve created a fuction and a few subroutines, based on some code from the CDN forums, that will return an array containing the distinguished names of the Application or Server folders. The code essentially walks the folder tree to find the subfolders of each folder, while calling itself to do so until the subfolder count reaches 0.</p>

<p>The full script will echo out the privleges in both the numerical value and the privilege name defined by MetaFrameAdminPrivilege. Check out the MFCOM SDK 4.5 for a complete list of the privileges. This script will work on Presentation Server 4.0 and 4.5, I’ve not tested on any earlier versions.</p>

<p>Continue to <a href="http://stealthpuppy.com/scripting/creating-custom-metaframe-admins-with-vbscript-part-2">part 2 here</a></p>

  </div><a class="u-url" href="/creating-custom-metaframe-admins-with-vbscript-part-1/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
