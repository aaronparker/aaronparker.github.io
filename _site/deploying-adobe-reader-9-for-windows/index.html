<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Deploying Adobe Reader 9 for Windows | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Deploying Adobe Reader 9 for Windows" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="First Impressions" />
<meta property="og:description" content="First Impressions" />
<link rel="canonical" href="/deploying-adobe-reader-9-for-windows/" />
<meta property="og:url" content="/deploying-adobe-reader-9-for-windows/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-07-07T17:40:00+10:00" />
<script type="application/ld+json">
{"description":"First Impressions","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/deploying-adobe-reader-9-for-windows/","headline":"Deploying Adobe Reader 9 for Windows","dateModified":"2008-07-07T17:40:00+10:00","datePublished":"2008-07-07T17:40:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/deploying-adobe-reader-9-for-windows/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Deploying Adobe Reader 9 for Windows</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2008-07-07T17:40:00+10:00" itemprop="datePublished">Jul 7, 2008
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="first-impressions">First Impressions</h2>

<p>As usual consumers will have the Google toolbar pushed on them if they don’t de-select that option when downloading Reader, and now you’ll also get Adobe <a href="http://www.adobe.com/products/air/">AIR</a> along with Reader too. Awesome, more stuff we don’t really need. A default install leaves two icons on the desktop now – Adobe Reader 9 plus one for <a href="https://www.acrobat.com/">Acrobat.com</a>.</p>

<p>The good news though, is Reader 9.x is fast. I hadn’t ever found Reader 8 to be slow, but version 9 certainty runs noticeably faster than previous versions.</p>

<h2 id="downloading-adobe-reader">Downloading Adobe Reader</h2>

<p>Adobe Reader 9.1 is available for download for many languages, including:</p>

<ul>
  <li><a href="http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.1/enu/AdbeRdr910_en_US.exe">Adobe Reader 9.1 English US/UK</a></li>
  <li><a href="http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.1/fra/AdbeRdr910_fr_FR.exe">Adobe Reader 9.1 Français</a></li>
  <li><a href="http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.1/deu/AdbeRdr910_de_DE.exe">Adobe Reader 9.1 Deutsch</a></li>
  <li><a href="http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.1/nld/AdbeRdr910_nl_NL.exe">Adobe Reader 9.1 Nederlands</a></li>
  <li><a href="http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.1/ita/AdbeRdr910_it_IT.exe">Adobe Reader 9.1 Italiano</a></li>
  <li><a href="http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.1/esp/AdbeRdr910_es_ES.exe">Adobe Reader 9.1 Español</a></li>
  <li><a href="http://ardownload.adobe.com/pub/adobe/reader/win/9.x/9.1/jpn/AdbeRdr910_ja_JP.exe">Adobe Reader 9.1 日本語</a></li>
</ul>

<p>Adobe AIR is only bundled with the English and German versions of Reader 9 so far.</p>

<h2 id="what-to-do-about-adobe-updater">What To Do About Adobe Updater</h2>

<p>Reader 9 continues to include the Adobe Updater application which has been updated to version 6. While I haven’t seen it misbehave for some time and it no longer drops an Updater folder in your Documents folder, you might still want to disable it.</p>

<p>There are a few ways to do this. You can disable Updater by running it (click Help / Check for Updates) then click the Preferences link. You will then see the Preferences dialog like this, where you can choose to disable Updater:</p>

<p><img src="/media/2008/07/updaterprefs.png" alt="UpdaterPrefs" /></p>

<p>To problem with this approach is that you need Internet access just to get to the preferences dialog. A bit of a problem if you’ve got Internet access issues. To disable Updater from running automatically you can run the following command line as an administrator (or an elevated command prompt in Windows Vista):</p>

<pre><code class="language-cmd">REG ADD "HKLM\SOFTWARE\Policies\Adobe\Acrobat Reader\9.0\FeatureLockdown" /v bUpdater /d 0 /t REG_DWORD /f
</code></pre>

<p>Alternatively, to completely remove Adobe Updater, after installation, delete this folder:</p>

<ul>
  <li><code class="highlighter-rouge">C:\Program Files\Common Files\AdobeUpdater\6</code> (32-bit Windows)</li>
  <li><code class="highlighter-rouge">C:\Program Files (x86)\Common Files\AdobeUpdater\6</code> (64-bit Windows)</li>
</ul>

<p>If Adobe Reader is running as a standard (or limited) user account, Adobe Updater won’t run at all, so it shouldn’t be an issue if you don’t give users administrative access to their workstations.</p>

<p>If you are virtualising Adobe Reader, then disabling or removing Updater is a must.</p>

<h2 id="extracting-reader-setup-files">Extracting Reader Setup Files</h2>

<p>Before deploying Reader 9, you will want to extract the files from the file you’ve downloaded, so that you can create a custom tranform file. To extract the file, run the following command line:</p>

<p><code class="highlighter-rouge">AdbeRdr910\_en\_US\_Std.exe -nos\_ne</code></p>

<p>You will then find the extracted file in these locations:</p>

<ul>
  <li><code class="highlighter-rouge">%LOCALAPPDATA%AdobeReader 9.1Setup Files</code> (on Windows Vista/2008)</li>
  <li><code class="highlighter-rouge">%USERPROFILE%Local SettingsApplication DataAdobeReader 9.1Setup Files</code> (on Windows XP/2003)</li>
</ul>

<p>Once extracted, you will have the setup files for both Reader and AIR. The setup files for Reader are in a sub-folder called ‘Reader9’.</p>

<h2 id="creating-a-custom-transform-file">Creating a Custom Transform File</h2>

<p>When deploying Reader there are some customisations that I recommend making to the installation, including:</p>

<ul>
  <li>Prevent the installation of Adobe Updater 6 (If you want control over the version of Reader)</li>
  <li>Prevent the Adobe Acrobat SpeedLauncher from being added to the Run key in the registry</li>
  <li>Prevent the ‘Adobe Reader 9’ shortcut from being added to the desktop (Keep the desktop and tidy)</li>
  <li>Prevent the installation of the <a href="http://blogs.adobe.com/barnaby.james/2006/12/the_adobe_synch_1.html">Adobe Syncronizer</a> [See <a href="/deployment/deploying-adobe-reader-9-for-windows#comment-13491">this comment</a> before removing Syncronizer]</li>
  <li>Accept the EULA</li>
</ul>

<p>Adobe usually provide a customisation tool for automating the installation of Reader, however the <a href="http://www.adobe.com/support/downloads/detail.jsp?ftpID=3564=ZQRI">Customisation Wizard for Reader and Acrobat 8</a> wasn’t released until 6 months after the products themselves were released. To customise the installation I’ve used the excellent <a href="http://www.instedit.com/">InstEd</a> instead.</p>

<p>Here’s what I’ve configured as a minimum in my transform:</p>

<p><strong>Prevent Adobe Updater Installation</strong></p>

<ul>
  <li>In the <em>Component</em> table, drop any row containing ‘AdobeUpdater’ or ‘Adobe_Updater’</li>
  <li>In the <em>Feature</em> table, drop any row containing ‘AUM’ or ‘Updater’</li>
  <li>In the <em>FeatureComponents</em> table, drop any row containing ‘AUM’ or ‘Updater’</li>
  <li>In the <em>File</em> table, drop any row containing ‘AdobeUpdater’ or ‘Adobe_Updater’</li>
  <li>In the <em>ModuleComponents</em> table, drop any row containing ‘AdobeUpdater’ or ‘Adobe_Updater’</li>
  <li>In the <em>MsiFileHash</em> table, drop any row containing ‘AdobeUpdater’</li>
  <li>In the <em>Registry</em> table, drop any row containing ‘Adobe_Updater’</li>
</ul>

<p><strong>Prevent Adobe Acrobat SpeedLauncher At Startup</strong></p>

<ul>
  <li>In the <em>Registry</em> table, drop the row containing ‘Registry838’</li>
</ul>

<p><strong>Prevent the Adobe Reader 9 Desktop Shortcut</strong></p>

<ul>
  <li>In the <em>Shortcut</em> table, drop the row containing ‘SC_READER_DT’</li>
</ul>

<p><strong>Prevent Adobe Syncronizer Installation</strong></p>

<ul>
  <li>In the <em>Property</em> table, set the value for SYNCHRONIZER to YES</li>
</ul>

<p><strong>Accept the EULA</strong></p>

<ul>
  <li>In the <em>Property</em> table, set the value for EULA_ACCEPT to YES</li>
</ul>

<p>Also in the Property table, you could set the value of DISABLE_BROWSER_INTEGRATION to YES, to prevent Reader from opening within the browser. This would be beneficial in Terminal Server environments. When a PDF file is opened within the browser and the user then browses to a different page, the Reader components are stay in memory until the browser is closed.</p>

<p>You can download a transform with all of the modifications listed above here (except disabling Syncronizer; use at your own risk):</p>

<p class="download">
  <a href=".com/media/2008/07/AdobeReader91Custom.mst">Adobe Reader 9.1 Custom Transform</a>
</p>

<h2 id="creating-a-custom-transform-with-adobe-customisation-wizard-9">Creating a Custom Transform with Adobe Customisation Wizard 9</h2>

<p>Adobe have recently released the <a href="http://www.adobe.com/support/downloads/detail.jsp?ftpID=3993">Adobe Customisation Wizard 9</a> which is the best place to start when creating a custom transform for Acrobat or Reader 9. Here are the settings I would recommend you configure when creating a transform:</p>

<p>Under <em>Installation Options</em> set:</p>

<ul>
  <li>
    <div>
  <em>Run Installation</em> to <em>Unattended</em>
</div>
  </li>
  <li>
    <div>
  <em>If reboot required at the end of installation</em> to <em>Suppress reboot</em>
</div>
  </li>
</ul>

<p>Under Files and Folders:</p>

<ul>
  <li>
    <div>
  Add <em>HideMenuItems.js</em>, listed below, to <em>ProgramFilesFolder / Adobe / Reader 9.0 / Reader / JavaScripts</em>
</div>
  </li>
</ul>

<p>Under <em>Shortcuts</em>:</p>

<ul>
  <li>
    <div>
  Remove the <em>Adobe Reader 9</em> shortcut added to the <em>Desktop</em>
</div>
  </li>
</ul>

<p>Under <em>EULA and Document Status</em> set</p>

<ul>
  <li>
    <div>
  <em>Suppress display of End User License Agreement</em> to enabled
</div>
  </li>
</ul>

<p>Under <em>Online and Acrobat.com Features</em> set</p>

<ul>
  <li>
    <div>
  <em>Disable all updates</em> to enabled to disable Adobe Updater
</div>
  </li>
  <li>
    <div>
  <em>When launching PDF in Internet Explorer, prompt user with Open/Save dialog</em> to enabled for Terminal Server environments
</div>
  </li>
  <li>
    <div>
  <em>In Adobe Reader, disable Help &gt; Purchase Adobe Acrobat</em> to enabled
</div>
  </li>
  <li>
    <div>
  <em>Disable Help &gt; Digital Editions</em> to enabled
</div>
  </li>
  <li>
    <div>
  <em>Disable Product Improvement Program</em> to enabled
</div>
  </li>
  <li>
    <div>
  <em>Disable Viewing of PDF with Ads for Adobe PDF</em> to enabled
</div>
  </li>
  <li>
    <div>
  <em>Display PDF in browser</em> to <em>Disable &amp; Lock</em> for Terminal Server environments
</div>
  </li>
  <li>
    <div>
  <em>Disable all Acrobat.Com access, including initiation and participation</em> to enabled
</div>
  </li>
</ul>

<p>After you created the transform for Reader 9 with the wizard, you may want to open it in your favourite MSI editor to perform further customisations such as disabling SpeedLauncher.</p>

<h2 id="disabling-menus-and-buttons">Disabling Menus and Buttons</h2>

<p>In a corporate environment, you may want to disable some of the menu items and buttons. Just as in Adobe Reader 8, most of these items are disabled with a JavaScript file. Yes a JavaScript file. Whilst using the registry would make sense to control UI items, Adobe uses JavaScript files. I’d love to know the reason why. It’s not a solution that scales particularly well.</p>

<p>To disable UI elements, you will first need to list all of the elements by name. To do this, save the following script as <code class="highlighter-rouge">ListItems.js</code> in <code class="highlighter-rouge">%ProgramFiles%AdobeReader 9.0ReaderJavaScript</code>:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ListItems.js  </span>
<span class="c1">//Open Javascript Console  </span>
<span class="nx">console</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

<span class="c1">//List Toolbar Buttons in the Console  </span>
<span class="kd">var</span> <span class="nx">toolbarItems</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listToolbarButtons</span><span class="p">()</span>  
<span class="k">for</span><span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">toolbarItems</span><span class="p">)</span>  
<span class="nx">console</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="nx">toolbarItems</span> <span class="o">+</span> <span class="s2">"n"</span><span class="p">)</span>

<span class="c1">//List Menu Items in the Console  </span>
<span class="kd">var</span> <span class="nx">menuItems</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">listMenuItems</span><span class="p">()</span>  
<span class="k">for</span><span class="p">(</span> <span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">menuItems</span><span class="p">)</span>  
<span class="nx">console</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="nx">menuItems</span> <span class="o">+</span> <span class="s2">"n"</span><span class="p">)</span>
</code></pre></div></div>

<p>This will open a dialog box when Reader is started, listing the names of each menu item and toolbar button. You can then create a JavaScript file to remove these items from the UI. Reader 9 includes a number of menu items you might want to remove:</p>

<p><img src="/media/2008/07/menushighlighted.png" alt="" /></p>

<p>Here’s the code you’ll need to hide those items. Copy and paste into <code class="highlighter-rouge">HideItems.js</code>, then copy into <code class="highlighter-rouge">%ProgramFiles%AdobeReader 9.0ReaderJavaScripts</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//HideMenu.js</span>

<span class="c1">// [File - Create Adobe PDF Using Acrobat.com], plus toolbar button  </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"WebServices:CreatePDF"</span><span class="p">);</span>  
<span class="nx">app</span><span class="p">.</span><span class="nx">hideToolbarButton</span><span class="p">(</span><span class="s2">"Weblink:CreatePDF"</span><span class="p">);</span>

<span class="c1">// [File - Collaborate], plus toolbar button  </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"Annots:FileCollaboration"</span><span class="p">);</span>  
<span class="nx">app</span><span class="p">.</span><span class="nx">hideToolbarButton</span><span class="p">(</span><span class="s2">"Annots:CollabToolButton"</span><span class="p">);</span>

<span class="c1">// [File - Digital Editions]  </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"eBook:Digital Edition Services"</span><span class="p">);</span>

<span class="c1">// [Help - Improvement Program Options]  </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"UsageMeasurement"</span><span class="p">);</span>

<span class="c1">// [Help - Online Support], plus sub menu items  </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"OnlineSupport"</span><span class="p">);</span>  
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"KnowledgeBase"</span><span class="p">);</span>  
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"AdobeExpertSupport"</span><span class="p">);</span>  
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"AccessOnline"</span><span class="p">);</span>  
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"SystemInformation"</span><span class="p">);</span>

<span class="c1">// [Help - Repair Adobe Reader Installation]  </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"DetectAndRepair"</span><span class="p">);</span>

<span class="c1">// [Help - Check for Updates]  </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"Updates"</span><span class="p">);</span>

<span class="c1">// [Help - Purchase Adobe Acrobat]  </span>
<span class="nx">app</span><span class="p">.</span><span class="nx">hideMenuItem</span><span class="p">(</span><span class="s2">"Weblink:BuyAcrobat"</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="deploying-reader">Deploying Reader</h2>

<p>Deploying Reader should be straight-forward, however you are required to <a href="http://www.adobe.com/products/acrobat/acrrdistribute.html">complete a distribution agreement</a> to deploy Reader in your environment.</p>

<p>Using <a href="http://support.microsoft.com/kb/816102">Group Policy Software Installation</a>, or your favourite software deployment tool, create a transform file with your required settings and deploy. If you need to use a script, this command will install Reader:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>START /WAIT MSIEXEC /I AcroRead.msi ALLUSERS=TRUE TRANSFORMS=AdobeReader9.mst /QB
</code></pre></div></div>

<h2 id="updating-reader">Updating Reader</h2>

<p>Updating Adobe Reader can be a bit of a challenge, especially for smaller environments using only Group Policy Software Installation. For Reader 8, Adobe released updates as a complete download of the installer rather than patches. I recommend updating using the full installer as updates for version 9 are released.</p>

<p>If you would really prefer to use the Updater to keep Reader current, you could use the following command in a task using Windows Task Scheduler:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"%CommonProgramFiles%\AdobeUpdater\6\Adobe\_Updater.exe" -AU\_LAUNCH\_MODE=1 -AU\_DISPLAY\_LANG=en\_US -AU\_LAUNCH\_APPID=reader9rdr-en_US
</code></pre></div></div>

<p>I can’t vouch for the effectiveness of this approach or even if it will work, so you’re on your own there. Of course you’ll also need to keep Updater in the Reader install package.</p>

<h2 id="managing-reader">Managing Reader</h2>

<p>Managing Reader via Group Policy is pretty simple – Reader 8 and 9 are even policy aware. That is they use the SoftwarePolicies key in the registry. Unfortunately Adobe don’t supply an ADM/ADMX template file for use with Group Policy. C’mon Adobe it wouldn’t take you much effort and we would be very grateful.</p>

<p>So it’s Group Policy Preferences or your favourite user workspace management tool for managing Reader. <a href="http://www.capslockassassin.com/2008/07/06/adobe-acrobat-reader-9-silent-install/">Paul</a> has taken the time to create a simple <a href="http://www.capslockassassin.com/media/2008/07/acrobatreader9.zip">ADM file</a> for managing some of Readers features that might suit you.</p>

<p>I’ve also created my own custom Administrative template, which you can download in ADM and ADMX format. There is still some work to go on this template, so use at your own risk:</p>

<p class="download">
  <a href=".com/media/2008/07/AdobeAcrobatAndReader9.zip">Adobe Acrobat and Reader 9 Administrative Template v0.1</a>
</p>

<h2 id="what-now">What Now?</h2>

<p>I would recommend updating to Reader 9 if you can. There’s doesn’t look to be any fantastic new features to get excited over, but the performance improvements should make it worthwhile.</p>

<ul>
  <li>[11/03/2009] Updated for Adobe Reader 9.1</li>
  <li>[29/07/2008] Adobe have posted a <a href="http://www.adobe.com/devnet/acrobat/pdfs/deploying_reader9.pdf">Deploying Adobe Reader 9</a> document that has some excellent details.</li>
  <li>[07/08/2008] Updated for the release of Adobe Customisation Wizard 9.</li>
  <li>[08/08/2008] Added version 0.1 of custom ADM/ADMX for managing policy settings.</li>
</ul>


  </div><a class="u-url" href="/deploying-adobe-reader-9-for-windows/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
