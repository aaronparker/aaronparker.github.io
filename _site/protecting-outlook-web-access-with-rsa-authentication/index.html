<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Protecting Outlook Web Access with RSA authentication | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Protecting Outlook Web Access with RSA authentication" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Outlook Web Access can be protected with an extra layer of authentication via RSA SecurID. This can be implemented in one of two ways:" />
<meta property="og:description" content="Outlook Web Access can be protected with an extra layer of authentication via RSA SecurID. This can be implemented in one of two ways:" />
<link rel="canonical" href="/protecting-outlook-web-access-with-rsa-authentication/" />
<meta property="og:url" content="/protecting-outlook-web-access-with-rsa-authentication/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2006-08-25T05:51:00+10:00" />
<script type="application/ld+json">
{"description":"Outlook Web Access can be protected with an extra layer of authentication via RSA SecurID. This can be implemented in one of two ways:","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/protecting-outlook-web-access-with-rsa-authentication/","headline":"Protecting Outlook Web Access with RSA authentication","dateModified":"2006-08-25T05:51:00+10:00","datePublished":"2006-08-25T05:51:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/protecting-outlook-web-access-with-rsa-authentication/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Protecting Outlook Web Access with RSA authentication</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2006-08-25T05:51:00+10:00" itemprop="datePublished">Aug 25, 2006
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img align="left" src=".com/media/2006/08/exchange1.png" />Outlook Web Access can be protected with an extra layer of authentication via RSA SecurID. This can be implemented in one of two ways:</p>

<p><strong>1. ISA Server 2004</strong><br />
ISA Server 2004 implements the SecurID Web Filter that allows ISA Server to authenticate connections before providing access to published web servers. See the ISA Server help for information, but the requirements are:</p>

<ol>
  <li>The RSA ACE Client does not need to be installed on the server. ISA Server comes with it’s own RSA ACE client DLLs and thus does not require the client installation. All that is required is to create the agent host and copy SDCONF.REC to %SYSTEMROOT%SYSTEM32</li>
  <li>The Network Service account must have read/write access to the following registry key: HKLMSoftwareSDTIACECLIENT.</li>
</ol>

<p>There are two issues with this implementation:</p>
<ul>
  <li>The user will be prompted with an RSA authentication prompt; and</li>
  <li>The RSA authentication web page is not customisable.</li>
</ul>

<p><strong>2. RSA Web Agent for IIS</strong><br />
The RSA Web Agent for IIS, installed on the Exchange Server, offers authentication directly from IIS and also offers a ‘single sign-on’ solution.</p>

<p><em>RSA Authentication Agent 5.3 for Web for Internet Information Services</em><br />
<a target="_blank" href="http://www.rsasecurity.com/node.asp?id=2807"><u>http://www.rsasecurity.com/node.asp?id=2807</u></a></p>

<p>The download contains the Agent software and a PDF file (WebAgent_IIS.PDF) for implementing RSA authentication on protected web pages. Page 51 of the PDF contains configuration information for implementing the single sign-on solution for Outlook Web Access. The information listed in the document is fairly straight-forward, however where it mentions Exchange System Manager to configure the HTTP Virtual Server, it should say IIS Manager.</p>

<p>There are a few things to be aware of when implementing this solution:</p>

<p><strong>Requirements</strong></p>
<ul>
  <li>The Exchange server/s must be running Exchange Server 2003 Service Pack 1 and Windows Server 2003 Service Pack 1;</li>
  <li>The domain must be at Windows Server 2003 Functional Level;</li>
  <li>Although the RSA documentation discusses implementing this solution in a front-end/back-end scenario, this solution will work in an environment without front-end servers.</li>
</ul>

<p><strong>Installation</strong></p>
<ul>
  <li>After installing the RSA Web Agent software, IIS may need to be restarted (IISRESET) before RSA Authentication will work. The web browser may report ‘500. Internal Server error’;</li>
  <li>Create a second virtual server in IIS on the Exchange Server before implementing RSA auth. In this way, RSA can be implemented without affecting the existing Default Web Site and OWA will continue to work. This also allows for internal access to OWA via Integrated authentication and and external site with RSA auth for publishing;</li>
  <li>To create the virtual server, right click the Default Web Site and select All Tasks/Save Configuration to a file. Use this configration file to create a new site: right click Web Sites and select New/Web Site (from file). Provide access to this site via a second IP address or use host headers;</li>
  <li>Test that standard RSA authentication works before implementing the single sign-on configuration;</li>
  <li>After configuration anonymous access to OWA as per the RSA documentation, check the directory access to the following file, otherwise users will be prompted with an authentication prompt when they logoff from OWA: /exchweb/bin/USA/logoff.asp;</li>
</ul>

<font color="#ff0000">UPDATE</font>
<p>: I forgot to add a third method of adding RSA authentication to OWA: <a href="http://www.rsasecurity.com/node.asp?id=1186">RSA ClearTrust</a>. ClearTrust is better integrated into the authentication than the Web Agent, however this requires additional cost above the standard RSA SecurID Authentication.</p>

<font color="#ff0000">UPDATE #2</font>
<p>: There’s a much better way to protect OWA with RSA authentication now that ISA Server 2006 has been released. Check out <a href="http://www.stealthpuppy.com/blogs/travelling/archive/2006/09/29/Strengthening-OWA-Authentication-with-ISA-2006-and-RSA-SecurID-.aspx">my post here</a>.</p>

  </div><a class="u-url" href="/protecting-outlook-web-access-with-rsa-authentication/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
