<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>How to Move a Storage Group in a Cluster Continuous Replication Environment | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="How to Move a Storage Group in a Cluster Continuous Replication Environment" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="TechNet has an article on moving the database and log file paths for a Storage Group in an Exchange cluster running in a Cluster Continuous Replication environment, however it’s missing a couple of steps which are fairly important to the process." />
<meta property="og:description" content="TechNet has an article on moving the database and log file paths for a Storage Group in an Exchange cluster running in a Cluster Continuous Replication environment, however it’s missing a couple of steps which are fairly important to the process." />
<link rel="canonical" href="/how-to-move-a-storage-group-in-a-cluster-continuous-replication-environment/" />
<meta property="og:url" content="/how-to-move-a-storage-group-in-a-cluster-continuous-replication-environment/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-05-30T15:44:01+10:00" />
<script type="application/ld+json">
{"description":"TechNet has an article on moving the database and log file paths for a Storage Group in an Exchange cluster running in a Cluster Continuous Replication environment, however it’s missing a couple of steps which are fairly important to the process.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/how-to-move-a-storage-group-in-a-cluster-continuous-replication-environment/","headline":"How to Move a Storage Group in a Cluster Continuous Replication Environment","dateModified":"2007-05-30T15:44:01+10:00","datePublished":"2007-05-30T15:44:01+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/how-to-move-a-storage-group-in-a-cluster-continuous-replication-environment/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How to Move a Storage Group in a Cluster Continuous Replication Environment</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-05-30T15:44:01+10:00" itemprop="datePublished">May 30, 2007
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img src=".com/media/2007/05/exchange2.png" align="left" />TechNet has an article on <a href="http://technet.microsoft.com/en-us/library/aa996391.aspx">moving the database and log file paths for a Storage Group</a> in an Exchange cluster running in a Cluster Continuous Replication environment, however it’s missing a couple of steps which are fairly important to the process.</p>

<p>If you attempt to move the database or log file locations on a clustered Exchange Server 2007 server you will receive the following error:</p>

<blockquote>
  <p>Error:<br />
This operation cannot be performed on a remote server or a clustered mailbox server in a cluster continuous replication enviornment. Please use the -ConfigurationOnly option and then manually move the files.<br />
Parameter name: ConfigurationOnly</p>

  <p>Exchange Management Shell command attempted:<br />
move-StorageGroupPath -Identity ‘exchsrvrSecond Storage Group’ -LogFolderPath ‘G:Program FilesMicrosoftExchange ServerMailboxFirst Storage Group’</p>
</blockquote>

<p>To move the file locations then you will have to change the configuration and move the files manually on both nodes, even though the page on TechNet indicates the command will move the files automattically. Here’s how I went through this process on a live system to move the log files.</p>

<p>In this example the server name is <strong>exchsrvr</strong> and the storage group name is <strong>First Storage Group</strong>. I’m moving the log files from <strong>F:Program FilesMicrosoftExchange ServerMailboxFirst Storage Group</strong> to <strong>G:Program FilesMicrosoftExchange ServerMailboxFirst Storage Group</strong>. All of these commands are run in the Exchange Management Shell.</p>

<p>On the Active node <strong>or</strong> the Passive node, suspend the copy of the storage group:<br />
[code]Suspend-StorageGroupCopy -Identity:’exchsrvrFirst Storage Group’[/code]<br />
On the <strong>Active</strong> node, dismount the database (or databases) in the storage group:<br />
[code]Dismount-Database -“Identity:’exchsrvrFirst Storage GroupMailbox Database’[/code]<br />
On the <strong>Active</strong> node modify the configuration of the storage group to use the new path for the log files:<br />
[code]Move-StorageGroupPath -“Identity:’exchsrvrFirst Storage Group’ -LogFolderPath:’G:Program FilesMicrosoftExchange ServerMailboxFirst Storage Group’ -ConfigurationOnly[/code]<br />
On the Active <strong>and</strong> Passive nodes, create the new folders to store the log files:<br />
[code]MD “G:Program FilesMicrosoftExchange ServerMailboxFirst Storage Group”[/code]<br />
On the Active <strong>and</strong> Passive nodes, move the log files to the new location. (The prefix for the log files for this storage group is E0):<br />
[code]Move “F:Program FilesMicrosoftExchange ServerMailboxFirst Storage GroupE0*.*” “G:Program FilesMicrosoftExchange ServerMailboxFirst Storage Group”[/code]<br />
On the <strong>Active</strong> node, mount the database:<br />
[code]Mount-database -“identity:’exchsrvrFirst Storage GroupMailbox Database’[/code]<br />
On the Active <strong>or</strong> Passive nodes, resume the storage group copy process:<br />
[code]Resume-StorageGroupCopy -Identity:’exchsrvrFirst Storage Group’[/code]<br />
The process was surprisingly simple in the end, but it’s easy to say that now that I’ve done it at least once.</p>

  </div><a class="u-url" href="/how-to-move-a-storage-group-in-a-cluster-continuous-replication-environment/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
