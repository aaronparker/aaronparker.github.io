<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Juggling Java VMs | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Juggling Java VMs" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I’ve just spent yesterday and today working on a site where the client had a need to run both the Microsoft Java VM and the Sun Java VM on their Terminal Servers. (The Microsoft Java VM is used for one site only, yes developers strike again). I was pretty happy when I was able to use Presentation Server 4.0 and Application Isolation Environments to get these to work on the same server, in Internet Explorer, at the same time. Here’s how:" />
<meta property="og:description" content="I’ve just spent yesterday and today working on a site where the client had a need to run both the Microsoft Java VM and the Sun Java VM on their Terminal Servers. (The Microsoft Java VM is used for one site only, yes developers strike again). I was pretty happy when I was able to use Presentation Server 4.0 and Application Isolation Environments to get these to work on the same server, in Internet Explorer, at the same time. Here’s how:" />
<link rel="canonical" href="/juggling-java-vms/" />
<meta property="og:url" content="/juggling-java-vms/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2006-08-25T05:48:00+10:00" />
<script type="application/ld+json">
{"description":"I’ve just spent yesterday and today working on a site where the client had a need to run both the Microsoft Java VM and the Sun Java VM on their Terminal Servers. (The Microsoft Java VM is used for one site only, yes developers strike again). I was pretty happy when I was able to use Presentation Server 4.0 and Application Isolation Environments to get these to work on the same server, in Internet Explorer, at the same time. Here’s how:","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/juggling-java-vms/","headline":"Juggling Java VMs","dateModified":"2006-08-25T05:48:00+10:00","datePublished":"2006-08-25T05:48:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/juggling-java-vms/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Juggling Java VMs</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2006-08-25T05:48:00+10:00" itemprop="datePublished">Aug 25, 2006
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I’ve just spent yesterday and today working on a site where the client had a need to run both the Microsoft Java VM and the Sun Java VM on their Terminal Servers. (The Microsoft Java VM is used for one site only, yes developers strike again). I was pretty happy when I was able to use Presentation Server 4.0 and Application Isolation Environments to get these to work on the same server, in Internet Explorer, at the same time. Here’s how:</p>

<p><strong>1</strong>. Install the Microsoft Java VM to the Terminal Server and then install the latest <a href="http://www.java.com/en/download/manual.jsp">Sun Java Runtime Environment</a> and ensure that Internet Explorer is configured to this as the default (This is a machine level setting).</p>

<p><strong>2</strong>. Create an Isolation Environment to hold an instance of Internet Explorer. Check out this document on the Citrix Knowledgebase, which describes how to <em>associate</em> Internet Explorer with an Isolation Environment. This applys to Windows Server 2003 as well.</p>

<p><a href="http://support.citrix.com/kb/click.jspa?categoryID=618&amp;externalID=CTX106085&amp;searchID=-1">How to install Internet Explorer (IE) 6 into an isolation environment on Windows 2000</a></p>

<p><strong>3</strong>. Add the following registry entry to the Isolation Environment (change the version number to the version of the Sun Java VM you have installed and used by Internet Explorer)</p>

<p>[code]Windows Registry Editor Version 5.00<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Plug-in\1.5.0_04]<br />
“UseJava2IExplorer”=dword:00000000[/code]</p>

<p>Install the registry entry by placing this into a .REG file and import via</p>

<p>[code]AIESETUP /W /N “Microsoft Java VM” REGEDIT /S SunJava-Off.REG[/code]</p>

<p>Where “Microsoft Java VM” is the name of the Isolation Environment and SunJava-Off.REG is the name of the registry file.</p>

<p><strong>4</strong>. Create a new published application instance of Internet Explorer. In my case, because it was for one site only, I specified the URL after IEXPLORE.EXE and labled the published application to reflect the web site.</p>

<p><strong>5</strong>. Associate this published application with the Isolation Environment.</p>

<p><strong>6</strong>. Test and voila! The Sun Java VM as the default and the Microsoft Java VM only for those sites that require it. Of course there will be some user training involved but the solution works. My next step is to take this a little further and add registry settings to remove the address bar and toolbar so that users won’t be tempted to navigate to other sites in the published instance.</p>

<p>The only issue I found with this approach is that when launching the published application there is a 2 minute (yes, 2 minute) delay before Internet Explorer launches (you will see the AIERUN window displayed in the mean time). I’ll update this post if I find the reason. I don’t think that this document gives a suitable explaination:</p>

<p><a href="http://support.citrix.com/kb/click.jspa?categoryID=618&amp;externalID=CTX106618&amp;searchID=7426930">Application launch performance is slower when applications are launched into an isolation environment</a></p>

  </div><a class="u-url" href="/juggling-java-vms/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
