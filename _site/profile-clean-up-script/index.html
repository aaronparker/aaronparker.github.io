<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Reducing Profile Size with a Profile Clean Up Script | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Reducing Profile Size with a Profile Clean Up Script" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="&lt;img class=”size-full wp-image-2604 aligncenter” title=”Delete by Cari McGee” src=”/media/2011/12/AppleKeyboardDelete.jpg” alt=”Delete by Cari McGee Windows profiles become larger over time - it’s an inescapable fact. This means that if you are using roaming profiles, logons (and logoff) will be longer and longer. It’s not just individual file sizes, but also the number of files stored in a profile that will make the synchronisation process slower. One approach to reducing profile sizes is to exclude certain folders. A better solution is to ditch roaming profiles and use a third-party solution to manage roaming of the user environment. However, there will still be folders that need to be roamed to maintain the experience that users expect when moving between devices (i.e. consistency). For those folders we can implement some maintenance to keep them at a manageable size - that is remove files that are not needed in a roaming profile (e.g. log files) or delete files older than a specific number of days. Warning: there’s a reason that Windows doesn’t do this maintenance itself - only each application vendor will have an understanding of whether specific files are required or can be discarded (hence the roaming and local portions of AppData). However, as any experienced Windows admin knows - many vendors either don’t test for or don’t care about roaming scenarios, therefore I strongly recommend testing this approach before production deployment. As a part of an upcoming version of this configuration, I’ve created a script that will execute at logoff, before the profile is saved back to the network, that will perform two actions: Delete all files of a specific file type in a specified folder, including sub-folders Delete all files older than X days in a specified folder, including sub-folders So for example, you could use the script to delete all .log files below %APPDATA% or delete all Cookies older than 90 days. The script is extremely simple on purpose and I recommend testing thoroughly before implementing - use at your own risk; however feedback is welcome. &#39; Profile clean up - remove unneeded or old files before logoff &#39; -------------------------------------------------------------- &#39; Original scripts: &#39; http://www.wisesoft.co.uk/scripts/vbscript_recursive_file_delete_by_extension.aspx &#39; http://ss64.com/vb/syntax-profile.html &#39; http://csi-windows.com/toolkit/csigetspecialfolder &#39; Version 2.0; 27/12/2011 Option Explicit On Error Resume Next &#39;Avoid file in use issues Dim strExtensionsToDelete, strAppData, strUserProfile, objFSO, strCookies, strHistory, strRecent, objShellApp Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;) Set objShellApp = CreateObject(&quot;Shell.Application&quot;) Const CSIDL_COOKIES = &quot;&amp;H21&quot; Const CSIDL_HISTORY = &quot;&amp;H22&quot; Const CSIDL_RECENT = &quot;&amp;H08&quot; Const CSIDL_NETHOOD = &quot;&amp;H13&quot; Const CSIDL_APPDATA = &quot;&amp;H1A&quot; Const CSIDL_PROFILE = &quot;&amp;H28&quot; &#39; Folder to delete files from (files will also be deleted from Subfolders) strUserProfile = objShellApp.NameSpace(cint(CSIDL_PROFILE)).Self.Path strAppData = objShellApp.NameSpace(cint(CSIDL_APPDATA)).Self.Path strCookies = objShellApp.NameSpace(cint(CSIDL_COOKIES)).Self.Path strHistory = objShellApp.NameSpace(cint(CSIDL_HISTORY)).Self.Path strRecent = objShellApp.NameSpace(cint(CSIDL_RECENT)).Self.Path strNetHood = objShellApp.NameSpace(cint(CSIDL_NETHOOD)).Self.Path &#39; Main RecursiveDeleteByExtension strAppData, &quot;tmp,log&quot; RecursiveDeleteOlder 90, strCookies RecursiveDeleteOlder 14, strRecent RecursiveDeleteOlder 21, strHistory RecursiveDeleteOlder 21, strNetHood RecursiveDeleteOlder 14, strAppData &amp; &quot;\Microsoft\Office\Recent&quot; &#39;RecursiveDeleteOlder 5, strAppData &amp; &quot;\Sun\Java\Deployment\cache&quot; &#39;RecursiveDeleteOlder 3, strAppData &amp; &quot;\Macromedia\Flash Player&quot; &#39;RecursiveDeleteOlder 14, strUserProfile &amp; &quot;\Oracle Jar Cache&quot; Sub RecursiveDeleteByExtension(ByVal strPath,strExtensionsToDelete) &#39; Walk through strPath and sub-folders and delete files of type strExtensionsToDelete Dim objFolder, objSubFolder, objFile, strExt If objFSO.FolderExists(strPath) = True Then Set objFolder = objFSO.GetFolder(strPath) For Each objFile in objFolder.Files For each strExt in Split(UCase(strExtensionsToDelete),&quot;,&quot;) If Right(UCase(objFile.Path),Len(strExt)+1) = &quot;.&quot; &amp; strExt then WScript.Echo &quot;Deleting: &quot; &amp; objFile.Path objFile.Delete(True) Exit For End If Next Next For Each objSubFolder in objFolder.SubFolders RecursiveDeleteByExtension objSubFolder.Path,strExtensionsToDelete Next End If End Sub Sub RecursiveDeleteOlder(ByVal intDays,strPath) &#39; Delete files from strPath that are more than intDays old Dim objFolder, objFile, objSubFolder If objFSO.FolderExists(strPath) = True Then Set objFolder = objFSO.GetFolder(strPath) For each objFile in objFolder.files If DateDiff(&quot;d&quot;, objFile.DateLastModified,Now) &gt; intDays Then If UCase(objFile.Name) &lt;&gt; &quot;DESKTOP.INI&quot; Then &#39; Ensure we don&#39;t delete desktop.ini WScript.Echo &quot;Deleting: &quot; &amp; objFile.Path objFile.Delete(True) End If End If Next For Each objSubFolder in objFolder.SubFolders RecursiveDeleteOlder intDays,objSubFolder.Path Next End If End Sub" />
<meta property="og:description" content="&lt;img class=”size-full wp-image-2604 aligncenter” title=”Delete by Cari McGee” src=”/media/2011/12/AppleKeyboardDelete.jpg” alt=”Delete by Cari McGee Windows profiles become larger over time - it’s an inescapable fact. This means that if you are using roaming profiles, logons (and logoff) will be longer and longer. It’s not just individual file sizes, but also the number of files stored in a profile that will make the synchronisation process slower. One approach to reducing profile sizes is to exclude certain folders. A better solution is to ditch roaming profiles and use a third-party solution to manage roaming of the user environment. However, there will still be folders that need to be roamed to maintain the experience that users expect when moving between devices (i.e. consistency). For those folders we can implement some maintenance to keep them at a manageable size - that is remove files that are not needed in a roaming profile (e.g. log files) or delete files older than a specific number of days. Warning: there’s a reason that Windows doesn’t do this maintenance itself - only each application vendor will have an understanding of whether specific files are required or can be discarded (hence the roaming and local portions of AppData). However, as any experienced Windows admin knows - many vendors either don’t test for or don’t care about roaming scenarios, therefore I strongly recommend testing this approach before production deployment. As a part of an upcoming version of this configuration, I’ve created a script that will execute at logoff, before the profile is saved back to the network, that will perform two actions: Delete all files of a specific file type in a specified folder, including sub-folders Delete all files older than X days in a specified folder, including sub-folders So for example, you could use the script to delete all .log files below %APPDATA% or delete all Cookies older than 90 days. The script is extremely simple on purpose and I recommend testing thoroughly before implementing - use at your own risk; however feedback is welcome. &#39; Profile clean up - remove unneeded or old files before logoff &#39; -------------------------------------------------------------- &#39; Original scripts: &#39; http://www.wisesoft.co.uk/scripts/vbscript_recursive_file_delete_by_extension.aspx &#39; http://ss64.com/vb/syntax-profile.html &#39; http://csi-windows.com/toolkit/csigetspecialfolder &#39; Version 2.0; 27/12/2011 Option Explicit On Error Resume Next &#39;Avoid file in use issues Dim strExtensionsToDelete, strAppData, strUserProfile, objFSO, strCookies, strHistory, strRecent, objShellApp Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;) Set objShellApp = CreateObject(&quot;Shell.Application&quot;) Const CSIDL_COOKIES = &quot;&amp;H21&quot; Const CSIDL_HISTORY = &quot;&amp;H22&quot; Const CSIDL_RECENT = &quot;&amp;H08&quot; Const CSIDL_NETHOOD = &quot;&amp;H13&quot; Const CSIDL_APPDATA = &quot;&amp;H1A&quot; Const CSIDL_PROFILE = &quot;&amp;H28&quot; &#39; Folder to delete files from (files will also be deleted from Subfolders) strUserProfile = objShellApp.NameSpace(cint(CSIDL_PROFILE)).Self.Path strAppData = objShellApp.NameSpace(cint(CSIDL_APPDATA)).Self.Path strCookies = objShellApp.NameSpace(cint(CSIDL_COOKIES)).Self.Path strHistory = objShellApp.NameSpace(cint(CSIDL_HISTORY)).Self.Path strRecent = objShellApp.NameSpace(cint(CSIDL_RECENT)).Self.Path strNetHood = objShellApp.NameSpace(cint(CSIDL_NETHOOD)).Self.Path &#39; Main RecursiveDeleteByExtension strAppData, &quot;tmp,log&quot; RecursiveDeleteOlder 90, strCookies RecursiveDeleteOlder 14, strRecent RecursiveDeleteOlder 21, strHistory RecursiveDeleteOlder 21, strNetHood RecursiveDeleteOlder 14, strAppData &amp; &quot;\Microsoft\Office\Recent&quot; &#39;RecursiveDeleteOlder 5, strAppData &amp; &quot;\Sun\Java\Deployment\cache&quot; &#39;RecursiveDeleteOlder 3, strAppData &amp; &quot;\Macromedia\Flash Player&quot; &#39;RecursiveDeleteOlder 14, strUserProfile &amp; &quot;\Oracle Jar Cache&quot; Sub RecursiveDeleteByExtension(ByVal strPath,strExtensionsToDelete) &#39; Walk through strPath and sub-folders and delete files of type strExtensionsToDelete Dim objFolder, objSubFolder, objFile, strExt If objFSO.FolderExists(strPath) = True Then Set objFolder = objFSO.GetFolder(strPath) For Each objFile in objFolder.Files For each strExt in Split(UCase(strExtensionsToDelete),&quot;,&quot;) If Right(UCase(objFile.Path),Len(strExt)+1) = &quot;.&quot; &amp; strExt then WScript.Echo &quot;Deleting: &quot; &amp; objFile.Path objFile.Delete(True) Exit For End If Next Next For Each objSubFolder in objFolder.SubFolders RecursiveDeleteByExtension objSubFolder.Path,strExtensionsToDelete Next End If End Sub Sub RecursiveDeleteOlder(ByVal intDays,strPath) &#39; Delete files from strPath that are more than intDays old Dim objFolder, objFile, objSubFolder If objFSO.FolderExists(strPath) = True Then Set objFolder = objFSO.GetFolder(strPath) For each objFile in objFolder.files If DateDiff(&quot;d&quot;, objFile.DateLastModified,Now) &gt; intDays Then If UCase(objFile.Name) &lt;&gt; &quot;DESKTOP.INI&quot; Then &#39; Ensure we don&#39;t delete desktop.ini WScript.Echo &quot;Deleting: &quot; &amp; objFile.Path objFile.Delete(True) End If End If Next For Each objSubFolder in objFolder.SubFolders RecursiveDeleteOlder intDays,objSubFolder.Path Next End If End Sub" />
<link rel="canonical" href="http://localhost:4000/profile-clean-up-script/" />
<meta property="og:url" content="http://localhost:4000/profile-clean-up-script/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-12-28T10:00:17+11:00" />
<script type="application/ld+json">
{"description":"&lt;img class=”size-full wp-image-2604 aligncenter” title=”Delete by Cari McGee” src=”/media/2011/12/AppleKeyboardDelete.jpg” alt=”Delete by Cari McGee Windows profiles become larger over time - it’s an inescapable fact. This means that if you are using roaming profiles, logons (and logoff) will be longer and longer. It’s not just individual file sizes, but also the number of files stored in a profile that will make the synchronisation process slower. One approach to reducing profile sizes is to exclude certain folders. A better solution is to ditch roaming profiles and use a third-party solution to manage roaming of the user environment. However, there will still be folders that need to be roamed to maintain the experience that users expect when moving between devices (i.e. consistency). For those folders we can implement some maintenance to keep them at a manageable size - that is remove files that are not needed in a roaming profile (e.g. log files) or delete files older than a specific number of days. Warning: there’s a reason that Windows doesn’t do this maintenance itself - only each application vendor will have an understanding of whether specific files are required or can be discarded (hence the roaming and local portions of AppData). However, as any experienced Windows admin knows - many vendors either don’t test for or don’t care about roaming scenarios, therefore I strongly recommend testing this approach before production deployment. As a part of an upcoming version of this configuration, I’ve created a script that will execute at logoff, before the profile is saved back to the network, that will perform two actions: Delete all files of a specific file type in a specified folder, including sub-folders Delete all files older than X days in a specified folder, including sub-folders So for example, you could use the script to delete all .log files below %APPDATA% or delete all Cookies older than 90 days. The script is extremely simple on purpose and I recommend testing thoroughly before implementing - use at your own risk; however feedback is welcome. &#39; Profile clean up - remove unneeded or old files before logoff &#39; -------------------------------------------------------------- &#39; Original scripts: &#39; http://www.wisesoft.co.uk/scripts/vbscript_recursive_file_delete_by_extension.aspx &#39; http://ss64.com/vb/syntax-profile.html &#39; http://csi-windows.com/toolkit/csigetspecialfolder &#39; Version 2.0; 27/12/2011 Option Explicit On Error Resume Next &#39;Avoid file in use issues Dim strExtensionsToDelete, strAppData, strUserProfile, objFSO, strCookies, strHistory, strRecent, objShellApp Set objFSO = CreateObject(&quot;Scripting.FileSystemObject&quot;) Set objShellApp = CreateObject(&quot;Shell.Application&quot;) Const CSIDL_COOKIES = &quot;&amp;H21&quot; Const CSIDL_HISTORY = &quot;&amp;H22&quot; Const CSIDL_RECENT = &quot;&amp;H08&quot; Const CSIDL_NETHOOD = &quot;&amp;H13&quot; Const CSIDL_APPDATA = &quot;&amp;H1A&quot; Const CSIDL_PROFILE = &quot;&amp;H28&quot; &#39; Folder to delete files from (files will also be deleted from Subfolders) strUserProfile = objShellApp.NameSpace(cint(CSIDL_PROFILE)).Self.Path strAppData = objShellApp.NameSpace(cint(CSIDL_APPDATA)).Self.Path strCookies = objShellApp.NameSpace(cint(CSIDL_COOKIES)).Self.Path strHistory = objShellApp.NameSpace(cint(CSIDL_HISTORY)).Self.Path strRecent = objShellApp.NameSpace(cint(CSIDL_RECENT)).Self.Path strNetHood = objShellApp.NameSpace(cint(CSIDL_NETHOOD)).Self.Path &#39; Main RecursiveDeleteByExtension strAppData, &quot;tmp,log&quot; RecursiveDeleteOlder 90, strCookies RecursiveDeleteOlder 14, strRecent RecursiveDeleteOlder 21, strHistory RecursiveDeleteOlder 21, strNetHood RecursiveDeleteOlder 14, strAppData &amp; &quot;\\Microsoft\\Office\\Recent&quot; &#39;RecursiveDeleteOlder 5, strAppData &amp; &quot;\\Sun\\Java\\Deployment\\cache&quot; &#39;RecursiveDeleteOlder 3, strAppData &amp; &quot;\\Macromedia\\Flash Player&quot; &#39;RecursiveDeleteOlder 14, strUserProfile &amp; &quot;\\Oracle Jar Cache&quot; Sub RecursiveDeleteByExtension(ByVal strPath,strExtensionsToDelete) &#39; Walk through strPath and sub-folders and delete files of type strExtensionsToDelete Dim objFolder, objSubFolder, objFile, strExt If objFSO.FolderExists(strPath) = True Then Set objFolder = objFSO.GetFolder(strPath) For Each objFile in objFolder.Files For each strExt in Split(UCase(strExtensionsToDelete),&quot;,&quot;) If Right(UCase(objFile.Path),Len(strExt)+1) = &quot;.&quot; &amp; strExt then WScript.Echo &quot;Deleting: &quot; &amp; objFile.Path objFile.Delete(True) Exit For End If Next Next For Each objSubFolder in objFolder.SubFolders RecursiveDeleteByExtension objSubFolder.Path,strExtensionsToDelete Next End If End Sub Sub RecursiveDeleteOlder(ByVal intDays,strPath) &#39; Delete files from strPath that are more than intDays old Dim objFolder, objFile, objSubFolder If objFSO.FolderExists(strPath) = True Then Set objFolder = objFSO.GetFolder(strPath) For each objFile in objFolder.files If DateDiff(&quot;d&quot;, objFile.DateLastModified,Now) &gt; intDays Then If UCase(objFile.Name) &lt;&gt; &quot;DESKTOP.INI&quot; Then &#39; Ensure we don&#39;t delete desktop.ini WScript.Echo &quot;Deleting: &quot; &amp; objFile.Path objFile.Delete(True) End If End If Next For Each objSubFolder in objFolder.SubFolders RecursiveDeleteOlder intDays,objSubFolder.Path Next End If End Sub","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"http://localhost:4000/profile-clean-up-script/","headline":"Reducing Profile Size with a Profile Clean Up Script","dateModified":"2011-12-28T10:00:17+11:00","datePublished":"2011-12-28T10:00:17+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/profile-clean-up-script/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="stealthpuppy" /><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="apple-mobile-web-app-title" content="stealthpuppy">
  <meta name="application-name" content="stealthpuppy">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="theme-color" content="#ffffff">
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a><a class="page-link" href="https://docs.stealthpuppy.com/docs">PROJECTS</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Reducing Profile Size with a Profile Clean Up Script</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2011-12-28T10:00:17+11:00" itemprop="datePublished">Dec 28, 2011
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="http://www.flickr.com/photos/pleeker/5379549514/">&lt;img class=”size-full wp-image-2604 aligncenter” title=”Delete by Cari McGee” src=”/media/2011/12/AppleKeyboardDelete.jpg” alt=”Delete by Cari McGee</a></p>

<p>Windows profiles become larger over time - it’s an inescapable fact. This means that if you are using roaming profiles, logons (and logoff) will be longer and longer. It’s not just individual file sizes, but also the number of files stored in a profile that will make the synchronisation process slower.</p>

<p>One approach to reducing profile sizes is to <a href="/virtualisation/reduce-logon-times-by-excluding-the-bloat/">exclude certain folders</a>. A better solution is to ditch roaming profiles and use <a href="http://www.brianmadden.com/blogs/rubenspruijt/archive/2011/11/01/user-environment-management-smackdown-head-to-head-analysis-of-appsense-citrix-immidio-liquidware-labs-microsoft-quest-res-scense-tricerat-unidesk-and-vuem.aspx">a third-party solution to manage roaming of the user environment</a>.</p>

<p>However, there will still be folders that need to be roamed to maintain the experience that users expect when moving between devices (i.e. consistency). For those folders we can implement some maintenance to keep them at a manageable size - that is remove files that are not needed in a roaming profile (e.g. log files) or delete files older than a specific number of days.</p>

<p><span style="color: #ff0000;">Warning</span>: <em>there’s a reason that Windows doesn’t do this maintenance itself - only each application vendor will have an understanding of whether specific files are required or can be discarded (hence the roaming and local portions of AppData). However, as any experienced Windows admin knows - many vendors either don’t test for or don’t care about roaming scenarios, therefore I strongly recommend testing this approach before production deployment.</em></p>

<p>As a part of <a href="/general/appsense-environment-manager-8-x-baseline-configuration/">an upcoming version of this configuration</a>, I’ve created a script that will execute at logoff, before the profile is saved back to the network, that will perform two actions:</p>

<ol>
  <li>Delete all files of a specific file type in a specified folder, including sub-folders</li>
  <li>Delete all files older than X days in a specified folder, including sub-folders</li>
</ol>

<p>So for example, you could use the script to delete all .log files below %APPDATA% or delete all Cookies older than 90 days.</p>

<p>The script is extremely simple on purpose and I recommend testing thoroughly before implementing - use at your own risk; however feedback is welcome.</p>

<pre class="prettyprint lang-vbscript" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">' Profile clean up - remove unneeded or old files before logoff
' --------------------------------------------------------------
' Original scripts:
' http://www.wisesoft.co.uk/scripts/vbscript_recursive_file_delete_by_extension.aspx
' http://ss64.com/vb/syntax-profile.html
' http://csi-windows.com/toolkit/csigetspecialfolder

' Version 2.0; 27/12/2011

Option Explicit
On Error Resume Next 'Avoid file in use issues

Dim strExtensionsToDelete, strAppData, strUserProfile, objFSO, strCookies, strHistory, strRecent, objShellApp
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objShellApp = CreateObject("Shell.Application")
Const CSIDL_COOKIES = "&amp;H21"
Const CSIDL_HISTORY = "&amp;H22"
Const CSIDL_RECENT = "&amp;H08"
Const CSIDL_NETHOOD = "&amp;H13"
Const CSIDL_APPDATA = "&amp;H1A"
Const CSIDL_PROFILE = "&amp;H28"

' Folder to delete files from (files will also be deleted from Subfolders)
strUserProfile = objShellApp.NameSpace(cint(CSIDL_PROFILE)).Self.Path
strAppData = objShellApp.NameSpace(cint(CSIDL_APPDATA)).Self.Path
strCookies = objShellApp.NameSpace(cint(CSIDL_COOKIES)).Self.Path
strHistory = objShellApp.NameSpace(cint(CSIDL_HISTORY)).Self.Path
strRecent = objShellApp.NameSpace(cint(CSIDL_RECENT)).Self.Path
strNetHood = objShellApp.NameSpace(cint(CSIDL_NETHOOD)).Self.Path

' Main
RecursiveDeleteByExtension strAppData, "tmp,log"
RecursiveDeleteOlder 90, strCookies
RecursiveDeleteOlder 14, strRecent
RecursiveDeleteOlder 21, strHistory
RecursiveDeleteOlder 21, strNetHood
RecursiveDeleteOlder 14, strAppData &amp; "\Microsoft\Office\Recent"
'RecursiveDeleteOlder 5, strAppData &amp; "\Sun\Java\Deployment\cache"
'RecursiveDeleteOlder 3, strAppData &amp; "\Macromedia\Flash Player"
'RecursiveDeleteOlder 14, strUserProfile &amp; "\Oracle Jar Cache"

Sub RecursiveDeleteByExtension(ByVal strPath,strExtensionsToDelete)
    ' Walk through strPath and sub-folders and delete files of type strExtensionsToDelete
    Dim objFolder, objSubFolder, objFile, strExt

    If objFSO.FolderExists(strPath) = True Then
        Set objFolder = objFSO.GetFolder(strPath)
        For Each objFile in objFolder.Files
            For each strExt in Split(UCase(strExtensionsToDelete),",")
                If Right(UCase(objFile.Path),Len(strExt)+1) = "." &amp; strExt then
                    WScript.Echo "Deleting: " &amp; objFile.Path
                    objFile.Delete(True)
                    Exit For
                End If
            Next
        Next
        For Each objSubFolder in objFolder.SubFolders
            RecursiveDeleteByExtension objSubFolder.Path,strExtensionsToDelete
        Next
    End If
End Sub

Sub RecursiveDeleteOlder(ByVal intDays,strPath)
    ' Delete files from strPath that are more than intDays old
    Dim objFolder, objFile, objSubFolder

    If objFSO.FolderExists(strPath) = True Then
        Set objFolder = objFSO.GetFolder(strPath)
        For each objFile in objFolder.files
            If DateDiff("d", objFile.DateLastModified,Now) &gt; intDays Then
                If UCase(objFile.Name) &lt;&gt; "DESKTOP.INI" Then ' Ensure we don't delete desktop.ini
                    WScript.Echo "Deleting: " &amp; objFile.Path
                    objFile.Delete(True)
                End If
            End If
        Next
        For Each objSubFolder in objFolder.SubFolders
            RecursiveDeleteOlder intDays,objSubFolder.Path
        Next
    End If
End Sub</pre>


  </div><a class="u-url" href="/profile-clean-up-script/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
