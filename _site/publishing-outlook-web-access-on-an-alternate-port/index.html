<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Publishing Outlook Web Access on an Alternate Port | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Publishing Outlook Web Access on an Alternate Port" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We recently had client with a requirement to provide Outlook Web Access and Exchange over the Internet/Outlook Anywhere (RPC over HTTPS) access using a single IP address on ISA Server. The problem with making both of these services available on a single IP address is that both utilise HTTPS which by default is TCP 443. RPC over HTTPS with Outlook can’t use an alternate port - if you attempt to specify and alternate port Outlook UI you receive the following error:" />
<meta property="og:description" content="We recently had client with a requirement to provide Outlook Web Access and Exchange over the Internet/Outlook Anywhere (RPC over HTTPS) access using a single IP address on ISA Server. The problem with making both of these services available on a single IP address is that both utilise HTTPS which by default is TCP 443. RPC over HTTPS with Outlook can’t use an alternate port - if you attempt to specify and alternate port Outlook UI you receive the following error:" />
<link rel="canonical" href="/publishing-outlook-web-access-on-an-alternate-port/" />
<meta property="og:url" content="/publishing-outlook-web-access-on-an-alternate-port/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2006-12-05T19:39:00+11:00" />
<script type="application/ld+json">
{"description":"We recently had client with a requirement to provide Outlook Web Access and Exchange over the Internet/Outlook Anywhere (RPC over HTTPS) access using a single IP address on ISA Server. The problem with making both of these services available on a single IP address is that both utilise HTTPS which by default is TCP 443. RPC over HTTPS with Outlook can’t use an alternate port - if you attempt to specify and alternate port Outlook UI you receive the following error:","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/publishing-outlook-web-access-on-an-alternate-port/","headline":"Publishing Outlook Web Access on an Alternate Port","dateModified":"2006-12-05T19:39:00+11:00","datePublished":"2006-12-05T19:39:00+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/publishing-outlook-web-access-on-an-alternate-port/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Publishing Outlook Web Access on an Alternate Port</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2006-12-05T19:39:00+11:00" itemprop="datePublished">Dec 5, 2006
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img align="left" src="/media/2006/12/exchange.png" />We recently had client with a requirement to provide Outlook Web Access and Exchange over the Internet/Outlook Anywhere (RPC over HTTPS) access using a single IP address on ISA Server. The problem with making both of these services available on a single IP address is that both utilise HTTPS which by default is TCP 443. RPC over HTTPS with Outlook can’t use an alternate port - if you attempt to specify and alternate port Outlook UI you receive the following error:</p>

<font face="courier new,courier">The proxy server you have specified is invalid. Correct it and try again.</font>

<p>Therefore the solution was to provide Outlook Web Access on an alternate port (TCP 444), whilst leaving RPC over HTTPS on TCP 443. In this case we setup a web publishing rule that used a web listener using TCP 444 pointing to the internal Exchange server configured to accept HTTPS on TCP 443. However, we found that users would receive the following error messages in the browser when moving or deleting e-mail messages:</p>

<p>“<font face="courier new,courier">Moving or copying items between Exchange servers is not supported</font>” and “<font face="courier new,courier">502 Bad Gateway</font>”</p>

<p><img border="0" width="369" src="/media/2006/12/1000.14.220.OWAError1.PNG" height="113" style="width: 369px; height: 113px" /><img border="0" src="/media/2006/12/1000.14.221.OWAError2.PNG" /></p>

<p>The solution to this was to configure IIS on the Exchange server to use TCP 444 for HTTPS/SSL and reconfigure the ISA Server web publishing rule to specify TCP 444 for SSL for the web listenter and the published server. I presume this has something to do with the dynamic nature of the Outlook Web Access application, but I’ve not had a chance to investigate any deeper.</p>

  </div><a class="u-url" href="/publishing-outlook-web-access-on-an-alternate-port/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
