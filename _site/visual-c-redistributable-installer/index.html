<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Install-VisualCRedistributables.ps1 - A Visual C++ Redistributable Installer | aaron parker</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Install-VisualCRedistributables.ps1 - A Visual C++ Redistributable Installer" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In updating my MDT deployment shares recently, I got tired of having to do something about the Visual C++ Redistributable installers and finally decided to do something about it, so I’ve written a script that will download the installers and optionally install them - Install-VisualCRedistributables.ps1." />
<meta property="og:description" content="In updating my MDT deployment shares recently, I got tired of having to do something about the Visual C++ Redistributable installers and finally decided to do something about it, so I’ve written a script that will download the installers and optionally install them - Install-VisualCRedistributables.ps1." />
<link rel="canonical" href="/visual-c-redistributable-installer/" />
<meta property="og:url" content="/visual-c-redistributable-installer/" />
<meta property="og:site_name" content="aaron parker" />
<meta property="og:image" content="/wp-content/uploads/2017/05/2005-2017.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-01T19:26:58+10:00" />
<script type="application/ld+json">
{"description":"In updating my MDT deployment shares recently, I got tired of having to do something about the Visual C++ Redistributable installers and finally decided to do something about it, so I’ve written a script that will download the installers and optionally install them - Install-VisualCRedistributables.ps1.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/visual-c-redistributable-installer/","image":"/wp-content/uploads/2017/05/2005-2017.png","headline":"Install-VisualCRedistributables.ps1 - A Visual C++ Redistributable Installer","dateModified":"2017-05-01T19:26:58+10:00","datePublished":"2017-05-01T19:26:58+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/visual-c-redistributable-installer/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="aaron parker" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">aaron parker</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Install-VisualCRedistributables.ps1 - A Visual C++ Redistributable Installer</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2017-05-01T19:26:58+10:00" itemprop="datePublished">May 1, 2017
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>In updating my <a href="http://stealthpuppy.com/tag/mdt/">MDT</a> deployment shares recently, I got tired of having to do something about the Visual C++ Redistributable installers and finally decided to do something about it, so I’ve written a script that will download the installers and optionally install them - <a href="https://github.com/aaronparker/Install-VisualCRedistributables">Install-VisualCRedistributables.ps1</a>.</p>

<p>This script reads <a href="https://github.com/aaronparker/Install-VisualCRedistributables/blob/master/bin/VisualCRedistributablesSupported.xml">an external XML file</a> that contains the installer information for each of the Visual C++ Redistributables so that changes to URLs, install options and new redistributables can be made without making changes to the script. The XML file lists the download URL and install instructions for each installer and looks like this:</p>

<pre class="prettyprint lang-xml" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Redistributables&gt;
    &lt;Platform Architecture="x64" Release="2005" Install="/Q"&gt;
        &lt;Redistributable&gt;
            &lt;Name&gt;Microsoft Visual C++ 2005 Service Pack 1 Redistributable Package MFC Security Update&lt;/Name&gt;
            &lt;URL&gt;https://www.microsoft.com/en-us/download/details.aspx?id=26347&lt;/URL&gt;
            &lt;Download&gt;https://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_x64.EXE&lt;/Download&gt;
        &lt;/Redistributable&gt;
        &lt;Redistributable&gt;
    &lt;/Platform&gt;
    &lt;Platform Architecture="x86" Release="2005" Install="/Q"&gt;
        &lt;Redistributable&gt;
            &lt;Name&gt;Microsoft Visual C++ 2005 Service Pack 1 Redistributable Package MFC Security Update&lt;/Name&gt;
            &lt;URL&gt;https://www.microsoft.com/en-us/download/details.aspx?id=26347&lt;/URL&gt;
            &lt;Download&gt;https://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_x86.EXE&lt;/Download&gt;
        &lt;/Redistributable&gt;
    &lt;/Platform&gt;
    &lt;Platform Architecture="x64" Release="2017" Install="/install /passive /norestart"&gt;
        &lt;Redistributable&gt;
            &lt;Name&gt;Microsoft Visual C++ Redistributable for Visual Studio 2017&lt;/Name&gt;
            &lt;URL&gt;https://www.visualstudio.com/downloads/&lt;/URL&gt;
            &lt;Download&gt;https://download.microsoft.com/download/3/b/f/3bf6e759-c555-4595-8973-86b7b4312927/vc_redist.x64.exe&lt;/Download&gt;
        &lt;/Redistributable&gt;
    &lt;/Platform&gt;
    &lt;Platform Architecture="x86" Release="2017" Install="/install /passive /norestart"&gt;
        &lt;Redistributable&gt;
            &lt;Name&gt;Microsoft Visual C++ Redistributable for Visual Studio 2017&lt;/Name&gt;
            &lt;URL&gt;https://www.visualstudio.com/downloads/&lt;/URL&gt;
            &lt;Download&gt;https://download.microsoft.com/download/1/f/e/1febbdb2-aded-4e14-9063-39fb17e88444/vc_redist.x86.exe&lt;/Download&gt;
        &lt;/Redistributable&gt;
    &lt;/Platform&gt;
&lt;/Redistributables&gt;</pre>

<p>The script will install the redistributables in the order listed in the XML file thus ensuring they are installed in the correct order.</p>

<h1 id="using-install-visualcredistributablesps1">Using Install-VisualCRedistributables.ps1</h1>

<p>Download <a href="https://github.com/aaronparker/Install-VisualCRedistributables/blob/master/bin/Install-VisualCRedistributables.ps1" title="Install-VisualCRedistributables.ps1">Install-VisualCRedistributables.ps1</a>{#6688ca8243a1ff4cb920b2f5b0eb5d4f-fc78b16fb52218a5ca1961809bece9155c302c06.js-navigation-open} and <a href="https://github.com/aaronparker/Install-VisualCRedistributables/blob/master/bin/VisualCRedistributablesSupported.xml" title="VisualCRedistributables.xml">VisualCRedistributablesSupported.xml</a>{#ae2b8c9175203ac3b93b3a45bf39ac3f-2392f8cdffa2c6a99fa7b73e04bccc284321c434.js-navigation-open} from the repository and edit the XML as required. As this includes all supported redistributables from 2008 to 2017, all will be downloaded and installed by default. If you don’t need all of them in your environment, remove those that aren’t required.</p>

<p>The script can be run in two phases - one to download the installers and again to install the redistributables - this is useful for downloading the installers to add to your reference image via MDT, for example. The script can also be used to download and install in one action.</p>

<h2 id="parameters">Parameters</h2>

<p>The parameters for the script are:</p>

<h3 id="xml">Xml</h3>

<p>This points to the XML file that contains the details about the Visual C++ Redistributables. This must be in the expected format, otherwise, the script will fail.</p>

<p>Example - Downloads the Visual C++ Redistributables listed in VisualCRedistributables.xml.</p>

<pre class="prettyprint lang-powershell" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">.\Install-VisualCRedistributables.ps1 -Xml ".\VisualCRedistributablesSupported.xml"</pre>

<h3 id="path">Path</h3>

<p>Specify a target folder to download the Redistributables to, otherwise, use the current folder.</p>

<p>Example - Downloads the Visual C++ Redistributables listed in VisualCRedistributables.xml to C:\Redist.</p>

<pre class="prettyprint lang-powershell" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">.\Install-VisualCRedistributables.ps1 -Xml ".\VisualCRedistributablesSupported.xml" -Path C:\Redist</pre>

<h3 id="install">Install</h3>

<p>By default, the script will only download the Redistributables. This allows you to download the Redistributables for separate deployment (e.g. in a reference image). Add -Install to install each of the Redistributables as well.</p>

<p>Example - Downloads and installs the Visual C++ Redistributables listed in VisualCRedistributables.xml.</p>

<pre class="prettyprint lang-powershell" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">.\Install-VisualCRedistributables.ps1 -Xml ".\VisualCRedistributablesSupported.xml" -Install:$True</pre>

<h1 id="results">Results</h1>

<p>Here is an example of the end result with the Redistributables installed. Note that 2015 and 2017 are the same major version (14.x), so once 2017 is installed, 2015 will not be displayed in the programs list. 2005 are not installed by default, as these are no longer supported.</p>

<figure id="attachment_5436" aria-describedby="caption-attachment-5436" style="width: 1024px" class="wp-caption alignnone">[<img class="size-large wp-image-5436" src="http://stealthpuppy.com/wp-content/uploads/2017/05/2005-2017-1024x639.png" alt="Microsoft Visual C++ Redistributable 2005-2015 installed" width="1024" height="639" srcset="https://stealthpuppy.com/wp-content/uploads/2017/05/2005-2017-1024x639.png 1024w, https://stealthpuppy.com/wp-content/uploads/2017/05/2005-2017-150x94.png 150w, https://stealthpuppy.com/wp-content/uploads/2017/05/2005-2017-300x187.png 300w, https://stealthpuppy.com/wp-content/uploads/2017/05/2005-2017-768x479.png 768w, https://stealthpuppy.com/wp-content/uploads/2017/05/2005-2017.png 1442w" sizes="(max-width: 1024px) 100vw, 1024px" />](http://stealthpuppy.com/wp-content/uploads/2017/05/2005-2017.png)<figcaption id="caption-attachment-5436" class="wp-caption-text">Microsoft Visual C++ Redistributables*

# Finally

This is the first version of the script and to the best of my knowledge, the XML file is correct. Feedback and corrections are welcome and I have some plans to update the script with some additional error checking.
</figcaption></figure>

  </div><a class="u-url" href="/visual-c-redistributable-installer/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">aaron parker</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">{&quot;name&quot;=&gt;&quot;Aaron Parker&quot;, &quot;location&quot;=&gt;&quot;Melbourne, Australia&quot;, &quot;email&quot;=&gt;&quot;aaron@stealthpuppy.com&quot;, &quot;github&quot;=&gt;&quot;aaronparker&quot;, &quot;linkedin&quot;=&gt;&quot;aaronedwardparker&quot;, &quot;twitter&quot;=&gt;&quot;stealthpuppy&quot;}</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
