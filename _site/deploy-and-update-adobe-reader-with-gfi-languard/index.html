<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Deploy and update Adobe Reader with GFI LANguard | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Deploy and update Adobe Reader with GFI LANguard" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This post has been sitting in my drafts since June 2009 and for whatever reason I haven&#39;t gotten around to posting it. So rather than delete it, I&#39;m posting it as is - apologies in advance for quality of this post" />
<meta property="og:description" content="This post has been sitting in my drafts since June 2009 and for whatever reason I haven&#39;t gotten around to posting it. So rather than delete it, I&#39;m posting it as is - apologies in advance for quality of this post" />
<link rel="canonical" href="/deploy-and-update-adobe-reader-with-gfi-languard/" />
<meta property="og:url" content="/deploy-and-update-adobe-reader-with-gfi-languard/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2010-03-21T23:57:33+11:00" />
<script type="application/ld+json">
{"description":"This post has been sitting in my drafts since June 2009 and for whatever reason I haven&#39;t gotten around to posting it. So rather than delete it, I&#39;m posting it as is - apologies in advance for quality of this post","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/deploy-and-update-adobe-reader-with-gfi-languard/","headline":"Deploy and update Adobe Reader with GFI LANguard","dateModified":"2010-03-21T23:57:33+11:00","datePublished":"2010-03-21T23:57:33+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/deploy-and-update-adobe-reader-with-gfi-languard/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Deploy and update Adobe Reader with GFI LANguard</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2010-03-21T23:57:33+11:00" itemprop="datePublished">Mar 21, 2010
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p class="note">
  This post has been sitting in my drafts since June 2009 and for whatever reason I haven't gotten around to posting it. So rather than delete it, I'm posting it as is - apologies in advance for quality of this post
</p>

<p>I have used LANguard in the past for vulnerability testing and network discovery but frankly that’s kind of boring stuff. What is interesting in the latest version is the ability to deploy software.</p>

<p><a href="http://www.gfi.com/lannetscan">LANguard 9</a> includes application deployment functions that make deploying software to remote machines quite simple.  I’m going to detail deploying Adobe Reader 9, using the deployment notes outlined in my <a href="/deployment/deploying-adobe-reader-9-for-windows">Deploying Adobe Reader 9</a> post, then deploy the Reader 9.1.1 update, using that functionality.</p>

<p>I’m going to skip over most of the details of installing LANguard - it’s a simple process, you’ll just need to choose the type of datebase you</p>

<p>In my test environment I have configured three machines:</p>

<ul>
  <li>a domain controller (DC), which will also host my install files (at \dc\common)</li>
  <li>a machine running Windows Vista on which I have installed LANguard (LANGUARD)</li>
  <li>and a machine running Windows 7 (WIN7A) to which I will deploy Adobe Reader</li>
</ul>

<p>To deploy software to a remote machine, I need to be able to authenticate to that machine. Because I am using a domain, authentication is made simple; however I could actually deploy software to workgroup machines if I know an admin username and password for that those machines.</p>

<p>The deployment feature of LANguard is geared around installing a single file with parameters; however it’s simple enough to deploy applications like Office or Reader by using a batch file:</p>

<p><img class="alignnone size-full wp-image-1141" title="addcustomsoftware" src="https://stealthpuppy.com/media/2009/05/addcustomsoftware.png" alt="addcustomsoftware" width="327" height="303" srcset="https://stealthpuppy.com/media/2009/05/addcustomsoftware.png 327w, https://stealthpuppy.com/media/2009/05/addcustomsoftware-150x138.png 150w, https://stealthpuppy.com/media/2009/05/addcustomsoftware-300x277.png 300w" sizes="(max-width: 327px) 100vw, 327px" /></p>

<p>Before I start deployment, I’ve configured a source location (\dc\common\Adobe\Reader91) for Adobe Reader 9.1:</p>

<ul>
  <li>I have extracted the Reader 9.1 install files from the setup file downloaded from Adobe;</li>
  <li>I have created a transform that will configure Reader as it is installed; and</li>
  <li>I have created a batch file (INSTALL.CMD) that contains the install commands for Adobe Reader</li>
</ul>

<p>INSTALL.CMD looks like this:</p>

<p><code class="highlighter-rouge">@ECHO OFF&lt;br /&gt;
SET SOURCE=\\dc\Common\Adobe\Reader91&lt;br /&gt;
MSIEXEC /I %SOURCE%\AcroRead.msi TRANSFORMS=%SOURCE%\AdobeReader91Custom.mst ALLUSERS=TRUE REBOOT=SUPRESS /QB</code></p>

<p>The script will install Adobe Reader directly from the network, so the only file being copied to the remote machine is the script. Here’s what the install source for Adobe Reader looks like:</p>

<p><img class="alignnone size-full wp-image-1135" title="reader91" src="https://stealthpuppy.com/media/2009/05/reader91.png" alt="reader91" width="590" height="341" srcset="https://stealthpuppy.com/media/2009/05/reader91.png 590w, https://stealthpuppy.com/media/2009/05/reader91-150x86.png 150w, https://stealthpuppy.com/media/2009/05/reader91-300x173.png 300w" sizes="(max-width: 590px) 100vw, 590px" /></p>

<p>Deploying software is a three step process:</p>

<ol>
  <li>add the file to deploy to the remote machines (in this case the batch file which will do the work);</li>
  <li>add the machines (by specifiying the hostname) to deploy the software to;</li>
  <li>then deploy immediately or choose to install using a schedule:</li>
</ol>

<p><img class="alignnone size-full wp-image-1140" style="border: black 1px solid;" title="deploycustomsoftware-1b" src="https://stealthpuppy.com/media/2009/05/deploycustomsoftware-1b.png" alt="deploycustomsoftware-1b" width="590" height="496" srcset="https://stealthpuppy.com/media/2009/05/deploycustomsoftware-1b.png 590w, https://stealthpuppy.com/media/2009/05/deploycustomsoftware-1b-150x126.png 150w, https://stealthpuppy.com/media/2009/05/deploycustomsoftware-1b-300x252.png 300w" sizes="(max-width: 590px) 100vw, 590px" /></p>

<p>So how is this actually working? The deployment feature on LANguard is not dissimilar to the Sysinternals tool PSEXEC, where a temporary service is installed on the remote machine to deliver the install commands. Essentially to deploy Adobe Reader 9, I am using LANguard to remotely execute INSTALL.CMD. I need admin rights on the target computers and LANguard does the rest. I even get to see the progress of the deployment:</p>

<p><img class="alignnone size-full wp-image-1145" style="border: black 1px solid;" title="deploymenprogess" src="https://stealthpuppy.com/media/2009/05/deploymenprogess.png" alt="deploymenprogess" width="434" height="270" srcset="https://stealthpuppy.com/media/2009/05/deploymenprogess.png 434w, https://stealthpuppy.com/media/2009/05/deploymenprogess-150x93.png 150w, https://stealthpuppy.com/media/2009/05/deploymenprogess-300x186.png 300w" sizes="(max-width: 434px) 100vw, 434px" /></p>

<p>I can also use the same process to update Reader 9.1 with the 9.11. update patch.</p>

<p>I have downloaded the <a href="http://www.adobe.com/support/downloads/detail.jsp?ftpID=4452">Adobe Reader 9.1.1 Update</a> (which comes as a Windows Installer Patch file - .MSP) and added it to the the same deployment location (\dc\common\Adobe\Reader911Update). Again I have created a batch file that will install the 9.1.1 update from the same location:</p>

<p><code class="highlighter-rouge">@ECHO OFF&lt;br /&gt;
SET SOURCE=\\dc\common\Adobe\Reader911Update&lt;br /&gt;
MSIEXEC /P %SOURCE%\AdbeRdrUpd911_all_incr.msp ALLUSERS=TRUE REBOOT=SUPRESS /QB</code></p>

<p>By going through the same deployment configuration, but instead using the batch file that will install the update, I can deploy to the machines that have Reader 9.1.</p>

<p>I’ve tested deploying the update while Reader is open on the remote machine and the install was successful. Once I closed and reopened Reader, I could see the 9.1.1 version. This may not work for all applications - I don’t think that my example worked specifically because of LANguard, but you should at least have some success when updating in-use applications.</p>

  </div><a class="u-url" href="/deploy-and-update-adobe-reader-with-gfi-languard/" hidden></a>
</article>
      </div>
    </main>

    <footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
