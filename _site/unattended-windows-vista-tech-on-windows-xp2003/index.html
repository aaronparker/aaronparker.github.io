<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Unattended Windows Vista tech. on Windows XP/2003 | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Unattended Windows Vista tech. on Windows XP/2003" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="UPDATE (09/12/2007): Updated with the list of applications and components listed here: Windows Vista components available for Windows XP." />
<meta property="og:description" content="UPDATE (09/12/2007): Updated with the list of applications and components listed here: Windows Vista components available for Windows XP." />
<link rel="canonical" href="/unattended-windows-vista-tech-on-windows-xp2003/" />
<meta property="og:url" content="/unattended-windows-vista-tech-on-windows-xp2003/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-01-28T01:05:00+11:00" />
<script type="application/ld+json">
{"description":"UPDATE (09/12/2007): Updated with the list of applications and components listed here: Windows Vista components available for Windows XP.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/unattended-windows-vista-tech-on-windows-xp2003/","headline":"Unattended Windows Vista tech. on Windows XP/2003","dateModified":"2007-01-28T01:05:00+11:00","datePublished":"2007-01-28T01:05:00+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/unattended-windows-vista-tech-on-windows-xp2003/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Unattended Windows Vista tech. on Windows XP/2003</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-01-28T01:05:00+11:00" itemprop="datePublished">Jan 28, 2007
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><strong>UPDATE</strong> (09/12/2007): Updated with the list of applications and components listed here: <a href="/windows/windows-vista-components-available-for-windows-xp">Windows Vista components available for Windows XP</a>.</p>

<p>With Microsoft releasing a number of applications developed for Windows Vista also available for Windows XP, I’ve put together a quick ‘how to’ guide for performing an unattended install for each application.</p>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Windows Internet Explorer 7 [ <a href="http://download.microsoft.com/download/3/8/8/38889dc1-848c-4bf2-8335-86c573ad86d9/IE7-WindowsXP-x86-enu.exe">Windows XP 32-bit</a></td>
          <td><a href="http://download.microsoft.com/download/d/1/3/d1346f12-f3a0-4ac6-8f5c-2bea2a184957/IE7-WindowsServer2003-x86-enu.exe">Windows Server 2003 32-bit</a> ]</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Windows Media Player 11 [ <a href="http://download.microsoft.com/download/0/9/5/0953e553-3bb6-44b1-8973-106f1b7e5049/wmp11-windowsxp-x86-enu.exe">Windows XP 32-bit</a> ]</li>
  <li>Windows Defender 1.1 [ <a href="http://download.microsoft.com/download/e/d/0/ed099d5e-dc60-4740-8747-1c72f053b800/WindowsDefender.msi">Windows XP / Server 2003 32-bit</a> ]</li>
  <li>Microsoft .NET Framework 3.0 [ <a href="http://go.microsoft.com/fwlink/?LinkId=70848">Windows XP / Server 2003 32-bit</a> ]</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Windows Desktop Search 3.01 [ <a href="http://www.microsoft.com/downloads/info.aspx?na=90&amp;p=&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=738fc2de-49b9-4e69-9227-2206277ab7c9&amp;u=http%3a%2f%2fdownload.microsoft.com%2fdownload%2f9%2fb%2fd%2f9bd9c91f-7a74-4084-9198-49d2cfab7947%2fWindowsDesktopSearch-KB917013-V301-XP-x86-enu.exe">Windows XP 32-bit</a></td>
          <td><a href="http://www.microsoft.com/downloads/info.aspx?na=90&amp;p=&amp;SrcDisplayLang=en&amp;SrcCategoryId=&amp;SrcFamilyId=0e0423b4-d396-4986-a1bb-793122fcc65d&amp;u=http%3a%2f%2fdownload.microsoft.com%2fdownload%2fa%2f9%2f0%2fa904410d-f3ed-4422-97b3-f5cff7c1eecc%2fWindowsDesktopSearch-KB917013-V301-Srv2K3-x86-enu.exe">Windows Server 2003 32-bit</a> ]</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Remote Desktop Connection 6.0 [ <a href="http://download.microsoft.com/download/7/0/9/709358f0-4d6e-4d0d-bd41-9dde83446fed/WindowsXP-KB925876-x86-ENU.exe">Windows XP 32-bit</a></td>
          <td><a href="http://download.microsoft.com/download/8/8/7/8879aabf-6352-4ffe-a65a-11b3f70eb6eb/WindowsServer2003-KB925876-x86-ENU.exe">Windows Server 2003 32-bit</a> ]</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Link Layer Topology Discovery (LLTD) Responder [ <a href="http://download.microsoft.com/download/0/5/f/05fc30db-e7af-4488-a3a8-23999328e4bd/WindowsXP-KB922120-v5-x86-ENU.exe">Windows XP 32-bit</a> ]</li>
</ul>

<p>The approach I’ve taken here are direct command lines for installing these applications as you would do with a custom Windows CD or installing after Windows is installed on the computer. You could fit these installs to tools such as Microsoft SMS or Altiris Deployment Solution. If you deploy via Group Policy then you’ll have to take a different approach.</p>

<p>Here’s a breakdown for each application including the command line you need to use for an unattended or silent install. I have the Windows XP version executables listed, so for Windows Server 2003 you will have to adjust the file names.</p>

<h3 id="windows-internet-explorer-7">Windows Internet Explorer 7</h3>

<p>Internet Explorer can be installed during Windows Setup via <a href="http://www.microsoft.com/technet/technetmag/issues/2006/05/TechniquesForSimp/default.aspx">CMDLINES.TXT</a>. This will ensure that the latest version of IE is installed as soon as Windows setup is complete from a clean install. This command will stop the setup program from downloading updates during install and will display a dialog box with a progress bar. You can also add the /NO-DEFAULT switch to prevent setup from making Internet Explorer the default web browser. You can get a full list of command line switches by running IE7-WindowsXP-x86-enu.EXE /?.</p>

<p>[code]START /WAIT IE7-WindowsXP-x86-enu.EXE /PASSIVE /NORESTART /UPDATE-NO [/code]</p>

<h3 id="windows-media-player-11">Windows Media Player 11</h3>

<p>This application is for Windows XP only, but then who needs WMP 11 on their Terminal Server? Unlike Internet Explorer, I’ve not been able to get Windows Media Player to install via CMDLINES.TXT. This command will install Windows Media Player without you seeing any install user interface during setup.</p>

<p>[code]START /WAIT wmp11-windowsxp-x86-enu.exe /Q:A /C:”SETUP_WM.EXE /Q:A /R:N /P:#e” [/code]</p>

<h3 id="windows-defender-11">Windows Defender 1.1</h3>

<p>This command line will install Windows Defender silently prevent Windows Defender from running after setup is complete.</p>

<p>[code]START /WAIT MSIEXEC /I WindowsDefender.MSI ALLUSERS=TRUE REBOOT=SUPRESS CHECK_WGA=0 LAUNCHPROGRAM=0 LAUNCHSCAN=0 /QB- [/code]</p>

<h3 id="microsoft-net-framework-30">Microsoft .NET Framework 3.0</h3>

<p>The .NET Framework 3.0 includes the .NET Framework 2.0 so you do not have to install that version separately. You will see a dialog with a progress bar during install.</p>

<p>[code]START /WAIT dotnetfx3.EXE /PASSIVE /NORESTART [/code]</p>

<h3 id="windows-desktop-search-301">Windows Desktop Search 3.01</h3>

<p>The Windows Desktop Search setup application will accept the /PASSIVE switch so that a progress bar is displayed during setup, but the /QUIET switch is required to prevent setup from displaying an ‘Install Complete’ dialog once finished.</p>

<p>[code]START /WAIT WindowsDesktopSearch-KB917013-V301-XP-x86-enu.exe /QUIET /NORESTART [/code]</p>

<h3 id="remote-desktop-connection-60">Remote Desktop Connection 6.0</h3>

<p>Like Internet Explorer this application can be deployed via CMDLINES.TXT using a custom Windows setup source.</p>

<p>[code]START /WAIT WindowsXP-KB925876-x86-ENU.EXE /PASSIVE /NORESTART [/code]</p>

<h3 id="link-layer-topology-discovery-lltd-responder">Link Layer Topology Discovery (LLTD) Responder</h3>

<p>The LLTD Responder will install via CMDLINES.TXT. Here’s a description of what the <a href="http://support.microsoft.com/?kbid=922120">LLTD Responder</a> is from the Microsoft web site:</p>

<blockquote>
  <p>The network map on a computer running Windows Vista shows a graphical view of the computers and devices on your network and how they are connected by using the LLTD protocol. The LLTD responder must be installed on a computer running Windows XP before it can be detected and appear on the network map.</p>
</blockquote>

<p>[code]START /WAIT WindowsXP-KB922120-v5-x86-ENU.exe /PASSIVE /NORESTART[/code]</p>

<h3 id="full-list">Full List</h3>

<p>I’ve updated this script with the applications listed <a href="/windows/windows-vista-components-available-for-windows-xp">here</a>. Windows Installer 3.1 is a requirement for installing .NET Framework 3.5.</p>

<p>[code]@ECHO OFF<br />
REM Windows Installer 3.1<br />
START /WAIT WindowsInstaller-KB893803-v2-x86.EXE /PASSIVE /NORESTART</p>

<p>REM Microsoft Core XML Services 6.0<br />
START /WAIT MSIEXEC /I MSXML6.MSI ALLUSERS=TRUE REBOOT=SUPPRESS /QB</p>

<p>REM Internet Explorer 7<br />
START /WAIT IE7-WindowsXP-x86-enu.EXE /PASSIVE /NORESTART /UPDATE-NO</p>

<p>REM Windows Media Player 11<br />
START /WAIT wmp11-windowsxp-x86-enu.EXE /Q:A /C:”SETUP_WM.EXE /Q:A /R:N /P:#e”</p>

<p>REM Windows Defender 1.1<br />
START /WAIT MSIEXEC /I WindowsDefender.MSI ALLUSERS=TRUE REBOOT=SUPRESS CHECK_WGA=0 LAUNCHPROGRAM=0 LAUNCHSCAN=0 /QB-</p>

<p>REM .NET Framework 3.5<br />
START /WAIT dotnetfx35.EXE /PASSIVE /NORESTART</p>

<p>REM Windows Desktop Search 3.01<br />
START /WAIT WindowsDesktopSearch-KB917013-V301-XP-x86-enu.EXE /QUIET /NORESTART</p>

<p>REM Remote Desktop Connection 6.0<br />
START /WAIT WindowsXP-KB925876-x86-ENU.EXE /PASSIVE /NORESTART</p>

<p>REM LLTD Responder<br />
START /WAIT WindowsXP-KB922120-v5-x86-ENU.EXE /PASSIVE /NORESTART</p>

<p>REM Image Mastering API<br />
START /WAIT WindowsXP-KB932716-x86-ENU.EXE /PASSIVE /NORESTART</p>

<p>REM Microsoft Management Console 3.0<br />
START /WAIT WindowsXP-KB907265-x86-ENU.EXE /PASSIVE /NORESTART</p>

<p>REM Windows Script 5.7<br />
START /WAIT scriptenXP.exe /PASSIVE /NORESTART</p>

<p>REM Windows PowerShell 1.0<br />
START /WAIT WindowsXP-KB926139-x86-ENU.EXE /PASSIVE /NORESTART</p>

<p>REM XPS Essentials Pack<br />
START /WAIT MSIEXEC /I “XPSEP XP and Server 2003 32 bit.MSI” ALLUSERS=TRUE REBOOT=SUPRESS /QB</p>

<p>REM Peer Name Resolution Protocol (PNRP) version 2.0<br />
START /WAIT WindowsXP-KB920342-x86-ENU.EXE /PASSIVE /NORESTART</p>

<p>REM Silverlight 1.0<br />
START /WAIT SILVERLIGHT.EXE /Q</p>

<p>REM Network Diagnostic Tool<br />
START /WAIT WindowsXP-KB914440-v12-x86-ENU.EXE /PASSIVE /NORESTART</p>

<p>REM WS-Management v1.1<br />
START /WAIT WindowsXP-KB936059-x86-ENU.EXE /PASSIVE /NORESTART</p>

<p>REM Windows Rights Management Services Client with Service Pack 1<br />
START /WAIT WindowsRightsManagementServicesSP1-KB839178-Client-ENU.EXE /PASSIVE /NORESTART[/code]</p>

  </div><a class="u-url" href="/unattended-windows-vista-tech-on-windows-xp2003/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
