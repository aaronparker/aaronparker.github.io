<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Application Compatibility And The Benefits Of Virtualisation | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Application Compatibility And The Benefits Of Virtualisation" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="If there’s ever a great example of the benefits of application virtualisation it can often be found in the little things." />
<meta property="og:description" content="If there’s ever a great example of the benefits of application virtualisation it can often be found in the little things." />
<link rel="canonical" href="/application-compatibility-and-softgrid/" />
<meta property="og:url" content="/application-compatibility-and-softgrid/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-03-20T18:42:42+11:00" />
<script type="application/ld+json">
{"description":"If there’s ever a great example of the benefits of application virtualisation it can often be found in the little things.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/application-compatibility-and-softgrid/","headline":"Application Compatibility And The Benefits Of Virtualisation","dateModified":"2008-03-20T18:42:42+11:00","datePublished":"2008-03-20T18:42:42+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/application-compatibility-and-softgrid/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Application Compatibility And The Benefits Of Virtualisation</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2008-03-20T18:42:42+11:00" itemprop="datePublished">Mar 20, 2008
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img border="0" alt="SoftGridAppCompat" align="left" src=".com/media/2008/03/softgridappcompat.png" width="140" height="128" />If there’s ever a great example of the benefits of application virtualisation it can often be found in the little things.</p>

<p>One of the guys in our team has been sequencing <a href="http://usa.autodesk.com/adsk/servlet/index?id=3239384&amp;siteID=123112">Volo View</a>, which isn’t a particularly well behaved piece of software to begin with. It has a menu option that launches Windows Explorer to view some config files and when  run under Terminal Services, this fails to launch Explorer.</p>

<p>Rather than use the <a href="http://msdn2.microsoft.com/en-us/library/bb762153.aspx">ShellExecute API</a> to execute Explorer, it appears that the application is using <a href="http://msdn2.microsoft.com/en-us/library/ms724454.aspx">GetWindowsDirectory</a> instead, then appending EXPLORER.EXE to the end of the returned folder name and attempting to launch the Explorer window.</p>

<p>If you’ve been working with Terminal Server for any length of time, you might know that when the GetWindowsDirectory API is called under Terminal Server, the users’ home directory is returned instead of the real Windows directory. Of course EXPLORER.EXE doesn’t live there and thus the application fails to find it.</p>

<p>Fortunately there’s a few <a href="http://support.microsoft.com/kb/186498">application compatibility tricks built into Terminal Server</a> that we can take advantage of to work around issues like this. To fix this issue we can implement a registry value to modify this behaviour for this application. To help Volo View out, we can implement this registry value so that Windows will return the real folder when GetWindowsDirectory is called:</p>

<p>[quickcode:noclick]HKLM\Software\Microsoft\Windows NT\CurrentVersion\Terminal Server\Compatibility\Applications\VPLT\Flags=dword:00000408[/quickcode]</p>

<p>The benefit that application virtualisation brings to our toolset (and this is probably not a SoftGrid exclusive), is that we can implement this registry value within the SoftGrid bubble. No changes are required on the Terminal Server itself, instead the fix follows the application where ever it is executed. Very cool.</p>

  </div><a class="u-url" href="/application-compatibility-and-softgrid/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
