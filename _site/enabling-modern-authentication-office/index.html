<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Enabling Modern Authentication for Office | aaron parker</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Enabling Modern Authentication for Office" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Enabling Azure AD and Office 365 features including multi-factor authentication and Conditional Access will impact your users because they’ll need utilise App Passwords (one time passwords used for authentication with legacy applications). Unfortunately this will only serve to confuse users and result in calls to your service desk. Modern authentication is, of course, the way to improve user experience but it’s not enabled by default." />
<meta property="og:description" content="Enabling Azure AD and Office 365 features including multi-factor authentication and Conditional Access will impact your users because they’ll need utilise App Passwords (one time passwords used for authentication with legacy applications). Unfortunately this will only serve to confuse users and result in calls to your service desk. Modern authentication is, of course, the way to improve user experience but it’s not enabled by default." />
<link rel="canonical" href="/enabling-modern-authentication-office/" />
<meta property="og:url" content="/enabling-modern-authentication-office/" />
<meta property="og:site_name" content="aaron parker" />
<meta property="og:image" content="/wp-content/uploads/2017/06/14553462732_548befbd46_k.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-06-09T23:24:44+10:00" />
<script type="application/ld+json">
{"description":"Enabling Azure AD and Office 365 features including multi-factor authentication and Conditional Access will impact your users because they’ll need utilise App Passwords (one time passwords used for authentication with legacy applications). Unfortunately this will only serve to confuse users and result in calls to your service desk. Modern authentication is, of course, the way to improve user experience but it’s not enabled by default.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/enabling-modern-authentication-office/","image":"/wp-content/uploads/2017/06/14553462732_548befbd46_k.jpg","headline":"Enabling Modern Authentication for Office","dateModified":"2017-06-09T23:24:44+10:00","datePublished":"2017-06-09T23:24:44+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/enabling-modern-authentication-office/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="aaron parker" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">aaron parker</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Enabling Modern Authentication for Office</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2017-06-09T23:24:44+10:00" itemprop="datePublished">Jun 9, 2017
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Enabling Azure AD and Office 365 features including multi-factor authentication and Conditional Access will impact your users because they’ll need utilise <a href="https://docs.microsoft.com/en-us/azure/multi-factor-authentication/end-user/multi-factor-authentication-end-user-app-passwords">App Passwords</a> (one time passwords used for authentication with legacy applications). Unfortunately this will only serve to confuse users and result in calls to your service desk. Modern authentication is, of course, the way to improve user experience but it’s not enabled by default.</p>

<h1 id="enabling-modern-authentication">Enabling Modern Authentication</h1>

<p>Office applications previous to 2013 aren’t capable of modern authentication, but if you’re deploying Office 365 your likely deploying Office 365 ProPlus - 2013 or later. However it’s not enough just to deploy a recent version of Office, modern authentication (or <a href="https://en.wikipedia.org/wiki/OAuth">OAuth</a>) needs to be enabled in your tenant. Microsoft has described how modern authentication <a href="https://support.office.com/en-us/article/How-modern-authentication-works-for-Office-2013-and-Office-2016-client-apps-e4c45989-4b1a-462e-a81b-2a13191cf517">works in Office 2013 and 2016 client applications</a>. In that article we can see that modern authentication is:</p>

<ul>
  <li>Turned off for Exchange Online by default.</li>
  <li>Turned on for SharePoint Online by default.</li>
  <li>Turned off for Skype for Business Online by default.</li>
</ul>

<p>Why this is, I’m not sure, but you’ll need to enable modern authentication for Exchange Online and Skype for Business for this feature to work on the client end.</p>

<h2 id="enabling-modern-authentication-for-exchange-online">Enabling Modern Authentication for Exchange Online</h2>

<p>Full details for enabling modern authentication are available <a href="https://support.office.com/en-us/article/Enable-Exchange-Online-for-modern-authentication-58018196-f918-49cd-8238-56f57f38d662">in this article for Exchange Online from Microsoft</a>; however here’s the short version. You’ll need to first install <a href="https://www.powershellgallery.com/packages/AzureAD/">the Azure AD PowerShell module</a>. Then connect to your Office 365 tenant and enable OAuth with <a href="https://technet.microsoft.com/en-us/library/aa997443(v=exchg.160).aspx">Set-OrganizationConfig</a>, via the following code:</p>

<h2 id="enabling-modern-authentication-for-skype-for-business-online">Enabling Modern Authentication for Skype for Business Online</h2>

<p>Configuring Skype for Business Online first requires installing <a href="https://www.microsoft.com/en-us/download/details.aspx?id=39366">the Skype for Business Online PowerShell Module</a> which you’ll need to download and install, rather than install from the PowerShell Gallery. Then like Exchange, connect to your Office 365 tenant and enable OAuth with <a href="https://technet.microsoft.com/en-us/library/jj204841.aspx">Set-CsOAuthConfiguration</a>.</p>

<p>In my environment, the admin account I’m using has a different domain to the domain used by Skype for Business, hence I’ve added the OverrideAdminDomain parameter. For more complex scenarios with ADFS, you may need to consult this article: <a href="https://technet.microsoft.com/en-us/library/mt710548.aspx">How to use Modern Auth. (ADAL) with Skype for Business</a>.</p>

<p>Now with your tenant configuration complete, you may need to enable single sign-on with Azure AD Connect.</p>

<h1 id="desktop-configuration">Desktop Configuration</h1>

<p>Note that <a href="https://support.office.com/en-us/article/Enable-Modern-Authentication-for-Office-2013-on-Windows-devices-7dc1c01a-090f-4971-9677-f1b192d6c910">this article lists required registry configuration</a> to enable modern authentication for the Office 2013 desktop applications. This can be set via Group Policy preferences or any 3rd party UEM product. Office 2016 desktop applications should work without this configuration explicitly set; however, if you do set these keys for Office 2016, change 15 to 16 in the key path.</p>

<p>[table id=44 /]</p>

<h1 id="single-sign-on-with-azure-ad-connect">Single Sign-on with Azure AD Connect</h1>

<p>If you’ve deployed <a href="https://blogs.technet.microsoft.com/canitpro/2015/09/11/step-by-step-setting-up-ad-fs-and-enabling-single-sign-on-to-office-365/">Active Directory Federation Services (ADFS), single sign-on</a> should already be enabled and users should see applications such as Outlook auto-configure and sign in automatically; however, if you only have AD Connect and rely on Azure AD directly for authentication, you can enable Pass-through Authentication and Single Sign-On with AD Connect version 1.1.484.0 or above.</p>

<figure id="attachment_5452" aria-describedby="caption-attachment-5452" style="width: 880px" class="wp-caption alignnone">[<img class="size-full wp-image-5452" src="http://stealthpuppy.com/wp-content/uploads/2017/06/ADConnectSingleSignOn.png" alt="AD Connect Single Sign-On for Modern Authentication" width="880" height="620" srcset="https://stealthpuppy.com/wp-content/uploads/2017/06/ADConnectSingleSignOn.png 880w, https://stealthpuppy.com/wp-content/uploads/2017/06/ADConnectSingleSignOn-150x106.png 150w, https://stealthpuppy.com/wp-content/uploads/2017/06/ADConnectSingleSignOn-300x211.png 300w, https://stealthpuppy.com/wp-content/uploads/2017/06/ADConnectSingleSignOn-768x541.png 768w" sizes="(max-width: 880px) 100vw, 880px" />](http://stealthpuppy.com/wp-content/uploads/2017/06/ADConnectSingleSignOn.png)<figcaption id="caption-attachment-5452" class="wp-caption-text">AD Connect Single Sign-On for Modern Authentication*

Full details for enabling this configuration are available in this article: [Azure Active Directory Seamless Single Sign On](https://docs.microsoft.com/en-au/azure/active-directory/connect/active-directory-aadconnect-sso). With only AD Connect and Azure AD (instead of with ADFS), the steps for deploying this configuration are surprisingly simple and elegant.

# User Experience

Now that the configuration is complete, we can see that from the user perspective applications receive single sign-on to the Office 365 services. In these examples, I've configured MFA in Azure AD to not prompt users when behind a [Trusted IP](https://docs.microsoft.com/en-us/azure/multi-factor-authentication/multi-factor-authentication-whats-next#trusted-ips) range, otherwise if applications are started for the first time from another location, the user will see the modern authentication prompt, optionally with MFA.

## Outlook

When starting Outlook for the first time, the user sees the initial configuration wizard, but can click Next through the wizard without entering account details manually.

<figure id="attachment_5458" aria-describedby="caption-attachment-5458" style="width: 1024px" class="wp-caption alignnone">[<img class="size-large wp-image-5458" src="http://stealthpuppy.com/wp-content/uploads/2017/06/OutlookConfigureComplete-1-1024x640.png" alt="Outlook auto-configuration with modern authentication complete" width="1024" height="640" srcset="https://stealthpuppy.com/wp-content/uploads/2017/06/OutlookConfigureComplete-1-1024x640.png 1024w, https://stealthpuppy.com/wp-content/uploads/2017/06/OutlookConfigureComplete-1-150x94.png 150w, https://stealthpuppy.com/wp-content/uploads/2017/06/OutlookConfigureComplete-1-300x188.png 300w, https://stealthpuppy.com/wp-content/uploads/2017/06/OutlookConfigureComplete-1-768x480.png 768w, https://stealthpuppy.com/wp-content/uploads/2017/06/OutlookConfigureComplete-1.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px" />](http://stealthpuppy.com/wp-content/uploads/2017/06/OutlookConfigureComplete-1.png)<figcaption id="caption-attachment-5458" class="wp-caption-text">Outlook auto-configuration with modern authentication complete*

Activating Office 365 ProPlus will still require the user to manually enter their email address.

<figure id="attachment_5454" aria-describedby="caption-attachment-5454" style="width: 1024px" class="wp-caption alignnone">[<img class="size-large wp-image-5454" src="http://stealthpuppy.com/wp-content/uploads/2017/06/OfficeActivation-1024x640.png" alt="Office activation unfortunately isn't autoconfigured" width="1024" height="640" srcset="https://stealthpuppy.com/wp-content/uploads/2017/06/OfficeActivation-1024x640.png 1024w, https://stealthpuppy.com/wp-content/uploads/2017/06/OfficeActivation-150x94.png 150w, https://stealthpuppy.com/wp-content/uploads/2017/06/OfficeActivation-300x188.png 300w, https://stealthpuppy.com/wp-content/uploads/2017/06/OfficeActivation-768x480.png 768w, https://stealthpuppy.com/wp-content/uploads/2017/06/OfficeActivation.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px" />](http://stealthpuppy.com/wp-content/uploads/2017/06/OfficeActivation.png)<figcaption id="caption-attachment-5454" class="wp-caption-text">Office activation unfortunately isn't auto-configured*

## Skype for Business

Skype for Business will prompt for a username or sign-in address; however, then click on Sign In, the user is not prompted to authenticate to Skype for Business Online.

<figure id="attachment_5457" aria-describedby="caption-attachment-5457" style="width: 1024px" class="wp-caption alignnone">[<img class="size-large wp-image-5457" src="http://stealthpuppy.com/wp-content/uploads/2017/06/SkypeSignIn-1024x640.png" alt="Skype for Business - enter your email address" width="1024" height="640" srcset="https://stealthpuppy.com/wp-content/uploads/2017/06/SkypeSignIn-1024x640.png 1024w, https://stealthpuppy.com/wp-content/uploads/2017/06/SkypeSignIn-150x94.png 150w, https://stealthpuppy.com/wp-content/uploads/2017/06/SkypeSignIn-300x188.png 300w, https://stealthpuppy.com/wp-content/uploads/2017/06/SkypeSignIn-768x480.png 768w, https://stealthpuppy.com/wp-content/uploads/2017/06/SkypeSignIn.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px" />](http://stealthpuppy.com/wp-content/uploads/2017/06/SkypeSignIn.png)<figcaption id="caption-attachment-5457" class="wp-caption-text">Skype for Business - enter your email address*

## OneDrive for Business

Similarly for OneDrive for Business - the user is required to enter their email address and click Sign in, but no further authentication prompts are seen.

<figure id="attachment_5455" aria-describedby="caption-attachment-5455" style="width: 1024px" class="wp-caption alignnone">[<img class="size-large wp-image-5455" src="http://stealthpuppy.com/wp-content/uploads/2017/06/OneDriveSignIn-1024x640.png" alt="OneDrive for Business - enter your email address" width="1024" height="640" srcset="https://stealthpuppy.com/wp-content/uploads/2017/06/OneDriveSignIn-1024x640.png 1024w, https://stealthpuppy.com/wp-content/uploads/2017/06/OneDriveSignIn-150x94.png 150w, https://stealthpuppy.com/wp-content/uploads/2017/06/OneDriveSignIn-300x188.png 300w, https://stealthpuppy.com/wp-content/uploads/2017/06/OneDriveSignIn-768x480.png 768w, https://stealthpuppy.com/wp-content/uploads/2017/06/OneDriveSignIn.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px" />](http://stealthpuppy.com/wp-content/uploads/2017/06/OneDriveSignIn.png)<figcaption id="caption-attachment-5455" class="wp-caption-text">OneDrive for Business - enter your email address*

# Conclusion

With a few simple steps we've provided users with a better authentication experience in less time that it's taken me to write this article.

 
</figcaption></figure></figcaption></figure></figcaption></figure></figcaption></figure></figcaption></figure>

  </div><a class="u-url" href="/enabling-modern-authentication-office/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">aaron parker</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">{&quot;name&quot;=&gt;&quot;Aaron Parker&quot;, &quot;location&quot;=&gt;&quot;Melbourne, Australia&quot;, &quot;email&quot;=&gt;&quot;aaron@stealthpuppy.com&quot;, &quot;github&quot;=&gt;&quot;aaronparker&quot;, &quot;linkedin&quot;=&gt;&quot;aaronedwardparker&quot;, &quot;twitter&quot;=&gt;&quot;stealthpuppy&quot;}</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
