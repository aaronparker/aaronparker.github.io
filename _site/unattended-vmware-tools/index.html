<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Unattended VMware Tools | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Unattended VMware Tools" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here’s how to create an unattended installation of VMware Tools which I’ve aimed specifically at Terminal Servers, however you can apply the same concepts for any Windows server installed under any of the VMware virtualisation products." />
<meta property="og:description" content="Here’s how to create an unattended installation of VMware Tools which I’ve aimed specifically at Terminal Servers, however you can apply the same concepts for any Windows server installed under any of the VMware virtualisation products." />
<link rel="canonical" href="/unattended-vmware-tools/" />
<meta property="og:url" content="/unattended-vmware-tools/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-04-23T19:21:00+10:00" />
<script type="application/ld+json">
{"description":"Here’s how to create an unattended installation of VMware Tools which I’ve aimed specifically at Terminal Servers, however you can apply the same concepts for any Windows server installed under any of the VMware virtualisation products.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/unattended-vmware-tools/","headline":"Unattended VMware Tools","dateModified":"2007-04-23T19:21:00+10:00","datePublished":"2007-04-23T19:21:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/unattended-vmware-tools/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Unattended VMware Tools</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-04-23T19:21:00+10:00" itemprop="datePublished">Apr 23, 2007
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Here’s how to create an unattended installation of VMware Tools which I’ve aimed specifically at Terminal Servers, however you can apply the same concepts for any Windows server installed under any of the VMware virtualisation products.</p>

<h3 id="creating-a-transform-file">Creating a Transform File</h3>

<p>When installing a <a href="http://virtrix.blogspot.com/2007/03/vmware-best-practices-for-deploying.html">Terminal Server on VMware Server or ESX</a>, you need to ensure you do not install the memory control driver. To do this we need to create a custom transform file. I found the easiest way to do this was with Wise InstallTailor, unfortunately this tool is no longer available for free, so here’s a copy of the transform that I’ve created, which prevents the Memory Control Driver, Shared Folders and Guest SDK features from installing:</p>

<p><a href="/media/2007/04/VMwareTools-TerminalServer.mst">Transform for VMware Tools for Terminal Servers</a></p>

<h3 id="enabling-hardware-acceleration">Enabling Hardware Acceleration</h3>

<p>When you install VMware tools you are prompted to enable video hardware acceleration. Here’s an ingenious <a href="http://www.appdeploy.com/packages/detail.asp?id=669">VBscript from appdeploy.com</a> that will set hardware acceleration to Full, thus avoiding VMware tools prompting you to enable this feature.</p>

<p>[code]Const HKEY_LOCAL_MACHINE = &amp;H80000002<br />
Dim RegValueData<br />
Set objReg=GetObject(“winmgmts:{impersonationLevel=impersonate}!.rootdefault:StdRegProv”)</p>

<p>‘Get Path to Acceleration.Level<br />
objReg.GetStringValue HKEY_LOCAL_MACHINE,”HARDWAREDEVICEMAPVIDEO”,”DeviceVideo0”,RegValueData</p>

<p>‘Set Acceleration.Level to Full<br />
objReg.SetDWORDValue HKEY_LOCAL_MACHINE,RIGHT(RegValueData, 82),”Acceleration.Level”,0 [/code]</p>

<h3 id="installing-vmware-tools">Installing VMware Tools</h3>

<p>Installing VMware tools is straightforward. The following commands will install VMware Tools using the custom transform file and then remove the VMware Tools icon from the system tray, something which I think is essential on a Terminal Server.</p>

<p>[code]START /WAIT MSIEXEC /I “VMware Tools.msi” TRANSFORMS=VMwareTools-TerminalServer.MST ALLUSERS=TRUE REBOOT=SUPRESS /QB-<br />
REG DELETE HKLMSOFTWAREMicrosoftWindowsCurrentVersionRun /v “VMware Tools” /f[/code]</p>

  </div><a class="u-url" href="/unattended-vmware-tools/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
