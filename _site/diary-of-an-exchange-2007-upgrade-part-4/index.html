<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Diary of an Exchange 2007 Upgrade: Part 4 | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Diary of an Exchange 2007 Upgrade: Part 4" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Dear Diary," />
<meta property="og:description" content="Dear Diary," />
<link rel="canonical" href="/diary-of-an-exchange-2007-upgrade-part-4/" />
<meta property="og:url" content="/diary-of-an-exchange-2007-upgrade-part-4/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-05-29T22:09:46+10:00" />
<script type="application/ld+json">
{"description":"Dear Diary,","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/diary-of-an-exchange-2007-upgrade-part-4/","headline":"Diary of an Exchange 2007 Upgrade: Part 4","dateModified":"2007-05-29T22:09:46+10:00","datePublished":"2007-05-29T22:09:46+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/diary-of-an-exchange-2007-upgrade-part-4/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Diary of an Exchange 2007 Upgrade: Part 4</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-05-29T22:09:46+10:00" itemprop="datePublished">May 29, 2007
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img align="left" width="82" src="http://stealthpuppy.com/wp-content/uploads/2007/05/exchange1.png" height="82" style="width: 82px; height: 82px" />Dear Diary,</p>

<p>I’ve fixed the <a href="http://stealthpuppy.com/exchange/diary-of-an-exchange-2007-upgrade-part-3">issue I was having with the Majority Node Set cluster</a> – it pays to check your information againstÂ more than one source. This particular issue was caused by disabling <em>Client for Microsoft Networks</em> and <em>File and Printer Sharing for Microsoft Networks</em> on the heartbeat/private network adapater on each node in the cluster.</p>

<p>You would normally do this on a standard quorum cluster, however because a Majority Node Cluster does not use shared storage, each node needs to view cluster information via a UNC path on the other node or nodes. The following error was recorded in the cluster log file (C:WINDOWSCLUSTERcluster.log):</p>

<blockquote>
  <p>000003bc.000007ec::2007/05/26-02:14:31.082 ERRÂ  Majority Node Set <Majority Node="" Set="">: CreateTreeConnection(10.10.12.2878350f8-22f8-49ca-90ca-8d3d361df536$) returned 0xc00000be hdl 0xffffffff</Majority></p>
</blockquote>

<p>Re-enabling those items on the network connection, immediately got the cluster back up and running. You can read more about configuration network connectionsÂ for a CCR cluster onÂ TechNet:Â <a href="http://technet.microsoft.com/en-us/library/aa997910.aspx">How to Configure Network Connections for Cluster Continuous Replication</a></p>

<p>I’ve also now got the Exchange cluster up and running. The <a href="http://msexchangeteam.com/archive/2007/01/18/432264.aspx">installation experience</a> has been simplified since previous versions of Exchange and is now a no brainer. Installing the active and passive nodes is just a matter of selecting the Active or Passive Clustered Mailbox Role during installation.</p>

<p>The next phase for this project is testing the new Exchange servers – mail flow, cluster failover and performance and ensuring features such as Address Books and Free/Busy information can be seen during the migration of mailboxes.</p>

<p>This morning I had a meeting with a few member of the clients’ IS team including the IT Manager in which we discussed the progress thus far and the impacts of starting the migration of mailboxes. I am very keen to ensure testing is successful before moving mailboxes; however the IT Manager is also keen to see the solution up and running. We need to ensure the solution will work and the client needs the project to be on budget, so there is definitely a balance to be struck here.</p>

<p>Next up will be my experiences with testing load on the servers and intial migration of some of the organisation’s services such as Outlook Web Access.</p>

  </div><a class="u-url" href="/diary-of-an-exchange-2007-upgrade-part-4/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
