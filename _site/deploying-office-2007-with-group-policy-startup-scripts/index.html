<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Deploying Office 2007 with Group Policy Startup Scripts | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Deploying Office 2007 with Group Policy Startup Scripts" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In a previous post I discussed what you need to do to start deploying Office 2007. In that post I referenced a page that Microsoft linked to, but have not actually posted (Use Group Policy to Assign Startup Scripts for 2007 Office Deployment). So in this article I’ll go through a couple of ways you can use Group Policy startup scripts to deploy Office." />
<meta property="og:description" content="In a previous post I discussed what you need to do to start deploying Office 2007. In that post I referenced a page that Microsoft linked to, but have not actually posted (Use Group Policy to Assign Startup Scripts for 2007 Office Deployment). So in this article I’ll go through a couple of ways you can use Group Policy startup scripts to deploy Office." />
<link rel="canonical" href="/deploying-office-2007-with-group-policy-startup-scripts/" />
<meta property="og:url" content="/deploying-office-2007-with-group-policy-startup-scripts/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-05-05T08:02:00+10:00" />
<script type="application/ld+json">
{"description":"In a previous post I discussed what you need to do to start deploying Office 2007. In that post I referenced a page that Microsoft linked to, but have not actually posted (Use Group Policy to Assign Startup Scripts for 2007 Office Deployment). So in this article I’ll go through a couple of ways you can use Group Policy startup scripts to deploy Office.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/deploying-office-2007-with-group-policy-startup-scripts/","headline":"Deploying Office 2007 with Group Policy Startup Scripts","dateModified":"2007-05-05T08:02:00+10:00","datePublished":"2007-05-05T08:02:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/deploying-office-2007-with-group-policy-startup-scripts/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Deploying Office 2007 with Group Policy Startup Scripts</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-05-05T08:02:00+10:00" itemprop="datePublished">May 5, 2007
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>In a previous post I discussed what you need to do to start <a href="http://www.stealthpuppy.com/blogs/travelling/archive/2007/04/12/office-2007-deployment-via-group-policy.aspx">deploying Office 2007</a>. In that post I referenced a page that Microsoft linked to, but have not actually posted (<a href="http://technet2.microsoft.com/Office/en-us/library/a57c8446-b959-4025-a866-b690ddcaa66d1033.mspx">Use Group Policy to Assign Startup Scripts for 2007 Office Deployment</a>). So in this article I’ll go through a couple of ways you can use Group Policy startup scripts to deploy Office.</p>

<p>To get the most out of your Office 2007 deployment you will need to deploy using SETUP.EXE, not the MSI file. The reason for this is the changes Microsoft has made to Office 2007 setup there are no more transform files, instead customisation is achieved via Windows Installer patch files (.MSP). Using SETUP.EXE for deployment will automatically apply the patch file during installation.</p>

<p>When deploying applications via a startup script you will need to determine if the software is already installed before attempting to start the install, otherwise the installation will occur on every boot. There are a number of different ways of doing this; the first of which I had hoped would have been a <a href="http://207.46.196.114/windowsserver/en/library/a16cffa4-83b3-430b-b826-9bf81c0d39a71033.mspx?mfr=true">WMI filter</a> such as this:</p>

<p>[code]SELECT * FROM Win32_Product WHERE (IdentifyingNumber &lt;&gt; “{90120000-0030-0000-0000-0000000FF1CE}”)[/code]</p>

<p>or this:</p>

<p>[code]SELECT * FROM Win32_Product WHERE (Caption &lt;&gt; “Microsoft Office Enterprise 2007”)[/code]</p>

<p>The problem with either of these filters is that they will cause the GPO to apply whether Office is installed or not because they evaluate to TRUE. So unfortunately using a WMI Filter to control when Office is installed is out of the question.</p>

<p>A method that is similar to the WMI Filter, but uses a VBscript script to detect the presence of the installed Office applications, could work like this:</p>

<p>[code]Set wshShell = WScript.CreateObject(“WScript.Shell”)<br />
Set objWMIService = GetObject(“winmgmts:{impersonationLevel=impersonate}!\.\root\cimv2”)<br />
Set colSoftware = objWMIService.ExecQuery (“Select * from Win32_Product”)<br />
For Each objSoftware in colSoftware<br />
If objSoftware.Caption = “Microsoft Office Enterprise 2007” Then<br />
OfficeInstalled = True<br />
Exit For<br />
End If<br />
Next<br />
If OfficeInstalled &lt;&gt; True Then<br />
Set oExec = wshShell.Exec (“\company.local\Public\Applications\Office2007\SETUP.EXE”)<br />
Do While oExec.Status = 0<br />
WScript.Sleep 100<br />
Loop<br />
End If[/code]</p>

<p>This script will detect whether Office Enterprise 2007 is installed and if not start the installation. You could also implement some error checking around this to write an event to the Application log to record errors. One problem with using the Win32_Product WMI class to enumerate installed applications is that the process is slow enumeration takes about 20 seconds on my laptop (Intel Core Duo T2300, 1.6GHz).</p>

<p>The simplest way to detect if Office is installed before starting the setup program is to check if a file exists. One of the most common files will be WINWORD.EXE. So a script could look like this:</p>

<p>[code]IF NOT EXIST “%ProgramFiles%\Microsoft Office\Office12\WINWORD.EXE” START /WAIT \company.local\Public\Applications\Office2007\SETUP.EXE[/code]</p>

<p>Deploying Office 2007 via Group Policy will be challenging and may require you to perform more testing than with previous versions. For smaller organisations that have relied on Group Policy previously Office deployment can still be achieved, however perhaps it’s time to look into something a little more flexible. What I’ve seen of <a href="http://www.microsoft.com/systemcenter/sce/default.mspx">System Centre Essentials</a> so far is pretty impressive and I think it’s just the tool for small organisations. Hopefully I’ve given you enough here to get your Office deployment started. I’d be interested in hearing how others are going with their own deployments.</p>

<p class="note">
  Microsoft have recently blogged about <a href="http://blogs.technet.com/office_resource_kit/archive/2008/06/06/how-to-deploy-office-2007-by-using-group-policy-to-assign-startup-scripts.aspx">Office 2007 deployment via Group Policy</a>, which is worth checking out too.
</p>

  </div><a class="u-url" href="/deploying-office-2007-with-group-policy-startup-scripts/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
