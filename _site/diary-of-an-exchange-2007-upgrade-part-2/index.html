<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Diary of an Exchange 2007 Upgrade: Part 2 | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Diary of an Exchange 2007 Upgrade: Part 2" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Dear Diary," />
<meta property="og:description" content="Dear Diary," />
<link rel="canonical" href="/diary-of-an-exchange-2007-upgrade-part-2/" />
<meta property="og:url" content="/diary-of-an-exchange-2007-upgrade-part-2/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-05-23T10:12:15+10:00" />
<script type="application/ld+json">
{"description":"Dear Diary,","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/diary-of-an-exchange-2007-upgrade-part-2/","headline":"Diary of an Exchange 2007 Upgrade: Part 2","dateModified":"2007-05-23T10:12:15+10:00","datePublished":"2007-05-23T10:12:15+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"/diary-of-an-exchange-2007-upgrade-part-2/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">ABOUT</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Diary of an Exchange 2007 Upgrade: Part 2</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-05-23T10:12:15+10:00" itemprop="datePublished">May 23, 2007
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img align="left" src="/media/2007/05/exchange5.png" />Dear Diary,</p>

<p>In this second entry I want to tell you about the operating system installation and the initial Exchange Server install.</p>

<p><strong>Operating System Installation</strong></p>

<p>The installation of Windows didn’t quite go a smoothly as I had originally hoped. This client does not have any existing tools for automated installations of Windows, so I had planned to use Windows PE to install Windows Server from source files located on the network. This was a bit of a pain as there is no DHCP in this particular subnet and after <a href="http://blog.tiensivu.com/aaron/archives/942-2-confirmed-BDD-RTM-bugs-mostly-for-people-doing-desktop-deployments.html">problems with using Windows PE 2.0</a> to install Windows Server 2003, I decided to build the machines manually because I’d spent enough time on the OS install already. Not the ideal situation, but it got the job done.</p>

<p>After manually installing Windows Server 2003 R2 Enterprise Edition x64 to all four machines, I then installed the following updates:</p>

<ul>
  <li>Internet Explorer 7.0 + KB931768</li>
  <li>.NET Framework 2.0 + KB926776</li>
  <li>MSXML 6.0 Parser</li>
  <li>Windows Server 2003 x64 Service Pack 2</li>
  <li>Windows PowerShell 1.0</li>
</ul>

<p><strong>Organisation Upgrade</strong></p>

<p>Before moving too much further, I checked the Exchange 2007 readiness of the organisation with the Exchange Server Best Practice Analyser. The only issue found with the organisation was a recommedation to <a href="http://technet.microsoft.com/en-us/library/875ae7f8-446d-4786-85d2-719ac7093cf6.aspx">suppress link state changes</a>. As this organisation is highly centralised, I’ve skipped making those changes and proceeded to updating the organisation. Updating the schema and preparing the domain was straightforward, no issuse there.</p>

<p><strong>Client Access Servers</strong></p>

<p>Installation of the Client Access, Hub Transport and Unified Messaging roles on the two IBM 336 was simple enough, but I ran into all sorts of trouble when I my concentration slipped and I accidently installed the Mailbox role on a server that wasn’t intended to be a mailbox server.</p>

<p>To remove the mailbox role, I first had to remove the Public Folder replicas contained on that server. Attempting to remove the role would produce this error:</p>

<blockquote>
  <p>Uninstall cannot proceed. Database ‘Public Folder Database’: The public folder database specified contains folder replicas. Before deleting the public folder database, remove the folders or move the replicas to another public folder database.</p>
</blockquote>

<p>Removing the replicas proved to be difficult; I could get so far with the Remove-PublicFolder command so I ended up deleting the Public Folder store with ADSIEDIT so that I could remove the Mailbox role successfully. The Exchange team have a lot to answer for in regards to Public Folder management in Exchange 2006 RTM.</p>

<p><strong>Where To Next?</strong></p>

<p>Now that the CAS, HT and UM rules are in place, the next step is to get the clustered Mailbox role up and running. My next entry will detail that process.</p>

  </div><a class="u-url" href="/diary-of-an-exchange-2007-upgrade-part-2/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
