<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Addressing Licensing Issues With Adobe CS3 Apps On SoftGrid | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Addressing Licensing Issues With Adobe CS3 Apps On SoftGrid" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Adobe uses Macrovision FLEXnet to enforce licensing for their applications. This is a service that is installed when you install any of the CS3 applications and will start when you launch a CS3 application. This licensing tool is installed even if you are using volume license media." />
<meta property="og:description" content="Adobe uses Macrovision FLEXnet to enforce licensing for their applications. This is a service that is installed when you install any of the CS3 applications and will start when you launch a CS3 application. This licensing tool is installed even if you are using volume license media." />
<link rel="canonical" href="/addressing-licensing-issues-with-adobe-cs3-apps-on-softgrid/" />
<meta property="og:url" content="/addressing-licensing-issues-with-adobe-cs3-apps-on-softgrid/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-01-24T01:30:38+11:00" />
<script type="application/ld+json">
{"description":"Adobe uses Macrovision FLEXnet to enforce licensing for their applications. This is a service that is installed when you install any of the CS3 applications and will start when you launch a CS3 application. This licensing tool is installed even if you are using volume license media.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/addressing-licensing-issues-with-adobe-cs3-apps-on-softgrid/","headline":"Addressing Licensing Issues With Adobe CS3 Apps On SoftGrid","dateModified":"2008-01-24T01:30:38+11:00","datePublished":"2008-01-24T01:30:38+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/addressing-licensing-issues-with-adobe-cs3-apps-on-softgrid/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Addressing Licensing Issues With Adobe CS3 Apps On SoftGrid</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2008-01-24T01:30:38+11:00" itemprop="datePublished">Jan 24, 2008
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Adobe uses <a href="http://www.macrovision.com/products/1156.htm?link_id=topnav">Macrovision FLEXnet</a> to enforce licensing for their applications. This is a service that is installed when you install any of the CS3 applications and will start when you launch a CS3 application. This licensing tool is installed even if you are using volume license media.</p>

<p>In a MAV environment this service can be successfully virtualised, however you may encounter issues when running multiple CS3 applications in separate MAV environments (or bubbles). Running more than one CS3 application at a time (either on a single desktop or in a Terminal Server environment) will result in the following licensing errors and the application will exit:</p>

<blockquote>
  <p>The licensing subsystem has failed catastrophically. You must reinstall or call customer support.</p>
</blockquote>

<p><img src="/media/2008/01/licensing-error2.png" alt="Licensing Error" /></p>

<blockquote>
  <p>You cannot use this product at this time. You must repair the problem by uninstalling and then reinstalling this product or contacting your IT administrator or Adobe customer support for help.</p>
</blockquote>

<p><img src="/media/2008/01/licensing-error3.png" alt="Licensing Error" /></p>

<p>Fortunately the FLEXnet Licensing service only needs to run when the application starts - you can subsequently stop the service and the application will continue to run. With a script we can stop this service to get more than one CS3 application running.</p>

<p>Originally I had attempted using WMI to detect the state of the service, wait for it to start and then stop it. However, the virtual services are not detectable via WMI so I’ve had to resort to something a little more crude. This script reads the output from a NET START command until the FLEXnet service starts and then stops the service. It’s not a robust script by any means but it gets the job done.</p>

<pre><code class="language-Vb">Dim WshShell, oExec  
Set WshShell = CreateObject("WScript.Shell")  
Do While True  
Set oExec = WshShell.Exec("NET START")  
Do While oExec.Status &lt;&gt; 1  
  WScript.Sleep 100  
Loop  
If InStr(oExec.StdOut.ReadAll, "FLEXnet Licensing Service") &lt;&gt; 0 Then Exit Do  
  WScript.Sleep 5000  
Loop  
  WScript.Sleep 3000  
Set oExec = WshShell.Exec("NET STOP /YES " &amp; Chr(34) &amp; "FLEXnet Licensing Service" &amp; Chr(34))  
Do While oExec.Status &lt;&gt; 1  
  WScript.Sleep 100  
Loop  
</code></pre>

<p>Run the script by adding a POST LAUNCH script event in the OSD file:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;SCRIPT</span> <span class="na">EVENT=</span><span class="s">"LAUNCH"</span> <span class="na">TIMING=</span><span class="s">"POST"</span> <span class="na">PROTECT=</span><span class="s">"TRUE"</span> <span class="na">WAIT=</span><span class="s">"FALSE"</span> <span class="na">TIMEOUT=</span><span class="s">"0"</span><span class="nt">&gt;</span>  
<span class="nt">&lt;HREF&gt;</span>CMDOW.EXE /RUN /HID CSCRIPT //NOLOGO \\SERVER\Scripts\StopFLEXnet.VBS<span class="nt">&lt;/HREF&gt;</span>  
<span class="nt">&lt;/SCRIPT&gt;</span>
</code></pre></div></div>

<p>I’m using <a href="http://www.commandline.co.uk/cmdow/">CMDOW</a> here to hide the command window that users will see every few seconds. Unfortunately this method is a little clunky, but if you have a better suggest please let me know.</p>

  </div><a class="u-url" href="/addressing-licensing-issues-with-adobe-cs3-apps-on-softgrid/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
