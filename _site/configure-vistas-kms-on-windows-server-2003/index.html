<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Configure Vista’s KMS on Windows Server 2003 | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Configure Vista’s KMS on Windows Server 2003" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Unfortunately life with Windows Vista means living with Microsoft’s Volume Activation 2.0. For complete information on Volume Activation 2.0 see this TechNet page:" />
<meta property="og:description" content="Unfortunately life with Windows Vista means living with Microsoft’s Volume Activation 2.0. For complete information on Volume Activation 2.0 see this TechNet page:" />
<link rel="canonical" href="/configure-vistas-kms-on-windows-server-2003/" />
<meta property="og:url" content="/configure-vistas-kms-on-windows-server-2003/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2007-03-01T01:02:00+11:00" />
<script type="application/ld+json">
{"description":"Unfortunately life with Windows Vista means living with Microsoft’s Volume Activation 2.0. For complete information on Volume Activation 2.0 see this TechNet page:","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/configure-vistas-kms-on-windows-server-2003/","headline":"Configure Vista’s KMS on Windows Server 2003","dateModified":"2007-03-01T01:02:00+11:00","datePublished":"2007-03-01T01:02:00+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/configure-vistas-kms-on-windows-server-2003/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About</a><a class="page-link" href="/appv-faqs.html">App-V 4.x FAQs</a><a class="page-link" href="/appv5-faqs.html">Microsoft Application Virtualization 5 FAQs</a><a class="page-link" href="/appvrecipes.html">App-V Recipes</a><a class="page-link" href="/home-page.html">Home Page</a><a class="page-link" href="/scriptcorner.html">Script Corner</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Configure Vista&amp;#8217;s KMS on Windows Server 2003</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2007-03-01T01:02:00+11:00" itemprop="datePublished">Mar 1, 2007
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Unfortunately life with Windows Vista means living with Microsoft’s <a href="http://www.microsoft.com/technet/windowsvista/plan/faq.mspx">Volume Activation 2.0</a>. For complete information on Volume Activation 2.0 see this TechNet page:</p>

<p><a href="http://www.microsoft.com/technet/windowsvista/plan/volact1.mspx">Windows Vista Volume Activation 2.0 Step-By-Step Guide</a></p>

<p>When deploying Windows Vista in the enterprise you have the choice of Multiple Activation Keys or Key Management Services (KMS) keys. The KMS uses a service you install on Windows Server 2003 and is already install on Windows Vista or Windows Server Longhorn. Note that this machine must be a physical computer, you can install the KMS in a virtual machine, but when you use the configuration utility it will give you an error.</p>

<p>There’s a fair amount of reading you’ll have to do to work out how to get the KMS up and running, but if you’re like me and you have the attention span of a goldfish, here’s the short version:</p>

<p><strong>1</strong>. Download the Key Management Service for Windows Server 2003 SP1 â€“ there are <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=81d1cb89-13bd-4250-b624-2f8c57a1ae7b&amp;DisplayLang=en">x86</a> and <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=03fe69b2-6244-471c-80d2-b4171fb1d7a5&amp;DisplayLang=en">x64</a> versions available.</p>

<p><strong>2</strong>. Install the KMS on a physical machine running Windows Server 2003. The same machine you might be using for <a href="http://technet.microsoft.com/en-us/windowsvista/aa905118.aspx">WDS</a> could be the best candidate.</p>

<p><strong>3</strong>. Add your Windows Vista KMS key to the KMS host:</p>

<p>`C:\WINDOWS\system32&gt;cscript slmgr.vbs /ipk XXXXX-XXXXX-XXXXX-XXXXX-XXXXX&lt;/p&gt;</p>
<p>Microsoft (R) Windows Script Host Version 5.6<br />
Copyright (C) Microsoft Corporation 1996-2001. All rights reserved.</p>
<p>Installed product key XXXXX-XXXXX-XXXXX-XXXXX-XXXXX successfully.`

**4**. Activate your KMS host with Microsoft:

`C:\WINDOWS\system32&gt;cscript slmgr.vbs /ato</p>
<p>Microsoft (R) Windows Script Host Version 5.6<br />
Copyright (C) Microsoft Corporation 1996-2001. All rights reserved.</p>
<p>This operation connects over the Internet to send the appropriate computer information, such as the types of hardware you are using and the product ID, to the Microsoft activation server. By using this Software, you consent to the transmission of this information. Microsoft does not use the information to identify or contact you.</p>
<p>Do you want to continue [y/n]? y</p>
<p>Activating Windows(TM) Server 2003 KMS, KmsW2k3Prs edition (aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa) ...</p>
<p>Product activated successfully.<code>&lt;/p&gt;
<p>You can now view the status of your KMS server:</p>
<p><code>C:\WINDOWS\system32&gt;cscript slmgr.vbs /dli&lt;/p&gt;
<p>Microsoft (R) Windows Script Host Version 5.6<br />
Copyright (C) Microsoft Corporation 1996-2001. All rights reserved.</p>
<p>Name: Windows(TM) Server 2003 KMS, KmsW2k3Prs edition<br />
Description: Windows(TM) Server 2003 KMS, VOLUME_KMS channel<br />
Partial Product Key: J3YKD<br />
License Status: Licensed</p>
<p>Key Management Service is enabled on this machine</p>
<p style="margin-left: 36pt;">Current count: 0<br />
Listening on Port: 1688<br />
DNS publishing enabled<br />
KMS priority: Normal`

Now your KMS server should be running you can deploy Windows Vista using the same KMS key. Windows Vista will query DNS to find your KMS server and activate against it. Give DNS time to replicate and you can then see if your KMS server is registred correctly with NSLOOKUP:

`C:\&gt;nslookup -type=srv _vlmcs._tcp<br />
Server: dc.company.local<br />
Address: 192.168.1.17:53</p>
<p>_vlmcs._tcp.company.local SRV service location:<br />
priority = 0<br />
weight = 0<br />
port = 1688<br />
svr hostname = kmshost.company.local<br />
kmshost.company.local internet address = 192.168.1.23`

As alternative to quering DNS to find the KMS host, you can hard code a client to use a particular KMS host:

`C:\Windows\System32\cscript slmgr.vbs -skms <KMS_FQDN>[:port]`

The best place to get questions and answers about Volume Activation 2.0 is the FAQ page:

[Windows Vista Volume Activation 2.0](http://www.microsoft.com/technet/windowsvista/plan/faq.mspx)
</KMS_FQDN></p></code></p></code></p>

  </div><a class="u-url" href="/configure-vistas-kms-on-windows-server-2003/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
