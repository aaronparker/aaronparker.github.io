<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>SoftGrid, Presentation Server And Internet Explorer As A Help System | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="SoftGrid, Presentation Server And Internet Explorer As A Help System" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="If you’re deploying applications on Citrix Presentation Server via Application Virtualisation/SoftGrid, you may run into issues with applications that utilise a local HTML based help system. These applications will generally launch Internet Explorer as the viewer and in our case, we’ve found that IE is launched outside of the protected environment and thus never sees the help content located inside the environment." />
<meta property="og:description" content="If you’re deploying applications on Citrix Presentation Server via Application Virtualisation/SoftGrid, you may run into issues with applications that utilise a local HTML based help system. These applications will generally launch Internet Explorer as the viewer and in our case, we’ve found that IE is launched outside of the protected environment and thus never sees the help content located inside the environment." />
<link rel="canonical" href="/softgrid-presentation-server-internet-explorer-as-a-help-system/" />
<meta property="og:url" content="/softgrid-presentation-server-internet-explorer-as-a-help-system/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-01-14T20:00:12+11:00" />
<script type="application/ld+json">
{"description":"If you’re deploying applications on Citrix Presentation Server via Application Virtualisation/SoftGrid, you may run into issues with applications that utilise a local HTML based help system. These applications will generally launch Internet Explorer as the viewer and in our case, we’ve found that IE is launched outside of the protected environment and thus never sees the help content located inside the environment.","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/softgrid-presentation-server-internet-explorer-as-a-help-system/","headline":"SoftGrid, Presentation Server And Internet Explorer As A Help System","dateModified":"2008-01-14T20:00:12+11:00","datePublished":"2008-01-14T20:00:12+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/softgrid-presentation-server-internet-explorer-as-a-help-system/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">SoftGrid, Presentation Server And Internet Explorer As A Help System</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2008-01-14T20:00:12+11:00" itemprop="datePublished">Jan 14, 2008
      </time><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card"
          itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img border="0" alt="internetexplorer-softgridbox" align="left" src="/media/2008/05/internetexplorer-softgridbox.png" width="142" height="128" /> If you’re deploying applications on Citrix Presentation Server via Application Virtualisation/SoftGrid, you may run into issues with applications that utilise a local HTML based help system. These applications will generally launch Internet Explorer as the viewer and in our case, we’ve found that IE is launched outside of the protected environment and thus never sees the help content located inside the environment.</p>

<p>This behaviour only happens inside an ICA session and does not occur in an RDP session or on the console. Exactly why Internet Explorer is executed outside the environment but it has something to do with WFSHELL.EXE being the calling process.</p>

<p>Citrix Presentation Server implements some changes to the system during install to enable Server to Client content redirection. The following registry keys are modified to point to <em>C:\Program Files\Citrix\system32\iexplore.exe</em> which make the decision on where content is executed.</p>

<ul>
  <li>HKEY_CLASSES_ROOT\htmlfile\shell\open\command
    <ul>
      <li>HKEY_CLASSES_ROOT\htmlfile\shell\opennew\command
        <ul>
          <li>HKEY_CLASSES_ROOT\HTTP\shell\open\command
            <ul>
              <li>HKEY_CLASSES_ROOT\https\shell\open\command
                <ul>
                  <li>HKEY_CLASSES_ROOT\MMS\shell\open\command
                    <ul>
                      <li>HKEY_CLASSES_ROOT\pnm\shell\open\command
                        <ul>
                          <li>HKEY_CLASSES_ROOT\rtsp\shell\open\command
                            <ul>
                              <li>HKEY_CLASSES_ROOT\rtspu\shell\open\command &lt;/ul&gt; 
Citrix have a knowledgebase article that details a related error: <a href="http://support.citrix.com/article/CTX107424">Applications that Use or Call IExplore.exe Fail to Open Within an ICA Session</a>, but unfortunately doesn’t give a very detailed explanation as to why this occurs.</li>
                            </ul>

                            <p>The registry keys that the article states to change this behaviour do indeed implement a workaround for the issue experienced from within SoftGrid. However once implemented they will prevent Server to Client content redirection, as they must be changed natively in Windows - they don’t work by changing them with the OSD file. Not something you’ll want to implement if you’re using this type of content redirection.</p>

                            <p>Fortunately through a little bit of digging around and testing, I’ve found that by adding the following registry entry to your OSD files will execute Internet Explorer directly and keep the process within the protected environment, allowing the user to view Help:</p>

                            <p><a href="/media/2008/05/softgridiereg1.png">&lt;img border=”0” alt=”SoftGridIEReg” src=”/media/2008/05/softgridiereg-thumb.png</a></p>

                            <p>(I’ve had to use an image here because WordPress keeps formatting the code)</p>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

  </div><a class="u-url" href="/softgrid-presentation-server-internet-explorer-as-a-help-system/" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col one-half">
      <h2 class="footer-heading">stealthpuppy</h2>
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col one-half">
        <p>on end user computing and enterprise mobility</p>
      </div>

      <div class="social-links"><ul class="social-media-list"><li><a href="https://github.com/aaronparker" title="aaronparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="https://www.linkedin.com/in/aaronedwardparker" title="aaronedwardparker"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a href="https://twitter.com/stealthpuppy" title="stealthpuppy"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li><li><a href="/feed.xml" title="atom"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
