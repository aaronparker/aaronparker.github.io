<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Download, Install, Import Visual C++ Redistributables with VcRedist | stealthpuppy</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Download, Install, Import Visual C++ Redistributables with VcRedist" />
<meta name="author" content="Aaron Parker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Note: for a more up to date version of the content in this article, VcRedist now has documentation available here: https://docs.stealthpuppy.com/vcredist" />
<meta property="og:description" content="Note: for a more up to date version of the content in this article, VcRedist now has documentation available here: https://docs.stealthpuppy.com/vcredist" />
<link rel="canonical" href="/vcredist-powershell-module/" />
<meta property="og:url" content="/vcredist-powershell-module/" />
<meta property="og:site_name" content="stealthpuppy" />
<meta property="og:image" content="/wp-content/uploads/2018/03/alexey-ruban-103990-unsplash.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-16T22:10:54+11:00" />
<script type="application/ld+json">
{"description":"Note: for a more up to date version of the content in this article, VcRedist now has documentation available here: https://docs.stealthpuppy.com/vcredist","author":{"@type":"Person","name":"Aaron Parker"},"@type":"BlogPosting","url":"/vcredist-powershell-module/","image":"/wp-content/uploads/2018/03/alexey-ruban-103990-unsplash.jpg","headline":"Download, Install, Import Visual C++ Redistributables with VcRedist","dateModified":"2018-03-16T22:10:54+11:00","datePublished":"2018-03-16T22:10:54+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"/vcredist-powershell-module/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="stealthpuppy" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">stealthpuppy</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About</a><a class="page-link" href="/appv-faqs.html">App-V 4.x FAQs</a><a class="page-link" href="/appv5-faqs.html">Microsoft Application Virtualization 5 FAQs</a><a class="page-link" href="/appvrecipes.html">App-V Recipes</a><a class="page-link" href="/home-page.html">Home Page</a><a class="page-link" href="/scriptcorner.html">Script Corner</a><a class="page-link" href="/smb-not-cifs.html">SMB not CIFS</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Download, Install, Import Visual C++ Redistributables with VcRedist</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-03-16T22:10:54+11:00" itemprop="datePublished">Mar 16, 2018
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Aaron Parker</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><strong>Note</strong>: for a more up to date version of the content in this article, VcRedist now has documentation available here: <a href="https://docs.stealthpuppy.com/vcredist">https://docs.stealthpuppy.com/vcredist</a></p>

<p>Last year I wrote <a href="https://stealthpuppy.com/visual-c-redistributable-installer/">a PowerShell script that can download, install or import</a> the Visual C++ Redistributables into MDT or ConfigMgr. Long-term maintenance of the full feature set in a single script is a little unwieldy so I’ve re-written the script and created <a href="https://github.com/aaronparker/Install-VisualCRedistributables">a PowerShell module</a> – VcRedist.</p>

<p>Refactoring the script into a module has been a great little project for creating my first PowerShell function and publishing it to <a href="https://www.powershellgallery.com/packages/VcRedist/">the PowerShell Gallery</a>.</p>

<h1 id="why-vcredist">Why VcRedist?</h1>

<p>At this point, I’m sure you’re saying to yourself – “Aaron, haven’t you just created <a href="https://chocolatey.org/">Chocolatey</a>?”. In a way yes, this module does exactly what you can do with Chocolatey – install the <a href="https://chocolatey.org/packages/vcredist140">Visual C++ Redistributables</a> directly to the local machine. Although you can download and install all of the supported (and unsupported) Redistributables, the primary aim of the module is to provide a fast way to download and import the Redistributables into the Microsoft Deployment Toolkit or System Center Configuration Manager for operating system deployments.</p>

<h1 id="module">Module</h1>

<p>The VcRedist module is <a href="https://www.powershellgallery.com/packages/VcRedist/">published to the PowerShell Gallery</a>, which means that it’s simple to install the module and starting importing with a few lines of PowerShell. For example, here’s how you could install the module, download all of <a href="https://support.microsoft.com/en-gb/help/2977003/the-latest-supported-visual-c-downloads">the supported Redistributables</a> and import them into an MDT deployment share:</p>

<pre class="prettyprint lang-powershell" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">Install-Module -Name VcRedist
Import-Module VcRedist
$VcList = Get-VcList | Get-VcRedist -Path "C:\Temp\VcRedist"
Import-VcMdtApp -VcList $VcList -Path "C:\Temp\VcRedist" -MdtPath "\\server\share\Reference"</pre>

<p>This results in each of the Visual C++ Redistributables imported as a separate application with all necessary properties including Version, silent command line, Uninstall Key and 32-bit or 64-bot operating system support.</p>

<figure id="attachment_5999" aria-describedby="caption-attachment-5999" style="width: 2880px" class="wp-caption aligncenter">[<img class="size-full wp-image-5999" src="https://stealthpuppy.com/wp-content/uploads/2018/03/MdtVisualCApplications.png" alt="Visual C++ Redistributables imported into an MDT share with VcRedist" width="2880" height="778" srcset="http://192.168.0.89/wp-content/uploads/2018/03/MdtVisualCApplications.png 2880w, http://192.168.0.89/wp-content/uploads/2018/03/MdtVisualCApplications-150x41.png 150w, http://192.168.0.89/wp-content/uploads/2018/03/MdtVisualCApplications-300x81.png 300w, http://192.168.0.89/wp-content/uploads/2018/03/MdtVisualCApplications-768x207.png 768w, http://192.168.0.89/wp-content/uploads/2018/03/MdtVisualCApplications-1024x277.png 1024w" sizes="(max-width: 2880px) 100vw, 2880px" />](https://stealthpuppy.com/wp-content/uploads/2018/03/MdtVisualCApplications.png)<figcaption id="caption-attachment-5999" class="wp-caption-text">Visual C++ Redistributables imported into an MDT share with VcRedist</figcaption></figure>

<p>The same approach can be used to import the Redistributables into a ConfigMgr site:</p>

<pre class="prettyprint lang-powershell" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">Install-Module VcRedist
Import-Module VcRedist
$VcList = Get-VcList | Get-VcRedist -Path "C:\Temp\VcRedist"
Import-VcCmApp -VcList $VcList -Path "C:\Temp\VcRedist" -CMPath "\\server\share\VcRedist" -SMSSiteCode LAB</pre>

<p>Just like MDT, each Redistributable is imported into ConfigMgr; however, <code class="prettyprint lang-powershell" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">Import-VcCmApp</code> copies the Redistributables to a share for distribution and creates and application with a single deployment for each one.</p>

<figure id="attachment_6000" aria-describedby="caption-attachment-6000" style="width: 1145px" class="wp-caption aligncenter">[<img class="size-full wp-image-6000" src="https://stealthpuppy.com/wp-content/uploads/2018/03/VcRedistConfigMgr.png" alt="Visual C++ Redistributables imported into ConfigMgr with VcRedist" width="1145" height="477" srcset="http://192.168.0.89/wp-content/uploads/2018/03/VcRedistConfigMgr.png 1145w, http://192.168.0.89/wp-content/uploads/2018/03/VcRedistConfigMgr-150x62.png 150w, http://192.168.0.89/wp-content/uploads/2018/03/VcRedistConfigMgr-300x125.png 300w, http://192.168.0.89/wp-content/uploads/2018/03/VcRedistConfigMgr-768x320.png 768w, http://192.168.0.89/wp-content/uploads/2018/03/VcRedistConfigMgr-1024x427.png 1024w" sizes="(max-width: 1145px) 100vw, 1145px" />](https://stealthpuppy.com/wp-content/uploads/2018/03/VcRedistConfigMgr.png)<figcaption id="caption-attachment-6000" class="wp-caption-text">Visual C++ Redistributables imported into ConfigMgr with VcRedist</figcaption></figure>

<p>Of course, the module can download and install the Redistributables to the local machine:</p>

<pre class="prettyprint lang-powershell" data-start-line="1" data-visibility="visible" data-highlight="" data-caption="">Install-Module VcRedist
Import-Module VcRedist
$VcList = Get-VcList | Get-VcRedist -Path "C:\Temp\VcRedist"
$VcList | Install-VcRedist -Path C:\Temp\VcRedist</pre>

<p>By default, this installs all of the supported Redistributables:</p>

<figure id="attachment_6001" aria-describedby="caption-attachment-6001" style="width: 1071px" class="wp-caption aligncenter">[<img class="size-full wp-image-6001" src="https://stealthpuppy.com/wp-content/uploads/2018/03/VisualCPrograms.png" alt="Visual C++ Redistributables installed locally with VcRedist" width="1071" height="583" srcset="http://192.168.0.89/wp-content/uploads/2018/03/VisualCPrograms.png 1071w, http://192.168.0.89/wp-content/uploads/2018/03/VisualCPrograms-150x82.png 150w, http://192.168.0.89/wp-content/uploads/2018/03/VisualCPrograms-300x163.png 300w, http://192.168.0.89/wp-content/uploads/2018/03/VisualCPrograms-768x418.png 768w, http://192.168.0.89/wp-content/uploads/2018/03/VisualCPrograms-1024x557.png 1024w" sizes="(max-width: 1071px) 100vw, 1071px" />](https://stealthpuppy.com/wp-content/uploads/2018/03/VisualCPrograms.png)<figcaption id="caption-attachment-6001" class="wp-caption-text">Visual C++ Redistributables installed locally with VcRedist</figcaption></figure>

<p>Note that the 2015 and 2017 Redistributables are the same version, so the end result will include only the 2017 versions.</p>

<h1 id="functions">Functions</h1>

<p>This module includes the following functions:</p>

<h2 id="get-vclist">Get-VcList</h2>

<p>This function reads the Visual C++ Redistributables listed in an internal manifest or an external XML file into an array that can be passed to other VcRedist functions. Running <code class="highlighter-rouge">Get-VcList</code> will return the supported list of Visual C++ Redistributables. The function can read an external XML file that defines a custom list of Visual C++ Redistributables.</p>

<h2 id="export-vcxml">Export-VcXml</h2>

<p>Run <code class="highlighter-rouge">Export-VcXml</code> to export the internal Visual C++ Redistributables manifest to an external XML file. Use <code class="highlighter-rouge">-Path</code> to define the path to the external XML file that the manifest will be saved to. By default <code class="highlighter-rouge">Export-VcXml</code> will export only the supported Visual C++ Redistributables.</p>

<h2 id="get-vcredist">Get-VcRedist</h2>

<p>To download the Visual C++ Redistributables to a local folder, use <code class="highlighter-rouge">Get-VcRedist</code>. This will read the array of Visual C++ Redistributables returned from <code class="highlighter-rouge">Get-VcList</code> and download each one to a local folder specified in <code class="highlighter-rouge">-Path</code>. Visual C++ Redistributables can be filtered for release and processor architecture.</p>

<h2 id="install-vcredist">Install-VcRedist</h2>

<p>To install the Visual C++ Redistributables on the local machine, use <code class="highlighter-rouge">Install-VcRedist</code>. This function again accepts the array of Visual C++ Redistributables passed from <code class="highlighter-rouge">Get-VcList</code> and installs the Visual C++ Redistributables downloaded to a local path with <code class="highlighter-rouge">Get-VcRedist</code>. Visual C++ Redistributables can be filtered for release and processor architecture.</p>

<h2 id="import-vcmdtapp">Import-VcMdtApp</h2>

<p>To install the Visual C++ Redistributables as a part of a reference image or for use with a deployment solution based on the Microsoft Deployment Toolkit, <code class="highlighter-rouge">Import-VcMdtApp</code> will import each of the Visual C++ Redistributables as a separate application that includes silent command lines, platform support and the UninstallKey for detecting whether the Visual C++ Redistributable is already installed. Visual C++ Redistributables can be filtered for release and processor architecture.</p>

<p>Each Redistributables will be imported into the deployment share with application properties for a successful deployment.</p>

<h2 id="import-vccmapp">Import-VcCMApp</h2>

<p>To install the Visual C++ Redistributables with System Center Configuration Manager, <code class="highlighter-rouge">Import-VcCmApp</code> will import each of the Visual C++ Redistributables as a separate application that includes the application and a single deployment type. Visual C++ Redistributables can be filtered for release and processor architecture.</p>

<h1 id="tested-on">Tested On</h1>

<p>Tested on Windows 10 and Windows Server 2016 with PowerShell 5.1. Install-VcRedist and Import-VcMdtApp require Windows and the MDT Workbench. Get-VcList, Export-VcXml and Get-VcRedist do work on PowerShell Core; however, most testing is completed on Windows PowerShell.</p>

<h1 id="to-do">To Do</h1>

<p>Right now, I have a few tasks for updating the module, including:</p>

<ul>
  <li>Additional testing / Pester tests</li>
  <li>Add -Bundle to Import-VcMdtApp to create an Application Bundle and simplify installing the Redistributables</li>
  <li>Documentation updates</li>
</ul>

<p>For full details and further updates, <a href="https://github.com/aaronparker/Install-VisualCRedistributables">keep an eye on the repository</a> and test out the module via <a href="https://www.powershellgallery.com/packages/VcRedist/">the PowerShell Gallery</a>.</p>

<p>Image credit:</p>

<p><a style="background-color: black; color: white; text-decoration: none; padding: 4px 6px; font-family: -apple-system, BlinkMacSystemFont, 'San Francisco', 'Helvetica Neue', Helvetica, Ubuntu, Roboto, Noto, 'Segoe UI', Arial, sans-serif; font-size: 12px; font-weight: bold; line-height: 1.2; display: inline-block; border-radius: 3px;" title="Download free do whatever you want high-resolution photos from Alexey Ruban" href="https://unsplash.com/@kartochky?utm_medium=referral&amp;utm_campaign=photographer-credit&amp;utm_content=creditBadge" target="_blank" rel="noopener noreferrer"><span style="display: inline-block; padding: 2px 3px;">Alexey Ruban</span></a></p>

  </div><a class="u-url" href="/vcredist-powershell-module/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">stealthpuppy</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">stealthpuppy</li><li><a class="u-email" href="mailto:aaron@stealthpuppy.com">aaron@stealthpuppy.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/aaronparker"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">aaronparker</span></a></li><li><a href="https://www.twitter.com/stealthpuppy"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">stealthpuppy</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>on end user computing and enterprise mobility
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
